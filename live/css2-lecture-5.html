
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lecture 5: Modeling Data &#8212; UCSD CSS 2</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">UCSD CSS 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome to CSS 2
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Course (CSS 2 summer 2)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../course/syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/expectations.html">
   Expectations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/datahub.html">
   Datahub assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/debugging.html">
   Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/resources.html">
   Extracurricular Resources
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/live/css2-lecture-5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/UCSD-CSS-002/ucsd-css-002.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/UCSD-CSS-002/ucsd-css-002.github.io/issues/new?title=Issue%20on%20page%20%2Flive/css2-lecture-5.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/UCSD-CSS-002/ucsd-css-002.github.io/master?urlpath=tree/live/css2-lecture-5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#this-week">
   This week:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#things-we-do-with-data">
   Things we do with data.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-model">
   What is a model?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-parts">
   Model parts.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-structures-and-parameters">
   Model structures and parameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loss-functions">
   Loss functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-for-regression">
     Loss for Regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sum-squared-error">
       Sum squared error
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-for-classification">
     Loss for Classification
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimization-algorithm">
   Optimization algorithm
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grid-search">
     Grid search
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-search">
     Random search
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gradient-descent">
     Gradient descent
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-our-own-model-class">
   Writing our own model class
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-kinds-of-operations-should-a-model-support">
     What kinds of operations should a model support?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#baby-steps">
     Baby steps
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#predict">
       predict
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#evaluate">
       evaluate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fit">
       fit
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="lecture-5-modeling-data">
<h1>Lecture 5: Modeling Data<a class="headerlink" href="#lecture-5-modeling-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="this-week">
<h2>This week:<a class="headerlink" href="#this-week" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>no problem set, one integrated lab, due at the usual problem set time (monday)</p></li>
<li><p>covering mostly conceptual material, which will serve as the basis of understanding the stuff we do later.</p></li>
</ul>
</div>
<div class="section" id="things-we-do-with-data">
<h2>Things we do with data.<a class="headerlink" href="#things-we-do-with-data" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>describe, summarize, visualize</p></li>
<li><p>infer latent structure, rules, properties, parameters</p></li>
<li><p>generalize to predict, interpolate, extrapolate</p></li>
</ol>
<p>Classical statistics is mostly about #2.  Machine learning is mostly about #3.  Computational Social Science uses tools and models from both.</p>
<p>Both of these rely on fitting models to the data, but the design of the models, and model evaluation differ.</p>
</div>
<div class="section" id="what-is-a-model">
<h2>What is a model?<a class="headerlink" href="#what-is-a-model" title="Permalink to this headline">¶</a></h2>
<p>A model <em>assumes</em> some <strong>structure</strong> of the data, and has some <strong>parameters</strong> that are <em>fit</em> to the data.  The end result is an object that may be used in various ways for data summarization, inference, and prediction.</p>
<p><strong>Examples</strong>: Linear regression, logistic regression, decision tree, neural networks of various architectures, support vector machine, etc.</p>
<p>The structural assumptions constrain what kind of relationships can be captured by the model, but are also necessary to generalize beyond the data.</p>
<p><strong>Even when we simply describe or summarize data, we implicitly have a model in mind.</strong></p>
<p>I have the following data describing the flips of a coin <em><strong>how should I summarize them?</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;H&#39;, &#39;H&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;H&#39;, &#39;H&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># probability of heads </span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="c1"># if we think the coin might be bent.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3076923076923077
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># coin generated by a process that may be </span>
<span class="c1"># likely to repeat previous outcome</span>

<span class="n">transitions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">prev</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">prev</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">prev</span> <span class="o">==</span> <span class="n">outcome</span><span class="p">:</span>
            <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;different&#39;</span><span class="p">)</span>
    <span class="n">prev</span> <span class="o">=</span> <span class="n">outcome</span>

<span class="nb">print</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;same&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_same</span> <span class="o">=</span> <span class="n">transitions</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;same&#39;</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_same</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.75
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># spin a spinner.  if spinner lands in red then we stop flipping coin.</span>
<span class="c1"># if spinner lands on green, then we flip one more time.</span>
<span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="model-parts">
<h2>Model parts.<a class="headerlink" href="#model-parts" title="Permalink to this headline">¶</a></h2>
<p><strong>Structure:</strong> These are the core assumptions of the model.  Whatever you do in the fitting process, these are not going to change, they are set in stone.</p>
<p>e.g., in linear regression:  <span class="math notranslate nohighlight">\(\hat y = a x + b\)</span></p>
<p>e.g., not <span class="math notranslate nohighlight">\(\hat y = a x^2 + b\)</span></p>
<p><strong>Parameters:</strong> These are the moving parts of the model that are fit to the data.</p>
<p>e.g., in linear regression: <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span></p>
<p><strong>Loss / objective / goodness of fit function:</strong> This is a function that can consider the model and its parameters, and the observed data, and returns a number indicating how well/badly the model fits.  How do I decide whether one value of the parameters is better or worse than another?</p>
<p>e.g., in linear regression: this could be mean squared error, or the likelihood under a normal probability distribution, or the posterior probability of a particular set of parameters, or the mean absolute error, or the quantile error, or… etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7feb24762490&gt;
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_12_1.png" src="../_images/css2-lecture-5_12_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.02681874,  0.56329742])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.29381036,  0.29680478, -0.19093148, -0.13610305,  0.83194639,
       -0.44725168,  0.22421647, -0.35865114,  0.21757239,  0.20511214])
</pre></div>
</div>
</div>
</div>
<p><strong>Optimization algorithm:</strong> how do I find the <em>best fitting</em> (loss minimizing, objective maximizing, goodness of fit maximizing) values of the parameters?</p>
<p>e.g., in linear regression, there are various linear algebra tricks available to do so robustly (out of scope here).</p>
</div>
<div class="section" id="model-structures-and-parameters">
<h2>Model structures and parameters<a class="headerlink" href="#model-structures-and-parameters" title="Permalink to this headline">¶</a></h2>
<p>There are <em>many</em>.  We will spend the bulk of class talking about the varieties of model structures that are out there, what they assume, and what they are good at.</p>
</div>
<div class="section" id="loss-functions">
<h2>Loss functions<a class="headerlink" href="#loss-functions" title="Permalink to this headline">¶</a></h2>
<p>There are relatively few, for common problem types.  We will learn the basics of these because they are essential to understanding what models are doing.</p>
<div class="section" id="loss-for-regression">
<h3>Loss for Regression<a class="headerlink" href="#loss-for-regression" title="Permalink to this headline">¶</a></h3>
<p>Regression: predict some number from other data.</p>
<p>Let’s say we want to predict weight.  How do we evaluate how well we have done this?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># our loss function is a single number that </span>
<span class="c1"># tells us how bad our predictions are.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Errors</strong></p>
<ol class="simple">
<li><p>Ratio error.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">weight</span><span class="o">/</span><span class="n">predicted_weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.        , -0.03077166,  0.        ,  0.87546874,  0.01550419])
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Linear error</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_weight</span> <span class="o">-</span> <span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([   0,    5,    0, -140,   -2])
</pre></div>
</div>
</div>
</div>
<p><strong>Summarizing errors</strong></p>
<p>Mean of the squared errors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors</span> <span class="o">=</span> <span class="n">predicted_weight</span> <span class="o">-</span> <span class="n">weight</span>
<span class="n">errors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([   0,    5,    0, -140,   -2])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># squared errors</span>
<span class="n">errors</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([    0,    25,     0, 19600,     4])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">errors</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="section" id="sum-squared-error">
<h4>Sum squared error<a class="headerlink" href="#sum-squared-error" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>

<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">175</span><span class="p">])</span>

<span class="c1"># they increase with number of data points.  </span>
<span class="c1"># because we sum all data point errors squared.</span>
<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19654
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>

<span class="c1"># sum of squared errors dominated by large errors.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19600
</pre></div>
</div>
</div>
</div>
<p><strong>Mean squared errors</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3920.0
</pre></div>
</div>
</div>
</div>
<p>Aside: standard error of the mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([180, 160, 175, 240, 130])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>177.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.099689437998485
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">177</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="mi">177</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[145, 209]
</pre></div>
</div>
</div>
</div>
<p>Simple model:</p>
<p><span class="math notranslate nohighlight">\(\hat y = m\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter / prediction</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># error</span>
<span class="nb">print</span><span class="p">(</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span>
<span class="c1"># squared error</span>
<span class="nb">print</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># sum of squared error</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># mean of squared error</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  3. -17.  -2.  63. -47.]
[   9.  289.    4. 3969. 2209.]
6480.0
1296.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
<span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1296.0
</pre></div>
</div>
</div>
</div>
<p><strong>Loss function:</strong> is some function of the prediction, and the actual data, that returns one number, which is bigger when our predictions are worse.</p>
<p><strong>Mean squared error</strong></p>
<p><strong>Mean absolute error</strong></p>
<p><strong>not exactly right proportion</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3920.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mae</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mae</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>28.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_error</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">280</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mean_error</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">not_exactly_right_proportion</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">not_exactly_right_proportion</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="loss-for-classification">
<h3>Loss for Classification<a class="headerlink" href="#loss-for-classification" title="Permalink to this headline">¶</a></h3>
<p>Classification: predict a label, (in contrast to a number)</p>
<p>Let’s say we want to predict sex (male/female).  How do we evaluate how well we have done this?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># binary predictions loss functions:</span>

<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>

<span class="n">predicted_y</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inaccuracy</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>

<span class="n">predicted_y</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Developing new loss functions is where a lot of the action is for state of the art machine learning, because this is where we specify what it means for a machine to achieve certain intelligent goals.  This is particularly important for RL, and other domains where we don’t actually know what we mean by “intelligent behavior”.</p>
</div>
</div>
<div class="section" id="optimization-algorithm">
<h2>Optimization algorithm<a class="headerlink" href="#optimization-algorithm" title="Permalink to this headline">¶</a></h2>
<p>There are many. Very active area of research, we will generally not cover them in great detail.  Let’s cover some basics though.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># goal: predict weight from height</span>

<span class="c1"># model is: predicted_y = slope * x + intercept</span>

<span class="c1"># parameters are: slope, intercept</span>

<span class="c1"># loss function:  mean absolute error</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">hw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;height-weight.csv&#39;</span><span class="p">)</span>

<span class="n">hw</span> <span class="o">=</span> <span class="n">hw</span><span class="p">[</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">36</span><span class="p">]</span>

<span class="n">hw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>67.75</td>
      <td>154.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>72.25</td>
      <td>173.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>66.25</td>
      <td>154.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>72.25</td>
      <td>184.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>71.25</td>
      <td>184.25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>247</th>
      <td>67.00</td>
      <td>134.25</td>
    </tr>
    <tr>
      <th>248</th>
      <td>69.75</td>
      <td>201.00</td>
    </tr>
    <tr>
      <th>249</th>
      <td>66.00</td>
      <td>186.75</td>
    </tr>
    <tr>
      <th>250</th>
      <td>70.50</td>
      <td>190.75</td>
    </tr>
    <tr>
      <th>251</th>
      <td>70.00</td>
      <td>207.50</td>
    </tr>
  </tbody>
</table>
<p>251 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7feb25d452e0&gt;]
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_62_1.png" src="../_images/css2-lecture-5_62_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mae</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20.21573705179283
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">5.75</span><span class="p">,</span> <span class="o">-</span><span class="mi">227</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;m-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;y-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7feb25e226d0&gt;]
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_65_1.png" src="../_images/css2-lecture-5_65_1.png" />
</div>
</div>
<div class="section" id="grid-search">
<h3>Grid search<a class="headerlink" href="#grid-search" title="Permalink to this headline">¶</a></h3>
<p>Consider a bunch of possible parameter settings.  Evaluate loss for each.  Pick the best one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">current_lowest</span> <span class="o">=</span> <span class="mi">1000000000</span>

<span class="n">best_slope</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">best_intercept</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">slope</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">intercept</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
        <span class="n">current_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> 
                                  <span class="n">intercept</span><span class="p">,</span> 
                                  <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> 
                          <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">current_mae</span> <span class="o">&lt;</span> <span class="n">current_lowest</span><span class="p">:</span>
            <span class="n">current_lowest</span> <span class="o">=</span> <span class="n">current_mae</span>
            <span class="n">best_slope</span> <span class="o">=</span> <span class="n">slope</span>
            <span class="n">best_intercept</span> <span class="o">=</span> <span class="n">intercept</span>
        <span class="c1">#print(f&#39;{slope=}, {intercept=}, {current_mae=}&#39;)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">current_lowest</span><span class="p">,</span> <span class="n">best_slope</span><span class="p">,</span> <span class="n">best_intercept</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18.837854642037907 5.757575757575758 -227.2727272727273
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.        , 0.05050505, 0.1010101 , 0.15151515, 0.2020202 ,
       0.25252525, 0.3030303 , 0.35353535, 0.4040404 , 0.45454545,
       0.50505051, 0.55555556, 0.60606061, 0.65656566, 0.70707071,
       0.75757576, 0.80808081, 0.85858586, 0.90909091, 0.95959596,
       1.01010101, 1.06060606, 1.11111111, 1.16161616, 1.21212121,
       1.26262626, 1.31313131, 1.36363636, 1.41414141, 1.46464646,
       1.51515152, 1.56565657, 1.61616162, 1.66666667, 1.71717172,
       1.76767677, 1.81818182, 1.86868687, 1.91919192, 1.96969697,
       2.02020202, 2.07070707, 2.12121212, 2.17171717, 2.22222222,
       2.27272727, 2.32323232, 2.37373737, 2.42424242, 2.47474747,
       2.52525253, 2.57575758, 2.62626263, 2.67676768, 2.72727273,
       2.77777778, 2.82828283, 2.87878788, 2.92929293, 2.97979798,
       3.03030303, 3.08080808, 3.13131313, 3.18181818, 3.23232323,
       3.28282828, 3.33333333, 3.38383838, 3.43434343, 3.48484848,
       3.53535354, 3.58585859, 3.63636364, 3.68686869, 3.73737374,
       3.78787879, 3.83838384, 3.88888889, 3.93939394, 3.98989899,
       4.04040404, 4.09090909, 4.14141414, 4.19191919, 4.24242424,
       4.29292929, 4.34343434, 4.39393939, 4.44444444, 4.49494949,
       4.54545455, 4.5959596 , 4.64646465, 4.6969697 , 4.74747475,
       4.7979798 , 4.84848485, 4.8989899 , 4.94949495, 5.        ])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="random-search">
<h3>Random search<a class="headerlink" href="#random-search" title="Permalink to this headline">¶</a></h3>
<p>Start with some parameter values.  Propose a local perturbation.  If it is better, adopt that one, and continue.  Until some criterion is reached.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">current</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>

<span class="n">attempts</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">attempts</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
    <span class="n">new_slope</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">new_intercept</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span>
    
    <span class="n">new_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">new_slope</span><span class="p">,</span> 
                          <span class="n">new_intercept</span><span class="p">,</span> 
                          <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> 
                  <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">current</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">new_mae</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">attempts</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">new_mae</span> <span class="o">&lt;</span> <span class="n">current</span><span class="p">:</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="n">new_slope</span>
        <span class="n">intercept</span> <span class="o">=</span> <span class="n">new_intercept</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">new_mae</span>
        <span class="n">attempts</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">slope</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">intercept</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">current</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=178.82051792828688 new_mae=205.61885365730285
current=178.82051792828688 new_mae=199.2298862067952
current=178.82051792828688 new_mae=212.71366063887146
current=178.82051792828688 new_mae=199.51075552966424
current=178.82051792828688 new_mae=191.72710339168003
current=178.82051792828688 new_mae=174.41392624782299
slope=-0.029536881483398725 intercept=6.483352176157178 current=174.41392624782299
current=174.41392624782299 new_mae=199.73943866568712
current=174.41392624782299 new_mae=171.6977657717031
slope=0.07442495210020172 intercept=1.8898774368054827 current=171.6977657717031
current=171.6977657717031 new_mae=143.04409281186636
slope=0.3404891466869665 intercept=11.836375472071579 current=143.04409281186636
current=143.04409281186636 new_mae=100.32216747009944
slope=0.8282781109645933 intercept=20.261489492836255 current=100.32216747009944
current=100.32216747009944 new_mae=80.22287635400012
slope=1.0276242805002567 intercept=26.344600529392196 current=80.22287635400012
current=80.22287635400012 new_mae=113.3348242598898
current=80.22287635400012 new_mae=74.1866174345663
slope=1.0611139467595894 intercept=30.026175663388894 current=74.1866174345663
current=74.1866174345663 new_mae=79.11918927894543
current=74.1866174345663 new_mae=61.60301053321581
slope=1.245331926175389 intercept=29.65727698414169 current=61.60301053321581
current=61.60301053321581 new_mae=36.56402037055442
slope=1.5094096035012705 intercept=37.139972055499726 current=36.56402037055442
current=36.56402037055442 new_mae=70.8154743938535
current=36.56402037055442 new_mae=23.58060789705029
slope=1.683095447392232 intercept=43.71307192856965 current=23.58060789705029
current=23.58060789705029 new_mae=38.36593449268705
current=23.58060789705029 new_mae=20.48560262914041
slope=1.857911837430267 intercept=45.51183378461466 current=20.48560262914041
current=20.48560262914041 new_mae=20.462978912453437
slope=1.8455819685949661 intercept=44.54982696220511 current=20.462978912453437
current=20.462978912453437 new_mae=42.250853472826215
current=20.462978912453437 new_mae=36.26661208482807
current=20.462978912453437 new_mae=26.78053508161154
current=20.462978912453437 new_mae=20.85487876490198
current=20.462978912453437 new_mae=20.991985532160893
current=20.462978912453437 new_mae=28.4542590288944
current=20.462978912453437 new_mae=20.754669113609236
current=20.462978912453437 new_mae=28.66072580340266
current=20.462978912453437 new_mae=23.940411497579593
current=20.462978912453437 new_mae=21.030977857109608
current=20.462978912453437 new_mae=35.3903926515584
current=20.462978912453437 new_mae=38.894013191974814
current=20.462978912453437 new_mae=21.15762609010052
current=20.462978912453437 new_mae=29.16525796000548
current=20.462978912453437 new_mae=27.16992911031435
current=20.462978912453437 new_mae=31.730588101768955
current=20.462978912453437 new_mae=20.51787468514589
current=20.462978912453437 new_mae=29.298358988344017
current=20.462978912453437 new_mae=21.68803273912997
current=20.462978912453437 new_mae=24.509604348302375
current=20.462978912453437 new_mae=24.89327625749728
current=20.462978912453437 new_mae=28.751532425122722
current=20.462978912453437 new_mae=22.96090913507676
current=20.462978912453437 new_mae=22.26995095108662
current=20.462978912453437 new_mae=23.116207451126737
current=20.462978912453437 new_mae=31.898869802988393
current=20.462978912453437 new_mae=20.65312626140417
current=20.462978912453437 new_mae=23.52313952050859
current=20.462978912453437 new_mae=36.837469326371135
current=20.462978912453437 new_mae=23.381729072849243
current=20.462978912453437 new_mae=22.824487852599326
current=20.462978912453437 new_mae=20.438286106737074
slope=1.8764106820470219 intercept=43.46169550702613 current=20.438286106737074
current=20.438286106737074 new_mae=20.87550930295303
current=20.438286106737074 new_mae=21.24903744949975
current=20.438286106737074 new_mae=22.94753118085711
current=20.438286106737074 new_mae=32.2665776316944
current=20.438286106737074 new_mae=21.123263794732136
current=20.438286106737074 new_mae=39.38236834338943
current=20.438286106737074 new_mae=22.06675151622203
current=20.438286106737074 new_mae=30.398785315663478
current=20.438286106737074 new_mae=32.80300061903268
current=20.438286106737074 new_mae=24.644766377277218
current=20.438286106737074 new_mae=21.508548535808615
current=20.438286106737074 new_mae=27.118674131310605
current=20.438286106737074 new_mae=22.93729555111837
current=20.438286106737074 new_mae=24.76367212028137
current=20.438286106737074 new_mae=20.651548696481395
current=20.438286106737074 new_mae=25.054505795539043
current=20.438286106737074 new_mae=29.54745619309692
current=20.438286106737074 new_mae=23.99844475234578
current=20.438286106737074 new_mae=28.192863346328362
current=20.438286106737074 new_mae=20.434671128142092
slope=2.0004061417144756 intercept=36.40171637970052 current=20.434671128142092
current=20.434671128142092 new_mae=20.778079086440776
current=20.434671128142092 new_mae=20.703007880999305
current=20.434671128142092 new_mae=34.08078401128981
current=20.434671128142092 new_mae=27.328201670418608
current=20.434671128142092 new_mae=21.67750811611599
current=20.434671128142092 new_mae=20.520157269240958
current=20.434671128142092 new_mae=26.512213032902935
current=20.434671128142092 new_mae=27.33438291903071
current=20.434671128142092 new_mae=22.409178568465233
current=20.434671128142092 new_mae=21.04961454953183
current=20.434671128142092 new_mae=20.48375269907345
current=20.434671128142092 new_mae=38.64033227553539
current=20.434671128142092 new_mae=32.965530051125675
current=20.434671128142092 new_mae=23.400673632870454
current=20.434671128142092 new_mae=22.23206936260708
current=20.434671128142092 new_mae=25.677701803283075
current=20.434671128142092 new_mae=24.26244745791545
current=20.434671128142092 new_mae=39.19909323067647
current=20.434671128142092 new_mae=29.459992936779557
current=20.434671128142092 new_mae=23.934150596476584
current=20.434671128142092 new_mae=20.678736166205386
current=20.434671128142092 new_mae=22.626030426128583
current=20.434671128142092 new_mae=25.639326269010585
current=20.434671128142092 new_mae=20.6443287698905
current=20.434671128142092 new_mae=29.67169062527857
current=20.434671128142092 new_mae=37.6293447383091
current=20.434671128142092 new_mae=23.727563840226097
current=20.434671128142092 new_mae=22.571181605989842
current=20.434671128142092 new_mae=24.63691368823733
current=20.434671128142092 new_mae=28.486999829868545
current=20.434671128142092 new_mae=39.92681494817271
current=20.434671128142092 new_mae=28.32622959815397
current=20.434671128142092 new_mae=38.36823328833729
current=20.434671128142092 new_mae=26.898410983205824
current=20.434671128142092 new_mae=28.414006260382855
current=20.434671128142092 new_mae=27.342719145517073
current=20.434671128142092 new_mae=35.181685175961384
current=20.434671128142092 new_mae=42.52892715154414
current=20.434671128142092 new_mae=20.488286836071786
current=20.434671128142092 new_mae=31.94413415782969
current=20.434671128142092 new_mae=21.148162098035744
current=20.434671128142092 new_mae=31.981537913118768
current=20.434671128142092 new_mae=24.88709081736637
current=20.434671128142092 new_mae=22.969398700165815
current=20.434671128142092 new_mae=30.05237126643263
current=20.434671128142092 new_mae=31.33951238399332
current=20.434671128142092 new_mae=36.050664082914466
current=20.434671128142092 new_mae=37.558556428737674
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=20.434671128142092 new_mae=26.291266731629836
current=20.434671128142092 new_mae=31.740226998835936
current=20.434671128142092 new_mae=26.94409255972579
current=20.434671128142092 new_mae=36.957496119724965
current=20.434671128142092 new_mae=20.798787766459654
current=20.434671128142092 new_mae=22.555486622930736
current=20.434671128142092 new_mae=20.44339566171038
current=20.434671128142092 new_mae=21.269453262610188
current=20.434671128142092 new_mae=23.755403936635826
current=20.434671128142092 new_mae=36.26376584457206
current=20.434671128142092 new_mae=24.55653988342449
current=20.434671128142092 new_mae=25.16590808547272
current=20.434671128142092 new_mae=21.963666112814277
current=20.434671128142092 new_mae=22.46756480476032
current=20.434671128142092 new_mae=27.315446094637114
current=20.434671128142092 new_mae=20.59524763935044
current=20.434671128142092 new_mae=37.32698166123945
current=20.434671128142092 new_mae=33.57587099390783
current=20.434671128142092 new_mae=26.16029924765224
current=20.434671128142092 new_mae=31.70164329271281
current=20.434671128142092 new_mae=22.984385768795104
current=20.434671128142092 new_mae=25.083662493296263
current=20.434671128142092 new_mae=27.702801001882708
current=20.434671128142092 new_mae=20.84142577364546
current=20.434671128142092 new_mae=22.785952818374415
current=20.434671128142092 new_mae=20.499400809454052
current=20.434671128142092 new_mae=20.984824576918133
current=20.434671128142092 new_mae=22.247645817821795
current=20.434671128142092 new_mae=20.608046521009996
current=20.434671128142092 new_mae=32.866830067599096
current=20.434671128142092 new_mae=38.4787379390916
current=20.434671128142092 new_mae=32.30455803241343
current=20.434671128142092 new_mae=27.005528703530885
current=20.434671128142092 new_mae=44.142818968864724
current=20.434671128142092 new_mae=28.39575694611618
current=20.434671128142092 new_mae=20.678834626429058
current=20.434671128142092 new_mae=23.885217029628315
current=20.434671128142092 new_mae=21.583853603581257
current=20.434671128142092 new_mae=21.128847409501446
current=20.434671128142092 new_mae=23.570925428085598
current=20.434671128142092 new_mae=21.125936221191637
current=20.434671128142092 new_mae=27.30551941243177
current=20.434671128142092 new_mae=41.430529449546896
current=20.434671128142092 new_mae=20.350231351924776
slope=1.9682606780526752 intercept=36.38285538771174 current=20.350231351924776
current=20.350231351924776 new_mae=30.049451038290723
current=20.350231351924776 new_mae=23.5424984430236
current=20.350231351924776 new_mae=20.44670797224956
current=20.350231351924776 new_mae=20.69280570149436
current=20.350231351924776 new_mae=23.307748197094067
current=20.350231351924776 new_mae=27.886615932043576
current=20.350231351924776 new_mae=31.116099441952255
current=20.350231351924776 new_mae=24.457194629321926
current=20.350231351924776 new_mae=23.225434403942366
current=20.350231351924776 new_mae=23.455950458780944
current=20.350231351924776 new_mae=21.741780901369577
current=20.350231351924776 new_mae=23.662885507843168
current=20.350231351924776 new_mae=25.262799231052945
current=20.350231351924776 new_mae=22.027188491336766
current=20.350231351924776 new_mae=28.938067122246842
current=20.350231351924776 new_mae=24.810391788314163
current=20.350231351924776 new_mae=27.77641656897546
current=20.350231351924776 new_mae=21.020222589255717
current=20.350231351924776 new_mae=21.452508701290515
current=20.350231351924776 new_mae=30.696564583075705
current=20.350231351924776 new_mae=27.851691955633797
current=20.350231351924776 new_mae=32.84521422248512
current=20.350231351924776 new_mae=20.345426628698124
slope=2.090890775888115 intercept=29.856402964832835 current=20.345426628698124
current=20.345426628698124 new_mae=20.405138634990504
current=20.345426628698124 new_mae=31.81243755236033
current=20.345426628698124 new_mae=27.815754246496777
current=20.345426628698124 new_mae=23.13762840320063
current=20.345426628698124 new_mae=20.97301770727086
current=20.345426628698124 new_mae=20.300460415156333
slope=2.2441540939827145 intercept=19.950524021768608 current=20.300460415156333
current=20.300460415156333 new_mae=26.65190677524643
current=20.300460415156333 new_mae=28.186472431757995
current=20.300460415156333 new_mae=23.08900207934399
current=20.300460415156333 new_mae=22.626417509762142
current=20.300460415156333 new_mae=20.516542483901077
current=20.300460415156333 new_mae=28.770390405198807
current=20.300460415156333 new_mae=22.287021918702948
current=20.300460415156333 new_mae=36.86545347892699
current=20.300460415156333 new_mae=32.31387599540264
current=20.300460415156333 new_mae=23.35770969651941
current=20.300460415156333 new_mae=24.9165277622198
current=20.300460415156333 new_mae=21.561263117049894
current=20.300460415156333 new_mae=21.731616466586143
current=20.300460415156333 new_mae=38.570846841020156
current=20.300460415156333 new_mae=31.076089423345348
current=20.300460415156333 new_mae=25.917582562590585
current=20.300460415156333 new_mae=25.952044059902374
current=20.300460415156333 new_mae=20.401311287845914
current=20.300460415156333 new_mae=23.171309160122295
current=20.300460415156333 new_mae=21.42621750711256
current=20.300460415156333 new_mae=25.401575678225395
current=20.300460415156333 new_mae=26.051704713343494
current=20.300460415156333 new_mae=20.279041877008932
slope=2.3110404664498656 intercept=15.55798206786005 current=20.279041877008932
current=20.279041877008932 new_mae=23.487951854642475
current=20.279041877008932 new_mae=22.489090054901975
current=20.279041877008932 new_mae=29.555178509437994
current=20.279041877008932 new_mae=38.95507611496172
current=20.279041877008932 new_mae=37.135932525091235
current=20.279041877008932 new_mae=25.746894508746724
current=20.279041877008932 new_mae=22.66232394133542
current=20.279041877008932 new_mae=20.578156976216412
current=20.279041877008932 new_mae=24.999180899204177
current=20.279041877008932 new_mae=21.47850444718402
current=20.279041877008932 new_mae=33.41701979145738
current=20.279041877008932 new_mae=34.5257935900692
current=20.279041877008932 new_mae=33.939963066580134
current=20.279041877008932 new_mae=23.198689676943996
current=20.279041877008932 new_mae=23.407892785912903
current=20.279041877008932 new_mae=26.304132070654436
current=20.279041877008932 new_mae=27.67378167520423
current=20.279041877008932 new_mae=21.48608424460197
current=20.279041877008932 new_mae=41.41076642669978
current=20.279041877008932 new_mae=43.59970201035713
current=20.279041877008932 new_mae=24.580085318693015
current=20.279041877008932 new_mae=24.06113678293771
current=20.279041877008932 new_mae=20.471060208922726
current=20.279041877008932 new_mae=20.52475396422168
current=20.279041877008932 new_mae=31.068836259755273
current=20.279041877008932 new_mae=21.544752489738656
current=20.279041877008932 new_mae=27.610916826364754
current=20.279041877008932 new_mae=28.629259408609286
current=20.279041877008932 new_mae=22.800532966218015
current=20.279041877008932 new_mae=21.36974194765707
current=20.279041877008932 new_mae=21.786842992634796
current=20.279041877008932 new_mae=20.788596564189017
current=20.279041877008932 new_mae=36.83241370775919
current=20.279041877008932 new_mae=21.106908485176866
current=20.279041877008932 new_mae=36.28202805429138
current=20.279041877008932 new_mae=21.887625829195727
current=20.279041877008932 new_mae=29.729194540209633
current=20.279041877008932 new_mae=21.79875102069468
current=20.279041877008932 new_mae=42.86464871650782
current=20.279041877008932 new_mae=35.90167528038037
current=20.279041877008932 new_mae=20.368370077300217
current=20.279041877008932 new_mae=28.587441083406663
current=20.279041877008932 new_mae=21.066469561941688
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=20.279041877008932 new_mae=21.243413269272995
current=20.279041877008932 new_mae=24.934719893874078
current=20.279041877008932 new_mae=20.412843179772594
current=20.279041877008932 new_mae=23.51317620068447
current=20.279041877008932 new_mae=28.787913388187444
current=20.279041877008932 new_mae=36.12780203034855
current=20.279041877008932 new_mae=29.305683871201257
current=20.279041877008932 new_mae=21.23388297036812
current=20.279041877008932 new_mae=24.13986092385294
current=20.279041877008932 new_mae=24.337619429443002
current=20.279041877008932 new_mae=29.30691646660731
current=20.279041877008932 new_mae=23.379724778787406
current=20.279041877008932 new_mae=27.107247852816904
current=20.279041877008932 new_mae=36.95225825595674
current=20.279041877008932 new_mae=21.050081291194576
current=20.279041877008932 new_mae=20.28216888733095
current=20.279041877008932 new_mae=24.076228471871335
current=20.279041877008932 new_mae=22.813456714132517
current=20.279041877008932 new_mae=25.906484950922525
current=20.279041877008932 new_mae=22.92565697264975
current=20.279041877008932 new_mae=31.474865846244857
current=20.279041877008932 new_mae=20.518719392710736
current=20.279041877008932 new_mae=20.298804954948405
current=20.279041877008932 new_mae=20.53786492856174
current=20.279041877008932 new_mae=22.896841795442082
current=20.279041877008932 new_mae=22.72328220705101
current=20.279041877008932 new_mae=32.52598043415286
current=20.279041877008932 new_mae=34.43845437587103
current=20.279041877008932 new_mae=24.657782579953867
current=20.279041877008932 new_mae=20.41224903604182
current=20.279041877008932 new_mae=34.14947241701134
current=20.279041877008932 new_mae=26.22511812002393
current=20.279041877008932 new_mae=22.14252568839559
current=20.279041877008932 new_mae=20.40465366618683
current=20.279041877008932 new_mae=20.72666866333452
current=20.279041877008932 new_mae=23.566571161046117
current=20.279041877008932 new_mae=24.361345407144043
current=20.279041877008932 new_mae=25.705490964455972
current=20.279041877008932 new_mae=20.174759385243668
slope=2.3401150841261624 intercept=12.634302161710856 current=20.174759385243668
current=20.174759385243668 new_mae=38.21307723720322
current=20.174759385243668 new_mae=40.63947073071366
current=20.174759385243668 new_mae=24.318733480011193
current=20.174759385243668 new_mae=20.291416742492824
current=20.174759385243668 new_mae=23.023491914991638
current=20.174759385243668 new_mae=24.232864409432715
current=20.174759385243668 new_mae=26.290373832035062
current=20.174759385243668 new_mae=21.075674420296117
current=20.174759385243668 new_mae=31.034145848252106
current=20.174759385243668 new_mae=26.91221533183837
current=20.174759385243668 new_mae=26.382719624947935
current=20.174759385243668 new_mae=22.925210681111036
current=20.174759385243668 new_mae=29.937724341379933
current=20.174759385243668 new_mae=32.768878966016594
current=20.174759385243668 new_mae=24.47389034081301
current=20.174759385243668 new_mae=24.804917729145917
current=20.174759385243668 new_mae=20.15317867223738
slope=2.2776118398485816 intercept=16.083145833519247 current=20.15317867223738
current=20.15317867223738 new_mae=40.349312146977205
current=20.15317867223738 new_mae=21.8090066935338
current=20.15317867223738 new_mae=20.10307526274556
slope=2.26866872201611 intercept=15.588780935125921 current=20.10307526274556
current=20.10307526274556 new_mae=20.11498377575461
current=20.10307526274556 new_mae=25.055217446091028
current=20.10307526274556 new_mae=20.023022288154106
slope=2.3703952722668116 intercept=8.261224634828002 current=20.023022288154106
current=20.023022288154106 new_mae=20.097672890722464
current=20.023022288154106 new_mae=22.68006001989514
current=20.023022288154106 new_mae=41.22531820231207
current=20.023022288154106 new_mae=31.226572284647524
current=20.023022288154106 new_mae=29.178323815478045
current=20.023022288154106 new_mae=22.507395557411932
current=20.023022288154106 new_mae=26.343522123912685
current=20.023022288154106 new_mae=27.48894344629654
current=20.023022288154106 new_mae=22.205034807168346
current=20.023022288154106 new_mae=21.790104595956056
current=20.023022288154106 new_mae=21.350070240627026
current=20.023022288154106 new_mae=20.19317126661361
current=20.023022288154106 new_mae=33.05311316730025
current=20.023022288154106 new_mae=23.987711750229558
current=20.023022288154106 new_mae=25.08777842199911
current=20.023022288154106 new_mae=20.59064285890241
current=20.023022288154106 new_mae=20.82390190988668
current=20.023022288154106 new_mae=38.58047682887086
current=20.023022288154106 new_mae=37.34584681032276
current=20.023022288154106 new_mae=26.885710825786347
current=20.023022288154106 new_mae=37.002486151510524
current=20.023022288154106 new_mae=24.414836446290686
current=20.023022288154106 new_mae=20.82166263749573
current=20.023022288154106 new_mae=21.102838125267333
current=20.023022288154106 new_mae=28.776433806131156
current=20.023022288154106 new_mae=26.812546317985593
current=20.023022288154106 new_mae=22.144857568223053
current=20.023022288154106 new_mae=20.080705318852257
current=20.023022288154106 new_mae=28.61177296214279
current=20.023022288154106 new_mae=20.089916548133147
current=20.023022288154106 new_mae=20.135260628473098
current=20.023022288154106 new_mae=26.398710961966234
current=20.023022288154106 new_mae=23.850682814080578
current=20.023022288154106 new_mae=19.96901482835473
slope=2.4644965760731457 intercept=0.7601546265337182 current=19.96901482835473
current=19.96901482835473 new_mae=26.344230235073066
current=19.96901482835473 new_mae=28.436235118021756
current=19.96901482835473 new_mae=33.24982407637637
current=19.96901482835473 new_mae=43.90806656207124
current=19.96901482835473 new_mae=35.526817550928705
current=19.96901482835473 new_mae=33.536820354319936
current=19.96901482835473 new_mae=27.286018985457936
current=19.96901482835473 new_mae=27.941118593414444
current=19.96901482835473 new_mae=20.10386628526977
current=19.96901482835473 new_mae=23.51260558480109
current=19.96901482835473 new_mae=27.20079605442387
current=19.96901482835473 new_mae=32.78777884162959
current=19.96901482835473 new_mae=23.078783203558512
current=19.96901482835473 new_mae=28.307963718011457
current=19.96901482835473 new_mae=25.129780780884733
current=19.96901482835473 new_mae=32.72781911771257
current=19.96901482835473 new_mae=33.259970661228714
current=19.96901482835473 new_mae=30.95283219947889
current=19.96901482835473 new_mae=21.246677109456716
current=19.96901482835473 new_mae=19.90172173115661
slope=2.5396543817789676 intercept=-3.684961598800431 current=19.90172173115661
current=19.90172173115661 new_mae=32.20795150508468
current=19.90172173115661 new_mae=20.24912782970985
current=19.90172173115661 new_mae=25.573488696608035
current=19.90172173115661 new_mae=20.35885985090137
current=19.90172173115661 new_mae=36.44989019833937
current=19.90172173115661 new_mae=31.969829630545163
current=19.90172173115661 new_mae=32.67167037968905
current=19.90172173115661 new_mae=21.663441596223603
current=19.90172173115661 new_mae=26.0933457731157
current=19.90172173115661 new_mae=20.502024312397626
current=19.90172173115661 new_mae=25.916278931341772
current=19.90172173115661 new_mae=23.00994143157647
current=19.90172173115661 new_mae=23.379659629804276
current=19.90172173115661 new_mae=31.263005390098712
current=19.90172173115661 new_mae=25.190289774086082
current=19.90172173115661 new_mae=19.975261302372193
current=19.90172173115661 new_mae=21.56666529828409
current=19.90172173115661 new_mae=23.15997586507711
current=19.90172173115661 new_mae=25.168223274739944
current=19.90172173115661 new_mae=34.01944762565556
current=19.90172173115661 new_mae=27.4896247431411
current=19.90172173115661 new_mae=29.54109112177181
current=19.90172173115661 new_mae=22.5079088915168
current=19.90172173115661 new_mae=20.97255749884035
current=19.90172173115661 new_mae=24.663057357199932
current=19.90172173115661 new_mae=31.726531461653927
current=19.90172173115661 new_mae=33.542558744389574
current=19.90172173115661 new_mae=32.543967109435755
current=19.90172173115661 new_mae=19.996992251364645
current=19.90172173115661 new_mae=21.29395526937003
current=19.90172173115661 new_mae=24.556193659114555
current=19.90172173115661 new_mae=21.45845717577168
current=19.90172173115661 new_mae=21.05703530255287
current=19.90172173115661 new_mae=23.209498488249974
current=19.90172173115661 new_mae=21.993032297881392
current=19.90172173115661 new_mae=19.977759064849824
current=19.90172173115661 new_mae=29.870731292674307
current=19.90172173115661 new_mae=31.225826233898637
current=19.90172173115661 new_mae=20.38178552363308
current=19.90172173115661 new_mae=27.355665506450606
current=19.90172173115661 new_mae=20.262366183118157
current=19.90172173115661 new_mae=36.9869058833198
current=19.90172173115661 new_mae=25.7903458216041
current=19.90172173115661 new_mae=20.134215523267194
current=19.90172173115661 new_mae=20.02644301473089
current=19.90172173115661 new_mae=20.34719025833745
current=19.90172173115661 new_mae=34.85177337016692
current=19.90172173115661 new_mae=27.4407231392424
current=19.90172173115661 new_mae=20.872252721783102
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.90172173115661 new_mae=23.331654491768784
current=19.90172173115661 new_mae=27.988388822716786
current=19.90172173115661 new_mae=39.60505456006814
current=19.90172173115661 new_mae=19.904217506619837
current=19.90172173115661 new_mae=26.85861151825269
current=19.90172173115661 new_mae=39.46618320714721
current=19.90172173115661 new_mae=31.355451341074737
current=19.90172173115661 new_mae=31.723825007222906
current=19.90172173115661 new_mae=23.074279381744965
current=19.90172173115661 new_mae=25.417541621682496
current=19.90172173115661 new_mae=28.306245851646526
current=19.90172173115661 new_mae=24.99583018708971
current=19.90172173115661 new_mae=23.927559343506
current=19.90172173115661 new_mae=29.133109490911448
current=19.90172173115661 new_mae=27.309999841348255
current=19.90172173115661 new_mae=22.54613753178786
current=19.90172173115661 new_mae=25.635349132267223
current=19.90172173115661 new_mae=39.42852656948846
current=19.90172173115661 new_mae=30.115423961088634
current=19.90172173115661 new_mae=21.070883516336593
current=19.90172173115661 new_mae=32.81355605951237
current=19.90172173115661 new_mae=19.930521550659293
current=19.90172173115661 new_mae=32.36575716335357
current=19.90172173115661 new_mae=28.943094771916122
current=19.90172173115661 new_mae=35.24012683378965
current=19.90172173115661 new_mae=28.079528921538106
current=19.90172173115661 new_mae=21.371233006566666
current=19.90172173115661 new_mae=30.823711606224364
current=19.90172173115661 new_mae=20.756218029196017
current=19.90172173115661 new_mae=20.00032990766671
current=19.90172173115661 new_mae=22.802722180583913
current=19.90172173115661 new_mae=19.95584901742667
current=19.90172173115661 new_mae=33.43200154826746
current=19.90172173115661 new_mae=26.871800647017658
current=19.90172173115661 new_mae=19.998159668222907
current=19.90172173115661 new_mae=25.840886441937126
current=19.90172173115661 new_mae=24.120552417676624
current=19.90172173115661 new_mae=32.39901756963991
current=19.90172173115661 new_mae=21.36700257951444
current=19.90172173115661 new_mae=21.958044726932137
current=19.90172173115661 new_mae=26.111277116278515
current=19.90172173115661 new_mae=20.07109542557795
current=19.90172173115661 new_mae=40.185578221294506
current=19.90172173115661 new_mae=41.4387695955497
current=19.90172173115661 new_mae=19.892302397984224
slope=2.679188337213947 intercept=-11.700264916813973 current=19.892302397984224
current=19.892302397984224 new_mae=19.79018710044864
slope=2.7078982754653276 intercept=-15.345901335346813 current=19.79018710044864
current=19.79018710044864 new_mae=26.71542255869035
current=19.79018710044864 new_mae=35.77696823558544
current=19.79018710044864 new_mae=24.398529448307972
current=19.79018710044864 new_mae=24.671962327060225
current=19.79018710044864 new_mae=27.956883546069026
current=19.79018710044864 new_mae=19.891289157353903
current=19.79018710044864 new_mae=23.431432849157876
current=19.79018710044864 new_mae=27.445959903104928
current=19.79018710044864 new_mae=30.68940546326429
current=19.79018710044864 new_mae=31.40560449297199
current=19.79018710044864 new_mae=21.13957402117873
current=19.79018710044864 new_mae=23.101499900021704
current=19.79018710044864 new_mae=36.82985315812797
current=19.79018710044864 new_mae=21.71142835275029
current=19.79018710044864 new_mae=22.16976703396023
current=19.79018710044864 new_mae=29.47010372874093
current=19.79018710044864 new_mae=30.561310087279953
current=19.79018710044864 new_mae=24.060452910656085
current=19.79018710044864 new_mae=33.697101661109514
current=19.79018710044864 new_mae=25.910927513347797
current=19.79018710044864 new_mae=21.959654071986783
current=19.79018710044864 new_mae=21.29850809402
current=19.79018710044864 new_mae=20.213856906728466
current=19.79018710044864 new_mae=25.163514118081547
current=19.79018710044864 new_mae=20.93491259544182
current=19.79018710044864 new_mae=30.004788897542504
current=19.79018710044864 new_mae=25.4230690382202
current=19.79018710044864 new_mae=33.10344537188109
current=19.79018710044864 new_mae=21.31072733618599
current=19.79018710044864 new_mae=24.800644617570654
current=19.79018710044864 new_mae=26.980216076151567
current=19.79018710044864 new_mae=25.74860273446497
current=19.79018710044864 new_mae=29.54503117477305
current=19.79018710044864 new_mae=24.098850132366778
current=19.79018710044864 new_mae=23.75810642066511
current=19.79018710044864 new_mae=22.246407159275
current=19.79018710044864 new_mae=28.089415339317004
current=19.79018710044864 new_mae=23.481871133724134
current=19.79018710044864 new_mae=21.811357008010752
current=19.79018710044864 new_mae=21.74113735385722
current=19.79018710044864 new_mae=35.356812068394085
current=19.79018710044864 new_mae=27.748323580013217
current=19.79018710044864 new_mae=21.181916491360422
current=19.79018710044864 new_mae=28.18015355250884
current=19.79018710044864 new_mae=22.468994467399494
current=19.79018710044864 new_mae=19.92964529484438
current=19.79018710044864 new_mae=31.496403162543274
current=19.79018710044864 new_mae=23.013231275450547
current=19.79018710044864 new_mae=21.444718033892094
current=19.79018710044864 new_mae=19.775334991403653
slope=2.8238657054797898 intercept=-22.096978055509105 current=19.775334991403653
current=19.775334991403653 new_mae=33.31853441188102
current=19.775334991403653 new_mae=27.738848872990246
current=19.775334991403653 new_mae=22.883240502998714
current=19.775334991403653 new_mae=26.559789281833908
current=19.775334991403653 new_mae=23.190978753471665
current=19.775334991403653 new_mae=30.258479213617747
current=19.775334991403653 new_mae=30.990102863120793
current=19.775334991403653 new_mae=27.125590375716413
current=19.775334991403653 new_mae=19.939965931486864
current=19.775334991403653 new_mae=36.13213291701347
current=19.775334991403653 new_mae=20.02633319395256
current=19.775334991403653 new_mae=23.884399661435253
current=19.775334991403653 new_mae=29.960694565026657
current=19.775334991403653 new_mae=30.578983476953514
current=19.775334991403653 new_mae=31.0061074477977
current=19.775334991403653 new_mae=20.873836880822026
current=19.775334991403653 new_mae=32.27184482034968
current=19.775334991403653 new_mae=23.71669231298966
current=19.775334991403653 new_mae=20.950662986284875
current=19.775334991403653 new_mae=23.421724885086068
current=19.775334991403653 new_mae=22.11048176835751
current=19.775334991403653 new_mae=25.9176590799541
current=19.775334991403653 new_mae=24.02595261561343
current=19.775334991403653 new_mae=31.566325020981868
current=19.775334991403653 new_mae=22.443310418230283
current=19.775334991403653 new_mae=21.772059635180604
current=19.775334991403653 new_mae=22.465916104775403
current=19.775334991403653 new_mae=20.5156140088529
current=19.775334991403653 new_mae=20.35112417263298
current=19.775334991403653 new_mae=21.948923647116203
current=19.775334991403653 new_mae=20.775786201279836
current=19.775334991403653 new_mae=26.468227638806983
current=19.775334991403653 new_mae=19.672382877828092
slope=2.9128865154718713 intercept=-29.26611146607369 current=19.672382877828092
current=19.672382877828092 new_mae=39.450327457792504
current=19.672382877828092 new_mae=23.85078091653131
current=19.672382877828092 new_mae=40.26954422094378
current=19.672382877828092 new_mae=27.041573760520595
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.672382877828092 new_mae=20.45225376963474
current=19.672382877828092 new_mae=35.62447193646938
current=19.672382877828092 new_mae=29.300463561947026
current=19.672382877828092 new_mae=28.207825705939086
current=19.672382877828092 new_mae=29.79050998441217
current=19.672382877828092 new_mae=19.763652503957754
current=19.672382877828092 new_mae=39.18226201232247
current=19.672382877828092 new_mae=31.834305826018557
current=19.672382877828092 new_mae=21.212598819914103
current=19.672382877828092 new_mae=19.92743886853892
current=19.672382877828092 new_mae=21.575997603966307
current=19.672382877828092 new_mae=39.85577195987065
current=19.672382877828092 new_mae=20.759334060567895
current=19.672382877828092 new_mae=31.069720212057465
current=19.672382877828092 new_mae=23.420934152493622
current=19.672382877828092 new_mae=42.60524192854609
current=19.672382877828092 new_mae=23.28919222115713
current=19.672382877828092 new_mae=21.89073124049132
current=19.672382877828092 new_mae=28.622535940530913
current=19.672382877828092 new_mae=21.92535899901982
current=19.672382877828092 new_mae=20.381840291050057
current=19.672382877828092 new_mae=22.771143037544274
current=19.672382877828092 new_mae=19.928063436790232
current=19.672382877828092 new_mae=27.283224311485803
current=19.672382877828092 new_mae=20.48411932255653
current=19.672382877828092 new_mae=20.235849936603685
current=19.672382877828092 new_mae=19.694703347085827
current=19.672382877828092 new_mae=31.287043371420765
current=19.672382877828092 new_mae=19.843115621929794
current=19.672382877828092 new_mae=24.169970740879705
current=19.672382877828092 new_mae=27.730487211186556
current=19.672382877828092 new_mae=20.02871250410717
current=19.672382877828092 new_mae=33.64080180703261
current=19.672382877828092 new_mae=36.030727316882846
current=19.672382877828092 new_mae=28.04162430608404
current=19.672382877828092 new_mae=24.106133209576956
current=19.672382877828092 new_mae=19.734120421026248
current=19.672382877828092 new_mae=23.891256902097677
current=19.672382877828092 new_mae=20.7535809419377
current=19.672382877828092 new_mae=31.241444694139457
current=19.672382877828092 new_mae=21.592950646466715
current=19.672382877828092 new_mae=30.94957328289044
current=19.672382877828092 new_mae=32.973700143874815
current=19.672382877828092 new_mae=30.424135282925114
current=19.672382877828092 new_mae=22.88615316265994
current=19.672382877828092 new_mae=22.794472575842995
current=19.672382877828092 new_mae=26.433597624003653
current=19.672382877828092 new_mae=24.56490672100044
current=19.672382877828092 new_mae=25.625216251144252
current=19.672382877828092 new_mae=20.88146017847415
current=19.672382877828092 new_mae=23.793654414066637
current=19.672382877828092 new_mae=35.36958426348755
current=19.672382877828092 new_mae=37.98411317392771
current=19.672382877828092 new_mae=21.9850500833055
current=19.672382877828092 new_mae=34.31452240928036
current=19.672382877828092 new_mae=21.135493516207735
current=19.672382877828092 new_mae=20.647488255600315
current=19.672382877828092 new_mae=41.882709308376775
current=19.672382877828092 new_mae=19.810281912500717
current=19.672382877828092 new_mae=26.864606610587614
current=19.672382877828092 new_mae=25.61988351536894
current=19.672382877828092 new_mae=28.10956141650592
current=19.672382877828092 new_mae=21.91393152926667
current=19.672382877828092 new_mae=29.50916311762445
current=19.672382877828092 new_mae=25.525699883390466
current=19.672382877828092 new_mae=26.473234225170245
current=19.672382877828092 new_mae=20.954644122794118
current=19.672382877828092 new_mae=21.49215636112405
current=19.672382877828092 new_mae=29.13152903392943
current=19.672382877828092 new_mae=34.29871284505193
current=19.672382877828092 new_mae=24.847817821311303
current=19.672382877828092 new_mae=21.646785424268725
current=19.672382877828092 new_mae=23.35200727596389
current=19.672382877828092 new_mae=19.854313025407933
current=19.672382877828092 new_mae=19.804395538001717
current=19.672382877828092 new_mae=30.78853360973006
current=19.672382877828092 new_mae=24.8293486010342
current=19.672382877828092 new_mae=24.40430561180798
current=19.672382877828092 new_mae=22.85205994193689
current=19.672382877828092 new_mae=20.953206386722538
current=19.672382877828092 new_mae=25.711915912275757
current=19.672382877828092 new_mae=19.84908070519921
current=19.672382877828092 new_mae=24.671492867070892
current=19.672382877828092 new_mae=22.810674943183162
current=19.672382877828092 new_mae=39.401693928601986
current=19.672382877828092 new_mae=36.49667867461743
current=19.672382877828092 new_mae=22.358196086459277
current=19.672382877828092 new_mae=27.960184783213332
current=19.672382877828092 new_mae=25.178444291694117
current=19.672382877828092 new_mae=19.73850995285227
current=19.672382877828092 new_mae=20.875441248910857
current=19.672382877828092 new_mae=34.88705292037691
current=19.672382877828092 new_mae=25.667874943773416
current=19.672382877828092 new_mae=23.749591034599952
current=19.672382877828092 new_mae=31.41619788157344
current=19.672382877828092 new_mae=25.858722415907373
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.055232764716561356
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>model is some function that usually takes parameters and predicts data.</p>
<p>parameters are free to vary, structure of the model is set in stone</p>
<p>we can evaluate model predictions via a loss function, and smaller loss is better.</p>
<p>We find parameters that minimize the loss function.  this amounts to “fitting” the model.</p>
<p>this is done via some kind of optimization algorithm.</p>
<div class="section" id="gradient-descent">
<h3>Gradient descent<a class="headerlink" href="#gradient-descent" title="Permalink to this headline">¶</a></h3>
<p>Start with some parameter values.  Figure out which direction of change in parameter values reduces the loss.  Change parameter values in that direction.  Repeat until some criterion is reached.</p>
<p><span class="math notranslate nohighlight">\(L(a,b) = \frac{1}{n} \sum_{i=0}^n (\hat y_i - y_i)^2\)</span></p>
<p><span class="math notranslate nohighlight">\(L(a,b) = \frac{1}{n} \sum_{i=0}^n (a x_i + b - y_i)^2\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{\partial L(a,b)}{\partial a} = \frac{1}{n} \sum_{i=0}^n 2 (a x_i + b - y_i) x_i\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{\partial L(a,b)}{\partial b} = \frac{1}{n} \sum_{i=0}^n 2 (a x_i + b - y_i)\)</span></p>
</div>
</div>
<div class="section" id="writing-our-own-model-class">
<h2>Writing our own model class<a class="headerlink" href="#writing-our-own-model-class" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-kinds-of-operations-should-a-model-support">
<h3>What kinds of operations should a model support?<a class="headerlink" href="#what-kinds-of-operations-should-a-model-support" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>predict data, usually given some input</p></li>
<li><p>evaluate the quality of its predictions given some ground truth observations</p></li>
<li><p>fit its parameters to observed data</p></li>
<li><p>for <em>inferential statistics</em>: compare its fitted parameters to null values, provide confidence intervals on parameters, etc.</p></li>
</ul>
</div>
<div class="section" id="baby-steps">
<h3>Baby steps<a class="headerlink" href="#baby-steps" title="Permalink to this headline">¶</a></h3>
<p><strong>for linear regression</strong></p>
<div class="section" id="predict">
<h4>predict<a class="headerlink" href="#predict" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code>x a 1d numpy array of length <code class="docutils literal notranslate"><span class="pre">n</span></code>, and returns a 1d array of <code class="docutils literal notranslate"><span class="pre">n</span></code> predicted y values, given <code class="docutils literal notranslate"><span class="pre">slope=0.5</span></code>, and <code class="docutils literal notranslate"><span class="pre">intercept=50</span></code></p>
</div>
<div class="section" id="evaluate">
<h4>evaluate<a class="headerlink" href="#evaluate" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> (both arrays of length <code class="docutils literal notranslate"><span class="pre">n</span></code>) and returns the mean squared error of the prediction.</p>
</div>
<div class="section" id="fit">
<h4>fit<a class="headerlink" href="#fit" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> and finds some good values of slope and intercept by minimizing the mean squared error loss function, somehow.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./live"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ed Vul<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>