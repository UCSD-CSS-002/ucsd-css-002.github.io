
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lecture 5: Modeling Data &#8212; UCSD CSS 2</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">UCSD CSS 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome to CSS 2
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Course (CSS 2 Spring 2022)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../course/syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/expectations.html">
   Expectations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/datahub.html">
   Datahub assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/debugging.html">
   Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/resources.html">
   Extracurricular Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/final.html">
   Final Project
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_2.html">
   Lecture 2 (3/30/22)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/live/css2-lecture-5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/UCSD-CSS-002/ucsd-css-002.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/UCSD-CSS-002/ucsd-css-002.github.io/issues/new?title=Issue%20on%20page%20%2Flive/css2-lecture-5.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/UCSD-CSS-002/ucsd-css-002.github.io/master?urlpath=tree/live/css2-lecture-5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#this-week">
   This week:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#things-we-do-with-data">
   Things we do with data.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-model">
   What is a model?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-parts">
   Model parts.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-structures-and-parameters">
   Model structures and parameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loss-functions">
   Loss functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-for-regression">
     Loss for Regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sum-squared-error">
       Sum squared error
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-for-classification">
     Loss for Classification
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimization-algorithm">
   Optimization algorithm
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grid-search">
     Grid search
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-search">
     Random search
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gradient-descent">
     Gradient descent
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-our-own-model-class">
   Writing our own model class
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-kinds-of-operations-should-a-model-support">
     What kinds of operations should a model support?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#baby-steps">
     Baby steps
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#predict">
       predict
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#evaluate">
       evaluate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fit">
       fit
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="lecture-5-modeling-data">
<h1>Lecture 5: Modeling Data<a class="headerlink" href="#lecture-5-modeling-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="this-week">
<h2>This week:<a class="headerlink" href="#this-week" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>no problem set, one integrated lab, due at the usual problem set time (monday)</p></li>
<li><p>covering mostly conceptual material, which will serve as the basis of understanding the stuff we do later.</p></li>
</ul>
</div>
<div class="section" id="things-we-do-with-data">
<h2>Things we do with data.<a class="headerlink" href="#things-we-do-with-data" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>describe, summarize, visualize</p></li>
<li><p>infer latent structure, rules, properties, parameters</p></li>
<li><p>generalize to predict, interpolate, extrapolate</p></li>
</ol>
<p>Classical statistics is mostly about #2.  Machine learning is mostly about #3.  Computational Social Science uses tools and models from both.</p>
<p>Both of these rely on fitting models to the data, but the design of the models, and model evaluation differ.</p>
</div>
<div class="section" id="what-is-a-model">
<h2>What is a model?<a class="headerlink" href="#what-is-a-model" title="Permalink to this headline">¶</a></h2>
<p>A model <em>assumes</em> some <strong>structure</strong> of the data, and has some <strong>parameters</strong> that are <em>fit</em> to the data.  The end result is an object that may be used in various ways for data summarization, inference, and prediction.</p>
<p><strong>Examples</strong>: Linear regression, logistic regression, decision tree, neural networks of various architectures, support vector machine, etc.</p>
<p>The structural assumptions constrain what kind of relationships can be captured by the model, but are also necessary to generalize beyond the data.</p>
<p><strong>Even when we simply describe or summarize data, we implicitly have a model in mind.</strong></p>
<p>I have the following data describing the flips of a coin <em><strong>how should I summarize them?</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;H&#39;, &#39;H&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;H&#39;, &#39;H&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># probability of heads </span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="c1"># if we think the coin might be bent.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3076923076923077
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># coin generated by a process that may be </span>
<span class="c1"># likely to repeat previous outcome</span>

<span class="n">transitions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">prev</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">prev</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">prev</span> <span class="o">==</span> <span class="n">outcome</span><span class="p">:</span>
            <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;different&#39;</span><span class="p">)</span>
    <span class="n">prev</span> <span class="o">=</span> <span class="n">outcome</span>

<span class="nb">print</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;same&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_same</span> <span class="o">=</span> <span class="n">transitions</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;same&#39;</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_same</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.75
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># spin a spinner.  if spinner lands in red then we stop flipping coin.</span>
<span class="c1"># if spinner lands on green, then we flip one more time.</span>
<span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="model-parts">
<h2>Model parts.<a class="headerlink" href="#model-parts" title="Permalink to this headline">¶</a></h2>
<p><strong>Structure:</strong> These are the core assumptions of the model.  Whatever you do in the fitting process, these are not going to change, they are set in stone.</p>
<p>e.g., in linear regression:  <span class="math notranslate nohighlight">\(\hat y = a x + b\)</span></p>
<p>e.g., not <span class="math notranslate nohighlight">\(\hat y = a x^2 + b\)</span></p>
<p><strong>Parameters:</strong> These are the moving parts of the model that are fit to the data.</p>
<p>e.g., in linear regression: <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span></p>
<p><strong>Loss / objective / goodness of fit function:</strong> This is a function that can consider the model and its parameters, and the observed data, and returns a number indicating how well/badly the model fits.  How do I decide whether one value of the parameters is better or worse than another?</p>
<p>e.g., in linear regression: this could be mean squared error, or the likelihood under a normal probability distribution, or the posterior probability of a particular set of parameters, or the mean absolute error, or the quantile error, or… etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7fd746866490&gt;
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_12_1.png" src="../_images/css2-lecture-5_12_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.02697526, 0.45366629])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.68798218, -0.02100174, -0.87252014, -0.00180271,  0.24681623,
       -0.06405732, -0.03073462, -0.17946438, -0.58288585, -0.80596713])
</pre></div>
</div>
</div>
</div>
<p><strong>Optimization algorithm:</strong> how do I find the <em>best fitting</em> (loss minimizing, objective maximizing, goodness of fit maximizing) values of the parameters?</p>
<p>e.g., in linear regression, there are various linear algebra tricks available to do so robustly (out of scope here).</p>
</div>
<div class="section" id="model-structures-and-parameters">
<h2>Model structures and parameters<a class="headerlink" href="#model-structures-and-parameters" title="Permalink to this headline">¶</a></h2>
<p>There are <em>many</em>.  We will spend the bulk of class talking about the varieties of model structures that are out there, what they assume, and what they are good at.</p>
</div>
<div class="section" id="loss-functions">
<h2>Loss functions<a class="headerlink" href="#loss-functions" title="Permalink to this headline">¶</a></h2>
<p>There are relatively few, for common problem types.  We will learn the basics of these because they are essential to understanding what models are doing.</p>
<div class="section" id="loss-for-regression">
<h3>Loss for Regression<a class="headerlink" href="#loss-for-regression" title="Permalink to this headline">¶</a></h3>
<p>Regression: predict some number from other data.</p>
<p>Let’s say we want to predict weight.  How do we evaluate how well we have done this?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># our loss function is a single number that </span>
<span class="c1"># tells us how bad our predictions are.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Errors</strong></p>
<ol class="simple">
<li><p>Ratio error.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">weight</span><span class="o">/</span><span class="n">predicted_weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.        , -0.03077166,  0.        ,  0.87546874,  0.01550419])
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Linear error</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_weight</span> <span class="o">-</span> <span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([   0,    5,    0, -140,   -2])
</pre></div>
</div>
</div>
</div>
<p><strong>Summarizing errors</strong></p>
<p>Mean of the squared errors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors</span> <span class="o">=</span> <span class="n">predicted_weight</span> <span class="o">-</span> <span class="n">weight</span>
<span class="n">errors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([   0,    5,    0, -140,   -2])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># squared errors</span>
<span class="n">errors</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([    0,    25,     0, 19600,     4])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">errors</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="section" id="sum-squared-error">
<h4>Sum squared error<a class="headerlink" href="#sum-squared-error" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>

<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">175</span><span class="p">])</span>

<span class="c1"># they increase with number of data points.  </span>
<span class="c1"># because we sum all data point errors squared.</span>
<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19654
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>

<span class="c1"># sum of squared errors dominated by large errors.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19600
</pre></div>
</div>
</div>
</div>
<p><strong>Mean squared errors</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3920.0
</pre></div>
</div>
</div>
</div>
<p>Aside: standard error of the mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([180, 160, 175, 240, 130])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>177.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.099689437998485
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">177</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="mi">177</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[145, 209]
</pre></div>
</div>
</div>
</div>
<p>Simple model:</p>
<p><span class="math notranslate nohighlight">\(\hat y = m\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter / prediction</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># error</span>
<span class="nb">print</span><span class="p">(</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span>
<span class="c1"># squared error</span>
<span class="nb">print</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># sum of squared error</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># mean of squared error</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  3. -17.  -2.  63. -47.]
[   9.  289.    4. 3969. 2209.]
6480.0
1296.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
<span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1296.0
</pre></div>
</div>
</div>
</div>
<p><strong>Loss function:</strong> is some function of the prediction, and the actual data, that returns one number, which is bigger when our predictions are worse.</p>
<p><strong>Mean squared error</strong></p>
<p><strong>Mean absolute error</strong></p>
<p><strong>not exactly right proportion</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3920.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mae</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mae</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>28.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_error</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">280</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mean_error</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">not_exactly_right_proportion</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">not_exactly_right_proportion</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="loss-for-classification">
<h3>Loss for Classification<a class="headerlink" href="#loss-for-classification" title="Permalink to this headline">¶</a></h3>
<p>Classification: predict a label, (in contrast to a number)</p>
<p>Let’s say we want to predict sex (male/female).  How do we evaluate how well we have done this?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># binary predictions loss functions:</span>

<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>

<span class="n">predicted_y</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inaccuracy</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>

<span class="n">predicted_y</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Developing new loss functions is where a lot of the action is for state of the art machine learning, because this is where we specify what it means for a machine to achieve certain intelligent goals.  This is particularly important for RL, and other domains where we don’t actually know what we mean by “intelligent behavior”.</p>
</div>
</div>
<div class="section" id="optimization-algorithm">
<h2>Optimization algorithm<a class="headerlink" href="#optimization-algorithm" title="Permalink to this headline">¶</a></h2>
<p>There are many. Very active area of research, we will generally not cover them in great detail.  Let’s cover some basics though.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># goal: predict weight from height</span>

<span class="c1"># model is: predicted_y = slope * x + intercept</span>

<span class="c1"># parameters are: slope, intercept</span>

<span class="c1"># loss function:  mean absolute error</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">hw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;height-weight.csv&#39;</span><span class="p">)</span>

<span class="n">hw</span> <span class="o">=</span> <span class="n">hw</span><span class="p">[</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">36</span><span class="p">]</span>

<span class="n">hw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>67.75</td>
      <td>154.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>72.25</td>
      <td>173.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>66.25</td>
      <td>154.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>72.25</td>
      <td>184.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>71.25</td>
      <td>184.25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>247</th>
      <td>67.00</td>
      <td>134.25</td>
    </tr>
    <tr>
      <th>248</th>
      <td>69.75</td>
      <td>201.00</td>
    </tr>
    <tr>
      <th>249</th>
      <td>66.00</td>
      <td>186.75</td>
    </tr>
    <tr>
      <th>250</th>
      <td>70.50</td>
      <td>190.75</td>
    </tr>
    <tr>
      <th>251</th>
      <td>70.00</td>
      <td>207.50</td>
    </tr>
  </tbody>
</table>
<p>251 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fd747503130&gt;]
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_62_1.png" src="../_images/css2-lecture-5_62_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mae</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20.21573705179283
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">5.75</span><span class="p">,</span> <span class="o">-</span><span class="mi">227</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;m-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;y-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fd7475dd520&gt;]
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_65_1.png" src="../_images/css2-lecture-5_65_1.png" />
</div>
</div>
<div class="section" id="grid-search">
<h3>Grid search<a class="headerlink" href="#grid-search" title="Permalink to this headline">¶</a></h3>
<p>Consider a bunch of possible parameter settings.  Evaluate loss for each.  Pick the best one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">current_lowest</span> <span class="o">=</span> <span class="mi">1000000000</span>

<span class="n">best_slope</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">best_intercept</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">slope</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">intercept</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
        <span class="n">current_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> 
                                  <span class="n">intercept</span><span class="p">,</span> 
                                  <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> 
                          <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">current_mae</span> <span class="o">&lt;</span> <span class="n">current_lowest</span><span class="p">:</span>
            <span class="n">current_lowest</span> <span class="o">=</span> <span class="n">current_mae</span>
            <span class="n">best_slope</span> <span class="o">=</span> <span class="n">slope</span>
            <span class="n">best_intercept</span> <span class="o">=</span> <span class="n">intercept</span>
        <span class="c1">#print(f&#39;{slope=}, {intercept=}, {current_mae=}&#39;)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">current_lowest</span><span class="p">,</span> <span class="n">best_slope</span><span class="p">,</span> <span class="n">best_intercept</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18.837854642037907 5.757575757575758 -227.2727272727273
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.        , 0.05050505, 0.1010101 , 0.15151515, 0.2020202 ,
       0.25252525, 0.3030303 , 0.35353535, 0.4040404 , 0.45454545,
       0.50505051, 0.55555556, 0.60606061, 0.65656566, 0.70707071,
       0.75757576, 0.80808081, 0.85858586, 0.90909091, 0.95959596,
       1.01010101, 1.06060606, 1.11111111, 1.16161616, 1.21212121,
       1.26262626, 1.31313131, 1.36363636, 1.41414141, 1.46464646,
       1.51515152, 1.56565657, 1.61616162, 1.66666667, 1.71717172,
       1.76767677, 1.81818182, 1.86868687, 1.91919192, 1.96969697,
       2.02020202, 2.07070707, 2.12121212, 2.17171717, 2.22222222,
       2.27272727, 2.32323232, 2.37373737, 2.42424242, 2.47474747,
       2.52525253, 2.57575758, 2.62626263, 2.67676768, 2.72727273,
       2.77777778, 2.82828283, 2.87878788, 2.92929293, 2.97979798,
       3.03030303, 3.08080808, 3.13131313, 3.18181818, 3.23232323,
       3.28282828, 3.33333333, 3.38383838, 3.43434343, 3.48484848,
       3.53535354, 3.58585859, 3.63636364, 3.68686869, 3.73737374,
       3.78787879, 3.83838384, 3.88888889, 3.93939394, 3.98989899,
       4.04040404, 4.09090909, 4.14141414, 4.19191919, 4.24242424,
       4.29292929, 4.34343434, 4.39393939, 4.44444444, 4.49494949,
       4.54545455, 4.5959596 , 4.64646465, 4.6969697 , 4.74747475,
       4.7979798 , 4.84848485, 4.8989899 , 4.94949495, 5.        ])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="random-search">
<h3>Random search<a class="headerlink" href="#random-search" title="Permalink to this headline">¶</a></h3>
<p>Start with some parameter values.  Propose a local perturbation.  If it is better, adopt that one, and continue.  Until some criterion is reached.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">current</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>

<span class="n">attempts</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">attempts</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
    <span class="n">new_slope</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">new_intercept</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span>
    
    <span class="n">new_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">new_slope</span><span class="p">,</span> 
                          <span class="n">new_intercept</span><span class="p">,</span> 
                          <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> 
                  <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">current</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">new_mae</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">attempts</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">new_mae</span> <span class="o">&lt;</span> <span class="n">current</span><span class="p">:</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="n">new_slope</span>
        <span class="n">intercept</span> <span class="o">=</span> <span class="n">new_intercept</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">new_mae</span>
        <span class="n">attempts</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">slope</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">intercept</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">current</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=178.82051792828688 new_mae=214.4056834886765
current=178.82051792828688 new_mae=176.15355275175114
slope=0.10441665129251654 intercept=-4.674648616334212 current=176.15355275175114
current=176.15355275175114 new_mae=195.91006927348178
current=176.15355275175114 new_mae=180.7887419015238
current=176.15355275175114 new_mae=197.63441463877425
current=176.15355275175114 new_mae=172.2006528907656
slope=0.2763884817490526 intercept=-12.813218332627345 current=172.2006528907656
current=172.2006528907656 new_mae=165.44623910522978
slope=0.3122790174937937 intercept=-8.582295283438759 current=165.44623910522978
current=165.44623910522978 new_mae=176.3470344026115
current=165.44623910522978 new_mae=169.853871168945
current=165.44623910522978 new_mae=170.2343481495685
current=165.44623910522978 new_mae=190.1469872254896
current=165.44623910522978 new_mae=154.0700157204549
slope=0.4417529393773265 intercept=-6.309481354443218 current=154.0700157204549
current=154.0700157204549 new_mae=114.26820333343636
slope=0.8819458620979127 intercept=2.5420334223246943 current=114.26820333343636
current=114.26820333343636 new_mae=109.12083902689545
slope=0.8367671824381133 intercept=10.865944894746614 current=109.12083902689545
current=109.12083902689545 new_mae=141.7786833384512
current=109.12083902689545 new_mae=103.64095640217901
slope=0.777149858823113 intercept=20.537566671485052 current=103.64095640217901
current=103.64095640217901 new_mae=133.33482357936646
current=103.64095640217901 new_mae=115.41022018529404
current=103.64095640217901 new_mae=78.44256108889051
slope=1.211787925827339 intercept=15.176230484811137 current=78.44256108889051
current=78.44256108889051 new_mae=114.67306909884275
current=78.44256108889051 new_mae=77.10179561322992
slope=1.3418307439030237 intercept=7.373586982783829 current=77.10179561322992
current=77.10179561322992 new_mae=50.945117385380065
slope=1.6843838605089254 intercept=9.48913803629436 current=50.945117385380065
current=50.945117385380065 new_mae=49.78613356099251
slope=1.84006023707202 intercept=-0.29118231090093616 current=49.78613356099251
current=49.78613356099251 new_mae=46.447870495271545
slope=1.9400505484667647 intercept=-3.9363717589945826 current=46.447870495271545
current=46.447870495271545 new_mae=52.603724127996266
current=46.447870495271545 new_mae=19.983749511525346
slope=2.4234507792268167 intercept=4.562438497426399 current=19.983749511525346
current=19.983749511525346 new_mae=20.98223154198549
current=19.983749511525346 new_mae=22.46775646949896
current=19.983749511525346 new_mae=28.668568920719224
current=19.983749511525346 new_mae=29.5538940039627
current=19.983749511525346 new_mae=21.367708439760083
current=19.983749511525346 new_mae=30.435652318427447
current=19.983749511525346 new_mae=28.59398730357388
current=19.983749511525346 new_mae=23.392145417388594
current=19.983749511525346 new_mae=21.003297061533367
current=19.983749511525346 new_mae=21.783802962275043
current=19.983749511525346 new_mae=26.816940091574203
current=19.983749511525346 new_mae=26.493657046985728
current=19.983749511525346 new_mae=24.094188599278038
current=19.983749511525346 new_mae=33.11552760477791
current=19.983749511525346 new_mae=20.412478458917043
current=19.983749511525346 new_mae=25.354302772657675
current=19.983749511525346 new_mae=27.601303650627866
current=19.983749511525346 new_mae=27.530535191089964
current=19.983749511525346 new_mae=20.502271184117117
current=19.983749511525346 new_mae=21.803999833155004
current=19.983749511525346 new_mae=21.726430862900767
current=19.983749511525346 new_mae=20.44332587611953
current=19.983749511525346 new_mae=24.8085409916004
current=19.983749511525346 new_mae=20.537451035301746
current=19.983749511525346 new_mae=24.431558643843708
current=19.983749511525346 new_mae=26.33657037007262
current=19.983749511525346 new_mae=22.146118569563342
current=19.983749511525346 new_mae=31.57590223134796
current=19.983749511525346 new_mae=19.92819763544029
slope=2.5044508556148086 intercept=-1.537311994271385 current=19.92819763544029
current=19.92819763544029 new_mae=26.4814955429167
current=19.92819763544029 new_mae=31.88015206191262
current=19.92819763544029 new_mae=33.17800633055702
current=19.92819763544029 new_mae=31.254073797554717
current=19.92819763544029 new_mae=34.18246305170021
current=19.92819763544029 new_mae=41.759142027245495
current=19.92819763544029 new_mae=29.120921474183998
current=19.92819763544029 new_mae=26.904751429928446
current=19.92819763544029 new_mae=21.236446550447372
current=19.92819763544029 new_mae=31.4246936151169
current=19.92819763544029 new_mae=40.71898464584138
current=19.92819763544029 new_mae=20.07184165925861
current=19.92819763544029 new_mae=35.60676615668858
current=19.92819763544029 new_mae=27.894663957862914
current=19.92819763544029 new_mae=26.68276059654528
current=19.92819763544029 new_mae=23.996824990363095
current=19.92819763544029 new_mae=21.47667388031475
current=19.92819763544029 new_mae=21.04793717060096
current=19.92819763544029 new_mae=20.061255043564557
current=19.92819763544029 new_mae=19.98341238283969
current=19.92819763544029 new_mae=21.2308153460136
current=19.92819763544029 new_mae=20.176374569974424
current=19.92819763544029 new_mae=41.40358945152716
current=19.92819763544029 new_mae=22.9027045626449
current=19.92819763544029 new_mae=21.648709311311805
current=19.92819763544029 new_mae=22.251906798057142
current=19.92819763544029 new_mae=23.301328833702737
current=19.92819763544029 new_mae=30.310616843011154
current=19.92819763544029 new_mae=20.183595646270398
current=19.92819763544029 new_mae=22.220593026556074
current=19.92819763544029 new_mae=20.16424656050239
current=19.92819763544029 new_mae=20.023682090968325
current=19.92819763544029 new_mae=19.952921103438094
current=19.92819763544029 new_mae=29.621958282798936
current=19.92819763544029 new_mae=20.80858582887305
current=19.92819763544029 new_mae=34.339087020885174
current=19.92819763544029 new_mae=32.495134321714374
current=19.92819763544029 new_mae=20.00718492040948
current=19.92819763544029 new_mae=41.08242814927224
current=19.92819763544029 new_mae=23.777682302181407
current=19.92819763544029 new_mae=21.378438131010274
current=19.92819763544029 new_mae=30.971600801133548
current=19.92819763544029 new_mae=24.100789150537345
current=19.92819763544029 new_mae=23.297837910551852
current=19.92819763544029 new_mae=32.242131258567355
current=19.92819763544029 new_mae=20.36022594062743
current=19.92819763544029 new_mae=29.80024032685844
current=19.92819763544029 new_mae=22.82722770656809
current=19.92819763544029 new_mae=22.60509565700894
current=19.92819763544029 new_mae=20.028631682474433
current=19.92819763544029 new_mae=20.633558688302767
current=19.92819763544029 new_mae=34.42116832736613
current=19.92819763544029 new_mae=20.090431592272076
current=19.92819763544029 new_mae=30.80929347404195
current=19.92819763544029 new_mae=25.60926226852542
current=19.92819763544029 new_mae=26.53756026984093
current=19.92819763544029 new_mae=20.139654209226507
current=19.92819763544029 new_mae=24.256933448292475
current=19.92819763544029 new_mae=21.037962527532738
current=19.92819763544029 new_mae=28.22031251774641
current=19.92819763544029 new_mae=26.952324438624515
current=19.92819763544029 new_mae=24.356515309194357
current=19.92819763544029 new_mae=28.184769104223125
current=19.92819763544029 new_mae=23.249415762146967
current=19.92819763544029 new_mae=35.65987640160819
current=19.92819763544029 new_mae=21.191523065675156
current=19.92819763544029 new_mae=28.1802052692887
current=19.92819763544029 new_mae=22.32614655286358
current=19.92819763544029 new_mae=34.11971266659493
current=19.92819763544029 new_mae=26.3248022930382
current=19.92819763544029 new_mae=19.96176923233864
current=19.92819763544029 new_mae=20.975773968410472
current=19.92819763544029 new_mae=19.902194451267725
slope=2.599792805163268 intercept=-6.821117178537338 current=19.902194451267725
current=19.902194451267725 new_mae=25.98538712138935
current=19.902194451267725 new_mae=21.934304726586035
current=19.902194451267725 new_mae=22.12522382636385
current=19.902194451267725 new_mae=28.97599010110361
current=19.902194451267725 new_mae=42.01038327324129
current=19.902194451267725 new_mae=28.78886025621876
current=19.902194451267725 new_mae=20.881155190273628
current=19.902194451267725 new_mae=19.995189306247244
current=19.902194451267725 new_mae=32.64824129097208
current=19.902194451267725 new_mae=25.35288185922628
current=19.902194451267725 new_mae=24.811795082067984
current=19.902194451267725 new_mae=27.63020630927476
current=19.902194451267725 new_mae=20.282027400489955
current=19.902194451267725 new_mae=23.13987068244568
current=19.902194451267725 new_mae=28.54895302087056
current=19.902194451267725 new_mae=39.876448680066
current=19.902194451267725 new_mae=25.518372854906747
current=19.902194451267725 new_mae=31.965335232100777
current=19.902194451267725 new_mae=32.75619213534926
current=19.902194451267725 new_mae=34.88141678815206
current=19.902194451267725 new_mae=28.08733306474733
current=19.902194451267725 new_mae=21.229527906693054
current=19.902194451267725 new_mae=43.293995382684834
current=19.902194451267725 new_mae=21.065634410775008
current=19.902194451267725 new_mae=36.527375866583995
current=19.902194451267725 new_mae=27.01505655900193
current=19.902194451267725 new_mae=21.07783432879576
current=19.902194451267725 new_mae=33.72044763568142
current=19.902194451267725 new_mae=23.20012305688432
current=19.902194451267725 new_mae=25.872550666440606
current=19.902194451267725 new_mae=30.624645775944362
current=19.902194451267725 new_mae=23.147960116789708
current=19.902194451267725 new_mae=24.565582928401238
current=19.902194451267725 new_mae=24.906873012545695
current=19.902194451267725 new_mae=28.5213092279782
current=19.902194451267725 new_mae=23.803819552943846
current=19.902194451267725 new_mae=20.455487586461317
current=19.902194451267725 new_mae=20.032929428949142
current=19.902194451267725 new_mae=34.77244811882688
current=19.902194451267725 new_mae=40.449433721944416
current=19.902194451267725 new_mae=20.96717450530877
current=19.902194451267725 new_mae=19.84330108670081
slope=2.6856763629344274 intercept=-15.261978490953354 current=19.84330108670081
current=19.84330108670081 new_mae=22.588194921040174
current=19.84330108670081 new_mae=26.413108101217702
current=19.84330108670081 new_mae=20.120218489770753
current=19.84330108670081 new_mae=23.833709161877053
current=19.84330108670081 new_mae=20.768999033418787
current=19.84330108670081 new_mae=37.69559310488332
current=19.84330108670081 new_mae=31.418580894120797
current=19.84330108670081 new_mae=27.342674444145352
current=19.84330108670081 new_mae=19.935825544655554
current=19.84330108670081 new_mae=21.377983813704837
current=19.84330108670081 new_mae=22.09422803874892
current=19.84330108670081 new_mae=26.353081425707323
current=19.84330108670081 new_mae=21.162331310799015
current=19.84330108670081 new_mae=48.332831323426866
current=19.84330108670081 new_mae=40.71859824067649
current=19.84330108670081 new_mae=21.78961867890681
current=19.84330108670081 new_mae=41.26859400407123
current=19.84330108670081 new_mae=23.190975511796623
current=19.84330108670081 new_mae=38.79878143305445
current=19.84330108670081 new_mae=24.13194195464363
current=19.84330108670081 new_mae=24.14098008095837
current=19.84330108670081 new_mae=25.89325108684092
current=19.84330108670081 new_mae=26.87438835631064
current=19.84330108670081 new_mae=25.44427532979363
current=19.84330108670081 new_mae=20.270563930387752
current=19.84330108670081 new_mae=35.47543065699962
current=19.84330108670081 new_mae=30.905178844514374
current=19.84330108670081 new_mae=21.087817421919006
current=19.84330108670081 new_mae=34.11202969424549
current=19.84330108670081 new_mae=20.707403063060454
current=19.84330108670081 new_mae=22.158122301635334
current=19.84330108670081 new_mae=29.45997172322386
current=19.84330108670081 new_mae=21.61725566114579
current=19.84330108670081 new_mae=47.603906907275295
current=19.84330108670081 new_mae=20.154218266163547
current=19.84330108670081 new_mae=21.799383877447628
current=19.84330108670081 new_mae=21.576441754589677
current=19.84330108670081 new_mae=19.896561271702385
current=19.84330108670081 new_mae=21.408540086254856
current=19.84330108670081 new_mae=24.02962628928137
current=19.84330108670081 new_mae=29.900222081644404
current=19.84330108670081 new_mae=19.874853053005474
current=19.84330108670081 new_mae=22.677855075518313
current=19.84330108670081 new_mae=19.866151181152862
current=19.84330108670081 new_mae=22.007482909925933
current=19.84330108670081 new_mae=22.121719151481198
current=19.84330108670081 new_mae=19.74284372291763
slope=2.7944762890764334 intercept=-22.27265023333473 current=19.74284372291763
current=19.74284372291763 new_mae=19.951717161920396
current=19.74284372291763 new_mae=36.363478552648964
current=19.74284372291763 new_mae=24.51989158351307
current=19.74284372291763 new_mae=21.345461729915616
current=19.74284372291763 new_mae=27.030114006122936
current=19.74284372291763 new_mae=20.954467137530475
current=19.74284372291763 new_mae=27.63189686906542
current=19.74284372291763 new_mae=32.17959150382017
current=19.74284372291763 new_mae=24.4971015085324
current=19.74284372291763 new_mae=23.951859264561264
current=19.74284372291763 new_mae=19.748439446903443
current=19.74284372291763 new_mae=38.01996668328651
current=19.74284372291763 new_mae=19.700879229979382
slope=2.860946419131524 intercept=-26.88099011109789 current=19.700879229979382
current=19.700879229979382 new_mae=21.665794909447385
current=19.700879229979382 new_mae=20.1741659262719
current=19.700879229979382 new_mae=27.156687428344817
current=19.700879229979382 new_mae=30.118918185492603
current=19.700879229979382 new_mae=29.38208487814871
current=19.700879229979382 new_mae=22.41524447893411
current=19.700879229979382 new_mae=19.84280068483607
current=19.700879229979382 new_mae=31.906600695828825
current=19.700879229979382 new_mae=22.293195357360286
current=19.700879229979382 new_mae=33.41156836234064
current=19.700879229979382 new_mae=26.38760163792697
current=19.700879229979382 new_mae=19.918444395746395
current=19.700879229979382 new_mae=23.078400862257155
current=19.700879229979382 new_mae=36.394006273993284
current=19.700879229979382 new_mae=20.914068961119522
current=19.700879229979382 new_mae=37.73326395887619
current=19.700879229979382 new_mae=30.37385414900567
current=19.700879229979382 new_mae=20.236199970895846
current=19.700879229979382 new_mae=37.49063644146806
current=19.700879229979382 new_mae=29.830392257437822
current=19.700879229979382 new_mae=20.254768512662018
current=19.700879229979382 new_mae=21.250513632517336
current=19.700879229979382 new_mae=22.565547633121657
current=19.700879229979382 new_mae=34.13636346052057
current=19.700879229979382 new_mae=27.162193745319886
current=19.700879229979382 new_mae=25.58983034653213
current=19.700879229979382 new_mae=20.56389047158192
current=19.700879229979382 new_mae=21.624340493205107
current=19.700879229979382 new_mae=20.104526775593367
current=19.700879229979382 new_mae=25.156573273711384
current=19.700879229979382 new_mae=26.937157313389203
current=19.700879229979382 new_mae=26.707921255976164
current=19.700879229979382 new_mae=19.694273897382608
slope=2.9140903175093547 intercept=-28.827359521361284 current=19.694273897382608
current=19.694273897382608 new_mae=20.196357384521978
current=19.694273897382608 new_mae=28.586235249388835
current=19.694273897382608 new_mae=25.02341935735327
current=19.694273897382608 new_mae=34.72692796583551
current=19.694273897382608 new_mae=20.876113648568012
current=19.694273897382608 new_mae=20.231609168506782
current=19.694273897382608 new_mae=20.267448550238743
current=19.694273897382608 new_mae=19.667543988327374
slope=2.9536857138032127 intercept=-31.624354681171546 current=19.667543988327374
current=19.667543988327374 new_mae=21.573260013582537
current=19.667543988327374 new_mae=26.450412528211228
current=19.667543988327374 new_mae=45.8408258226656
current=19.667543988327374 new_mae=27.73888678080884
current=19.667543988327374 new_mae=25.85046128940244
current=19.667543988327374 new_mae=20.712106543685373
current=19.667543988327374 new_mae=22.90651977614064
current=19.667543988327374 new_mae=19.713240262204547
current=19.667543988327374 new_mae=19.602521928821755
slope=3.08894547710235 intercept=-40.666549798533964 current=19.602521928821755
current=19.602521928821755 new_mae=35.038631938666875
current=19.602521928821755 new_mae=21.90930037459898
current=19.602521928821755 new_mae=25.150371367341865
current=19.602521928821755 new_mae=29.00322012913464
current=19.602521928821755 new_mae=26.99872654257833
current=19.602521928821755 new_mae=25.656508716933853
current=19.602521928821755 new_mae=26.408830102190034
current=19.602521928821755 new_mae=19.67498915402589
current=19.602521928821755 new_mae=21.721297806518134
current=19.602521928821755 new_mae=30.09535369297783
current=19.602521928821755 new_mae=33.398529317205536
current=19.602521928821755 new_mae=20.04467324899665
current=19.602521928821755 new_mae=34.90378363288842
current=19.602521928821755 new_mae=19.898307644654356
current=19.602521928821755 new_mae=28.231207859033223
current=19.602521928821755 new_mae=28.993181098749517
current=19.602521928821755 new_mae=34.19602551819563
current=19.602521928821755 new_mae=19.560560314235772
slope=3.10021359823478 intercept=-42.38789073618517 current=19.560560314235772
current=19.560560314235772 new_mae=19.814605148379986
current=19.560560314235772 new_mae=41.246756973418044
current=19.560560314235772 new_mae=39.33697521161452
current=19.560560314235772 new_mae=26.50827922789217
current=19.560560314235772 new_mae=20.474715379760088
current=19.560560314235772 new_mae=34.41088738988158
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.560560314235772 new_mae=19.866728128141407
current=19.560560314235772 new_mae=34.07364552049382
current=19.560560314235772 new_mae=26.327113457200706
current=19.560560314235772 new_mae=26.19883850281535
current=19.560560314235772 new_mae=19.53625767214504
slope=3.1930393096996483 intercept=-48.014584058486406 current=19.53625767214504
current=19.53625767214504 new_mae=31.670739540302215
current=19.53625767214504 new_mae=22.938563729480997
current=19.53625767214504 new_mae=44.99831574588303
current=19.53625767214504 new_mae=19.65245090751703
current=19.53625767214504 new_mae=35.58697180140399
current=19.53625767214504 new_mae=23.066815971175675
current=19.53625767214504 new_mae=34.05690409320539
current=19.53625767214504 new_mae=20.046125858779313
current=19.53625767214504 new_mae=27.08723086391553
current=19.53625767214504 new_mae=20.233446009588498
current=19.53625767214504 new_mae=19.533353902777133
slope=3.233792647245722 intercept=-50.54051358183782 current=19.533353902777133
current=19.533353902777133 new_mae=25.150718106586847
current=19.533353902777133 new_mae=20.548328366899376
current=19.533353902777133 new_mae=19.57119212645001
current=19.533353902777133 new_mae=41.002941750793134
current=19.533353902777133 new_mae=33.573152363554
current=19.533353902777133 new_mae=20.380029146010227
current=19.533353902777133 new_mae=22.769835667268158
current=19.533353902777133 new_mae=41.78837950213011
current=19.533353902777133 new_mae=22.51785480944823
current=19.533353902777133 new_mae=36.66125132618085
current=19.533353902777133 new_mae=29.60513752198592
current=19.533353902777133 new_mae=37.42188920654423
current=19.533353902777133 new_mae=19.58423957532565
current=19.533353902777133 new_mae=31.99638656547775
current=19.533353902777133 new_mae=19.722583546647463
current=19.533353902777133 new_mae=25.436938517323085
current=19.533353902777133 new_mae=21.76997312731248
current=19.533353902777133 new_mae=38.41441199087716
current=19.533353902777133 new_mae=19.770632488903324
current=19.533353902777133 new_mae=26.52505638524834
current=19.533353902777133 new_mae=25.860935175729924
current=19.533353902777133 new_mae=24.793153797222338
current=19.533353902777133 new_mae=35.85872324962468
current=19.533353902777133 new_mae=44.22107996008058
current=19.533353902777133 new_mae=24.699839473084403
current=19.533353902777133 new_mae=25.351683612564436
current=19.533353902777133 new_mae=23.47626540580054
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.533353902777133 new_mae=27.60330471066578
current=19.533353902777133 new_mae=24.29573621171813
current=19.533353902777133 new_mae=28.59393679352476
current=19.533353902777133 new_mae=22.632484987866224
current=19.533353902777133 new_mae=20.357371145811257
current=19.533353902777133 new_mae=26.698637117791375
current=19.533353902777133 new_mae=19.654127458274665
current=19.533353902777133 new_mae=27.88566337938051
current=19.533353902777133 new_mae=24.99363180452785
current=19.533353902777133 new_mae=24.34792535066804
current=19.533353902777133 new_mae=25.97045434483456
current=19.533353902777133 new_mae=27.94417723939199
current=19.533353902777133 new_mae=25.37112023524491
current=19.533353902777133 new_mae=22.501992721245287
current=19.533353902777133 new_mae=40.2743892020179
current=19.533353902777133 new_mae=19.470272921044298
slope=3.2628002940312104 intercept=-53.62271200691773 current=19.470272921044298
current=19.470272921044298 new_mae=31.531442526260236
current=19.470272921044298 new_mae=20.476726374943933
current=19.470272921044298 new_mae=30.785354538322412
current=19.470272921044298 new_mae=35.260605276557875
current=19.470272921044298 new_mae=22.631185951374036
current=19.470272921044298 new_mae=45.99638318171521
current=19.470272921044298 new_mae=36.666651549560584
current=19.470272921044298 new_mae=24.41445742426495
current=19.470272921044298 new_mae=42.00633136345396
current=19.470272921044298 new_mae=22.179322207377837
current=19.470272921044298 new_mae=24.384243182847747
current=19.470272921044298 new_mae=28.122465930114014
current=19.470272921044298 new_mae=22.542318382302387
current=19.470272921044298 new_mae=33.36647298523845
current=19.470272921044298 new_mae=21.694590713488843
current=19.470272921044298 new_mae=20.151776239695756
current=19.470272921044298 new_mae=20.782325915120463
current=19.470272921044298 new_mae=29.464582506261788
current=19.470272921044298 new_mae=31.5908084378306
current=19.470272921044298 new_mae=22.62885089863755
current=19.470272921044298 new_mae=22.117074247000453
current=19.470272921044298 new_mae=23.976708713012602
current=19.470272921044298 new_mae=19.998249402682077
current=19.470272921044298 new_mae=21.168262578232518
current=19.470272921044298 new_mae=25.79912067840777
current=19.470272921044298 new_mae=28.113705961583523
current=19.470272921044298 new_mae=27.041558383506192
current=19.470272921044298 new_mae=20.278027007281967
current=19.470272921044298 new_mae=19.689789866404436
current=19.470272921044298 new_mae=31.294226055825376
current=19.470272921044298 new_mae=26.68153387135436
current=19.470272921044298 new_mae=20.369344884317456
current=19.470272921044298 new_mae=22.38401044357578
current=19.470272921044298 new_mae=27.85108410867027
current=19.470272921044298 new_mae=29.834582614600937
current=19.470272921044298 new_mae=20.12561935574906
current=19.470272921044298 new_mae=25.82410954235689
current=19.470272921044298 new_mae=20.998176432185062
current=19.470272921044298 new_mae=19.557137495327662
current=19.470272921044298 new_mae=20.942680970339755
current=19.470272921044298 new_mae=32.65471240537877
current=19.470272921044298 new_mae=20.01422678215593
current=19.470272921044298 new_mae=20.07948580331039
current=19.470272921044298 new_mae=20.70630992565173
current=19.470272921044298 new_mae=24.333244721512404
current=19.470272921044298 new_mae=20.078786457784936
current=19.470272921044298 new_mae=23.111391361930036
current=19.470272921044298 new_mae=27.896926531408823
current=19.470272921044298 new_mae=26.737308657322004
current=19.470272921044298 new_mae=20.59960835609
current=19.470272921044298 new_mae=29.64295316227369
current=19.470272921044298 new_mae=20.38355608199334
current=19.470272921044298 new_mae=22.34516646763616
current=19.470272921044298 new_mae=30.40492356319027
current=19.470272921044298 new_mae=20.478446723160122
current=19.470272921044298 new_mae=27.909645591305384
current=19.470272921044298 new_mae=34.79041691416521
current=19.470272921044298 new_mae=25.58154668720569
current=19.470272921044298 new_mae=24.777243172210493
current=19.470272921044298 new_mae=20.98671022854393
current=19.470272921044298 new_mae=23.99831524245106
current=19.470272921044298 new_mae=23.967165671371184
current=19.470272921044298 new_mae=24.11320438821833
current=19.470272921044298 new_mae=23.004849999799
current=19.470272921044298 new_mae=21.1209813170121
current=19.470272921044298 new_mae=20.52866754005024
current=19.470272921044298 new_mae=25.5461058459004
current=19.470272921044298 new_mae=31.439955962409584
current=19.470272921044298 new_mae=25.67764978163929
current=19.470272921044298 new_mae=20.77551500754848
current=19.470272921044298 new_mae=32.51173815189138
current=19.470272921044298 new_mae=19.988268292305673
current=19.470272921044298 new_mae=20.73194723094143
current=19.470272921044298 new_mae=32.307767961733646
current=19.470272921044298 new_mae=32.23577460212239
current=19.470272921044298 new_mae=25.433141574125358
current=19.470272921044298 new_mae=43.57902553232166
current=19.470272921044298 new_mae=20.273011874509248
current=19.470272921044298 new_mae=19.73585813019262
current=19.470272921044298 new_mae=35.956003600923786
current=19.470272921044298 new_mae=25.939322165251326
current=19.470272921044298 new_mae=19.674155283269666
current=19.470272921044298 new_mae=27.26388622457679
current=19.470272921044298 new_mae=37.33623778492544
current=19.470272921044298 new_mae=26.145503157265686
current=19.470272921044298 new_mae=19.46252836389651
slope=3.286238242775216 intercept=-56.37098855848606 current=19.46252836389651
current=19.46252836389651 new_mae=23.6673280317871
current=19.46252836389651 new_mae=19.41420465877132
slope=3.4068539798797604 intercept=-65.1081099123468 current=19.41420465877132
current=19.41420465877132 new_mae=25.541336563120886
current=19.41420465877132 new_mae=19.997821521070716
current=19.41420465877132 new_mae=23.949334206306656
current=19.41420465877132 new_mae=19.93572780123033
current=19.41420465877132 new_mae=25.047782955121928
current=19.41420465877132 new_mae=19.785138238154648
current=19.41420465877132 new_mae=21.246763560031265
current=19.41420465877132 new_mae=21.011521905806106
current=19.41420465877132 new_mae=23.12789029666786
current=19.41420465877132 new_mae=19.52343446478771
current=19.41420465877132 new_mae=20.11471610357828
current=19.41420465877132 new_mae=21.393941209363945
current=19.41420465877132 new_mae=26.22153619023234
current=19.41420465877132 new_mae=30.04303358991315
current=19.41420465877132 new_mae=32.1123856857162
current=19.41420465877132 new_mae=19.958062671075965
current=19.41420465877132 new_mae=29.954348766623962
current=19.41420465877132 new_mae=19.6257315076251
current=19.41420465877132 new_mae=21.738660271309687
current=19.41420465877132 new_mae=28.59734011216555
current=19.41420465877132 new_mae=19.51226546197884
current=19.41420465877132 new_mae=19.71490652505601
current=19.41420465877132 new_mae=19.85434685806072
current=19.41420465877132 new_mae=19.804168233080244
current=19.41420465877132 new_mae=29.023122534022015
current=19.41420465877132 new_mae=22.6158424137885
current=19.41420465877132 new_mae=21.821574904890138
current=19.41420465877132 new_mae=28.302059573718687
current=19.41420465877132 new_mae=19.907836372217997
current=19.41420465877132 new_mae=27.312837247835514
current=19.41420465877132 new_mae=32.271259698278776
current=19.41420465877132 new_mae=37.21488446240122
current=19.41420465877132 new_mae=20.559633157484924
current=19.41420465877132 new_mae=19.507759856156657
current=19.41420465877132 new_mae=19.65242245713574
current=19.41420465877132 new_mae=41.19710168928652
current=19.41420465877132 new_mae=25.471333412972808
current=19.41420465877132 new_mae=27.527278200238293
current=19.41420465877132 new_mae=37.963712825110555
current=19.41420465877132 new_mae=22.544533977157013
current=19.41420465877132 new_mae=19.68972136397646
current=19.41420465877132 new_mae=26.936643633775162
current=19.41420465877132 new_mae=27.516061745167647
current=19.41420465877132 new_mae=22.883410941561774
current=19.41420465877132 new_mae=35.99425554373156
current=19.41420465877132 new_mae=28.524127221911247
current=19.41420465877132 new_mae=28.022622354794432
current=19.41420465877132 new_mae=27.99202696160287
current=19.41420465877132 new_mae=31.134396053403627
current=19.41420465877132 new_mae=22.841145775854155
current=19.41420465877132 new_mae=21.515359773168296
current=19.41420465877132 new_mae=30.76872316576031
current=19.41420465877132 new_mae=37.91340853583073
current=19.41420465877132 new_mae=33.569216134116274
current=19.41420465877132 new_mae=26.603705555433738
current=19.41420465877132 new_mae=20.7221387228397
current=19.41420465877132 new_mae=24.16704076560883
current=19.41420465877132 new_mae=21.396914983302075
current=19.41420465877132 new_mae=30.179033200981568
current=19.41420465877132 new_mae=19.566040758169102
current=19.41420465877132 new_mae=20.544596218294366
current=19.41420465877132 new_mae=26.682951365006367
current=19.41420465877132 new_mae=20.169720902979133
current=19.41420465877132 new_mae=31.98926073740552
current=19.41420465877132 new_mae=28.70569320239942
current=19.41420465877132 new_mae=20.521264986136337
current=19.41420465877132 new_mae=23.539135836465583
current=19.41420465877132 new_mae=19.571526338858416
current=19.41420465877132 new_mae=41.19147808503884
current=19.41420465877132 new_mae=19.840337246357443
current=19.41420465877132 new_mae=27.83368145036369
current=19.41420465877132 new_mae=21.04886868686585
current=19.41420465877132 new_mae=22.27446000073446
current=19.41420465877132 new_mae=40.11267129352949
current=19.41420465877132 new_mae=19.336934919999813
slope=3.5295189989401954 intercept=-72.99494019219216 current=19.336934919999813
current=19.336934919999813 new_mae=25.465634835867743
current=19.336934919999813 new_mae=25.07561078467527
current=19.336934919999813 new_mae=27.625730060310595
current=19.336934919999813 new_mae=33.373389311061366
current=19.336934919999813 new_mae=21.788994297002333
current=19.336934919999813 new_mae=22.279801062589538
current=19.336934919999813 new_mae=26.886835223184608
current=19.336934919999813 new_mae=33.149514017921376
current=19.336934919999813 new_mae=20.124152661176474
current=19.336934919999813 new_mae=22.391242435581677
current=19.336934919999813 new_mae=19.565473136286172
current=19.336934919999813 new_mae=29.88674084162376
current=19.336934919999813 new_mae=20.073420489049084
current=19.336934919999813 new_mae=34.21568527115259
current=19.336934919999813 new_mae=31.17146906378262
current=19.336934919999813 new_mae=31.36364927456098
current=19.336934919999813 new_mae=24.369401586776135
current=19.336934919999813 new_mae=19.28648161897097
slope=3.679887287056686 intercept=-82.15830314818334 current=19.28648161897097
current=19.28648161897097 new_mae=22.002340223520854
current=19.28648161897097 new_mae=21.283566657198342
current=19.28648161897097 new_mae=20.889952684392497
current=19.28648161897097 new_mae=23.85430780319729
current=19.28648161897097 new_mae=35.60485652461972
current=19.28648161897097 new_mae=23.165139867444044
current=19.28648161897097 new_mae=33.95229140732762
current=19.28648161897097 new_mae=35.83654945189535
current=19.28648161897097 new_mae=24.734111383876677
current=19.28648161897097 new_mae=22.455036554455067
current=19.28648161897097 new_mae=29.28400357013199
current=19.28648161897097 new_mae=22.35505714409777
current=19.28648161897097 new_mae=25.26556992632786
current=19.28648161897097 new_mae=21.531596166362974
current=19.28648161897097 new_mae=19.695164243114366
current=19.28648161897097 new_mae=20.673024235192695
current=19.28648161897097 new_mae=25.949624489686492
current=19.28648161897097 new_mae=32.817175999591896
current=19.28648161897097 new_mae=20.460922264339832
current=19.28648161897097 new_mae=32.128125184567445
current=19.28648161897097 new_mae=33.04666073674551
current=19.28648161897097 new_mae=34.92556159396182
current=19.28648161897097 new_mae=19.53357796086783
current=19.28648161897097 new_mae=20.443413472818847
current=19.28648161897097 new_mae=20.5536769079545
current=19.28648161897097 new_mae=19.425212269979507
current=19.28648161897097 new_mae=42.59635306057903
current=19.28648161897097 new_mae=20.131485628129944
current=19.28648161897097 new_mae=23.41988042150014
current=19.28648161897097 new_mae=26.444660142753527
current=19.28648161897097 new_mae=20.84854293968521
current=19.28648161897097 new_mae=19.47832870390467
current=19.28648161897097 new_mae=33.10756556408653
current=19.28648161897097 new_mae=20.68472071159071
current=19.28648161897097 new_mae=26.052432124316933
current=19.28648161897097 new_mae=21.655988587265963
current=19.28648161897097 new_mae=27.255675824814663
current=19.28648161897097 new_mae=35.99380564292291
current=19.28648161897097 new_mae=39.62183925249713
current=19.28648161897097 new_mae=20.728444425248448
current=19.28648161897097 new_mae=32.18348518088815
current=19.28648161897097 new_mae=30.73213324491489
current=19.28648161897097 new_mae=37.24886013028823
current=19.28648161897097 new_mae=19.286742298401446
current=19.28648161897097 new_mae=36.16183083379312
current=19.28648161897097 new_mae=33.41915669251228
current=19.28648161897097 new_mae=20.903348703898942
current=19.28648161897097 new_mae=20.01896521757478
current=19.28648161897097 new_mae=41.02672257937931
current=19.28648161897097 new_mae=21.745401473900664
current=19.28648161897097 new_mae=21.937293632244668
current=19.28648161897097 new_mae=40.81255215376146
current=19.28648161897097 new_mae=20.447115018704856
current=19.28648161897097 new_mae=29.760671396579955
current=19.28648161897097 new_mae=25.95911337302336
current=19.28648161897097 new_mae=19.319998227083325
current=19.28648161897097 new_mae=27.160994281297725
current=19.28648161897097 new_mae=21.713447254032793
current=19.28648161897097 new_mae=42.034133270281046
current=19.28648161897097 new_mae=24.528496008380472
current=19.28648161897097 new_mae=23.570677450791965
current=19.28648161897097 new_mae=19.999272735051782
current=19.28648161897097 new_mae=21.98825735339597
current=19.28648161897097 new_mae=33.46889362654069
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.28648161897097 new_mae=19.700283397869416
current=19.28648161897097 new_mae=21.913037108551652
current=19.28648161897097 new_mae=19.620913169813548
current=19.28648161897097 new_mae=33.54653669235415
current=19.28648161897097 new_mae=22.718937813017366
current=19.28648161897097 new_mae=21.241459051554877
current=19.28648161897097 new_mae=26.24546819828851
current=19.28648161897097 new_mae=24.543389673281517
current=19.28648161897097 new_mae=32.09304742301724
current=19.28648161897097 new_mae=29.57554639900117
current=19.28648161897097 new_mae=19.572867167414554
current=19.28648161897097 new_mae=21.47418892585384
current=19.28648161897097 new_mae=21.946289467934925
current=19.28648161897097 new_mae=28.574680751154226
current=19.28648161897097 new_mae=19.698618151462572
current=19.28648161897097 new_mae=24.909574144604804
current=19.28648161897097 new_mae=26.234416681790332
current=19.28648161897097 new_mae=37.816392812375106
current=19.28648161897097 new_mae=22.737155304981748
current=19.28648161897097 new_mae=20.934629566176852
current=19.28648161897097 new_mae=29.682001058950103
current=19.28648161897097 new_mae=19.40160813110648
current=19.28648161897097 new_mae=36.85760226451535
current=19.28648161897097 new_mae=36.13004044509024
current=19.28648161897097 new_mae=24.21048088168545
current=19.28648161897097 new_mae=23.858573627296018
current=19.28648161897097 new_mae=25.962741676165663
current=19.28648161897097 new_mae=22.678468116153592
current=19.28648161897097 new_mae=30.812663013810237
current=19.28648161897097 new_mae=27.216104759535707
current=19.28648161897097 new_mae=29.755606431995584
current=19.28648161897097 new_mae=31.301370454352952
current=19.28648161897097 new_mae=19.385601037894226
current=19.28648161897097 new_mae=24.104954594851076
current=19.28648161897097 new_mae=43.924172036591266
current=19.28648161897097 new_mae=22.807884666831328
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.25304532336908225
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>model is some function that usually takes parameters and predicts data.</p>
<p>parameters are free to vary, structure of the model is set in stone</p>
<p>we can evaluate model predictions via a loss function, and smaller loss is better.</p>
<p>We find parameters that minimize the loss function.  this amounts to “fitting” the model.</p>
<p>this is done via some kind of optimization algorithm.</p>
<div class="section" id="gradient-descent">
<h3>Gradient descent<a class="headerlink" href="#gradient-descent" title="Permalink to this headline">¶</a></h3>
<p>Start with some parameter values.  Figure out which direction of change in parameter values reduces the loss.  Change parameter values in that direction.  Repeat until some criterion is reached.</p>
<p><span class="math notranslate nohighlight">\(L(a,b) = \frac{1}{n} \sum_{i=0}^n (\hat y_i - y_i)^2\)</span></p>
<p><span class="math notranslate nohighlight">\(L(a,b) = \frac{1}{n} \sum_{i=0}^n (a x_i + b - y_i)^2\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{\partial L(a,b)}{\partial a} = \frac{1}{n} \sum_{i=0}^n 2 (a x_i + b - y_i) x_i\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{\partial L(a,b)}{\partial b} = \frac{1}{n} \sum_{i=0}^n 2 (a x_i + b - y_i)\)</span></p>
</div>
</div>
<div class="section" id="writing-our-own-model-class">
<h2>Writing our own model class<a class="headerlink" href="#writing-our-own-model-class" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-kinds-of-operations-should-a-model-support">
<h3>What kinds of operations should a model support?<a class="headerlink" href="#what-kinds-of-operations-should-a-model-support" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>predict data, usually given some input</p></li>
<li><p>evaluate the quality of its predictions given some ground truth observations</p></li>
<li><p>fit its parameters to observed data</p></li>
<li><p>for <em>inferential statistics</em>: compare its fitted parameters to null values, provide confidence intervals on parameters, etc.</p></li>
</ul>
</div>
<div class="section" id="baby-steps">
<h3>Baby steps<a class="headerlink" href="#baby-steps" title="Permalink to this headline">¶</a></h3>
<p><strong>for linear regression</strong></p>
<div class="section" id="predict">
<h4>predict<a class="headerlink" href="#predict" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code>x a 1d numpy array of length <code class="docutils literal notranslate"><span class="pre">n</span></code>, and returns a 1d array of <code class="docutils literal notranslate"><span class="pre">n</span></code> predicted y values, given <code class="docutils literal notranslate"><span class="pre">slope=0.5</span></code>, and <code class="docutils literal notranslate"><span class="pre">intercept=50</span></code></p>
</div>
<div class="section" id="evaluate">
<h4>evaluate<a class="headerlink" href="#evaluate" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> (both arrays of length <code class="docutils literal notranslate"><span class="pre">n</span></code>) and returns the mean squared error of the prediction.</p>
</div>
<div class="section" id="fit">
<h4>fit<a class="headerlink" href="#fit" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> and finds some good values of slope and intercept by minimizing the mean squared error loss function, somehow.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./live"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ed Vul<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>