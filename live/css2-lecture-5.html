
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lecture 5: Modeling Data &#8212; UCSD CSS 2</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">UCSD CSS 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome to CSS 2
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Course (CSS 2 Spring 2022)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../course/syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/expectations.html">
   Expectations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/datahub.html">
   Datahub assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/debugging.html">
   Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/resources.html">
   Extracurricular Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/final.html">
   Final Project
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lectures
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_2.html">
   Lecture 2 (3/30/22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_3.html">
   Lecture 3 (4/1/22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_4.html">
   Lecture 4 (4/4/22)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/live/css2-lecture-5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/UCSD-CSS-002/ucsd-css-002.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/UCSD-CSS-002/ucsd-css-002.github.io/issues/new?title=Issue%20on%20page%20%2Flive/css2-lecture-5.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/UCSD-CSS-002/ucsd-css-002.github.io/master?urlpath=tree/live/css2-lecture-5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#this-week">
   This week:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#things-we-do-with-data">
   Things we do with data.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-model">
   What is a model?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-parts">
   Model parts.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-structures-and-parameters">
   Model structures and parameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loss-functions">
   Loss functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-for-regression">
     Loss for Regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sum-squared-error">
       Sum squared error
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-for-classification">
     Loss for Classification
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimization-algorithm">
   Optimization algorithm
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grid-search">
     Grid search
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-search">
     Random search
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gradient-descent">
     Gradient descent
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-our-own-model-class">
   Writing our own model class
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-kinds-of-operations-should-a-model-support">
     What kinds of operations should a model support?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#baby-steps">
     Baby steps
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#predict">
       predict
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#evaluate">
       evaluate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fit">
       fit
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="lecture-5-modeling-data">
<h1>Lecture 5: Modeling Data<a class="headerlink" href="#lecture-5-modeling-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="this-week">
<h2>This week:<a class="headerlink" href="#this-week" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>no problem set, one integrated lab, due at the usual problem set time (monday)</p></li>
<li><p>covering mostly conceptual material, which will serve as the basis of understanding the stuff we do later.</p></li>
</ul>
</div>
<div class="section" id="things-we-do-with-data">
<h2>Things we do with data.<a class="headerlink" href="#things-we-do-with-data" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>describe, summarize, visualize</p></li>
<li><p>infer latent structure, rules, properties, parameters</p></li>
<li><p>generalize to predict, interpolate, extrapolate</p></li>
</ol>
<p>Classical statistics is mostly about #2.  Machine learning is mostly about #3.  Computational Social Science uses tools and models from both.</p>
<p>Both of these rely on fitting models to the data, but the design of the models, and model evaluation differ.</p>
</div>
<div class="section" id="what-is-a-model">
<h2>What is a model?<a class="headerlink" href="#what-is-a-model" title="Permalink to this headline">¶</a></h2>
<p>A model <em>assumes</em> some <strong>structure</strong> of the data, and has some <strong>parameters</strong> that are <em>fit</em> to the data.  The end result is an object that may be used in various ways for data summarization, inference, and prediction.</p>
<p><strong>Examples</strong>: Linear regression, logistic regression, decision tree, neural networks of various architectures, support vector machine, etc.</p>
<p>The structural assumptions constrain what kind of relationships can be captured by the model, but are also necessary to generalize beyond the data.</p>
<p><strong>Even when we simply describe or summarize data, we implicitly have a model in mind.</strong></p>
<p>I have the following data describing the flips of a coin <em><strong>how should I summarize them?</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;H&#39;, &#39;H&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;H&#39;, &#39;H&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># probability of heads </span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="c1"># if we think the coin might be bent.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3076923076923077
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># coin generated by a process that may be </span>
<span class="c1"># likely to repeat previous outcome</span>

<span class="n">transitions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">prev</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">prev</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">prev</span> <span class="o">==</span> <span class="n">outcome</span><span class="p">:</span>
            <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;different&#39;</span><span class="p">)</span>
    <span class="n">prev</span> <span class="o">=</span> <span class="n">outcome</span>

<span class="nb">print</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;same&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_same</span> <span class="o">=</span> <span class="n">transitions</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;same&#39;</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_same</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.75
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># spin a spinner.  if spinner lands in red then we stop flipping coin.</span>
<span class="c1"># if spinner lands on green, then we flip one more time.</span>
<span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="model-parts">
<h2>Model parts.<a class="headerlink" href="#model-parts" title="Permalink to this headline">¶</a></h2>
<p><strong>Structure:</strong> These are the core assumptions of the model.  Whatever you do in the fitting process, these are not going to change, they are set in stone.</p>
<p>e.g., in linear regression:  <span class="math notranslate nohighlight">\(\hat y = a x + b\)</span></p>
<p>e.g., not <span class="math notranslate nohighlight">\(\hat y = a x^2 + b\)</span></p>
<p><strong>Parameters:</strong> These are the moving parts of the model that are fit to the data.</p>
<p>e.g., in linear regression: <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span></p>
<p><strong>Loss / objective / goodness of fit function:</strong> This is a function that can consider the model and its parameters, and the observed data, and returns a number indicating how well/badly the model fits.  How do I decide whether one value of the parameters is better or worse than another?</p>
<p>e.g., in linear regression: this could be mean squared error, or the likelihood under a normal probability distribution, or the posterior probability of a particular set of parameters, or the mean absolute error, or the quantile error, or… etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7fc680092490&gt;
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_12_1.png" src="../_images/css2-lecture-5_12_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.03394449,  0.56898778])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.59263214,  0.51188327, -0.35662343, -0.03143244,  0.27015073,
        0.28486807, -0.01646497, -0.03619693, -0.44504958,  0.85778899])
</pre></div>
</div>
</div>
</div>
<p><strong>Optimization algorithm:</strong> how do I find the <em>best fitting</em> (loss minimizing, objective maximizing, goodness of fit maximizing) values of the parameters?</p>
<p>e.g., in linear regression, there are various linear algebra tricks available to do so robustly (out of scope here).</p>
</div>
<div class="section" id="model-structures-and-parameters">
<h2>Model structures and parameters<a class="headerlink" href="#model-structures-and-parameters" title="Permalink to this headline">¶</a></h2>
<p>There are <em>many</em>.  We will spend the bulk of class talking about the varieties of model structures that are out there, what they assume, and what they are good at.</p>
</div>
<div class="section" id="loss-functions">
<h2>Loss functions<a class="headerlink" href="#loss-functions" title="Permalink to this headline">¶</a></h2>
<p>There are relatively few, for common problem types.  We will learn the basics of these because they are essential to understanding what models are doing.</p>
<div class="section" id="loss-for-regression">
<h3>Loss for Regression<a class="headerlink" href="#loss-for-regression" title="Permalink to this headline">¶</a></h3>
<p>Regression: predict some number from other data.</p>
<p>Let’s say we want to predict weight.  How do we evaluate how well we have done this?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># our loss function is a single number that </span>
<span class="c1"># tells us how bad our predictions are.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Errors</strong></p>
<ol class="simple">
<li><p>Ratio error.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">weight</span><span class="o">/</span><span class="n">predicted_weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.        , -0.03077166,  0.        ,  0.87546874,  0.01550419])
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Linear error</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_weight</span> <span class="o">-</span> <span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([   0,    5,    0, -140,   -2])
</pre></div>
</div>
</div>
</div>
<p><strong>Summarizing errors</strong></p>
<p>Mean of the squared errors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors</span> <span class="o">=</span> <span class="n">predicted_weight</span> <span class="o">-</span> <span class="n">weight</span>
<span class="n">errors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([   0,    5,    0, -140,   -2])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># squared errors</span>
<span class="n">errors</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([    0,    25,     0, 19600,     4])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">errors</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="section" id="sum-squared-error">
<h4>Sum squared error<a class="headerlink" href="#sum-squared-error" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>

<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">175</span><span class="p">])</span>

<span class="c1"># they increase with number of data points.  </span>
<span class="c1"># because we sum all data point errors squared.</span>
<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19654
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>

<span class="c1"># sum of squared errors dominated by large errors.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19600
</pre></div>
</div>
</div>
</div>
<p><strong>Mean squared errors</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3920.0
</pre></div>
</div>
</div>
</div>
<p>Aside: standard error of the mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([180, 160, 175, 240, 130])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>177.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.099689437998485
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">177</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="mi">177</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[145, 209]
</pre></div>
</div>
</div>
</div>
<p>Simple model:</p>
<p><span class="math notranslate nohighlight">\(\hat y = m\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter / prediction</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># error</span>
<span class="nb">print</span><span class="p">(</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span>
<span class="c1"># squared error</span>
<span class="nb">print</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># sum of squared error</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># mean of squared error</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  3. -17.  -2.  63. -47.]
[   9.  289.    4. 3969. 2209.]
6480.0
1296.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
<span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1296.0
</pre></div>
</div>
</div>
</div>
<p><strong>Loss function:</strong> is some function of the prediction, and the actual data, that returns one number, which is bigger when our predictions are worse.</p>
<p><strong>Mean squared error</strong></p>
<p><strong>Mean absolute error</strong></p>
<p><strong>not exactly right proportion</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3920.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mae</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mae</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>28.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_error</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">280</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mean_error</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">not_exactly_right_proportion</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">not_exactly_right_proportion</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="loss-for-classification">
<h3>Loss for Classification<a class="headerlink" href="#loss-for-classification" title="Permalink to this headline">¶</a></h3>
<p>Classification: predict a label, (in contrast to a number)</p>
<p>Let’s say we want to predict sex (male/female).  How do we evaluate how well we have done this?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># binary predictions loss functions:</span>

<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>

<span class="n">predicted_y</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inaccuracy</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>

<span class="n">predicted_y</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Developing new loss functions is where a lot of the action is for state of the art machine learning, because this is where we specify what it means for a machine to achieve certain intelligent goals.  This is particularly important for RL, and other domains where we don’t actually know what we mean by “intelligent behavior”.</p>
</div>
</div>
<div class="section" id="optimization-algorithm">
<h2>Optimization algorithm<a class="headerlink" href="#optimization-algorithm" title="Permalink to this headline">¶</a></h2>
<p>There are many. Very active area of research, we will generally not cover them in great detail.  Let’s cover some basics though.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># goal: predict weight from height</span>

<span class="c1"># model is: predicted_y = slope * x + intercept</span>

<span class="c1"># parameters are: slope, intercept</span>

<span class="c1"># loss function:  mean absolute error</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">hw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;height-weight.csv&#39;</span><span class="p">)</span>

<span class="n">hw</span> <span class="o">=</span> <span class="n">hw</span><span class="p">[</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">36</span><span class="p">]</span>

<span class="n">hw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>67.75</td>
      <td>154.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>72.25</td>
      <td>173.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>66.25</td>
      <td>154.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>72.25</td>
      <td>184.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>71.25</td>
      <td>184.25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>247</th>
      <td>67.00</td>
      <td>134.25</td>
    </tr>
    <tr>
      <th>248</th>
      <td>69.75</td>
      <td>201.00</td>
    </tr>
    <tr>
      <th>249</th>
      <td>66.00</td>
      <td>186.75</td>
    </tr>
    <tr>
      <th>250</th>
      <td>70.50</td>
      <td>190.75</td>
    </tr>
    <tr>
      <th>251</th>
      <td>70.00</td>
      <td>207.50</td>
    </tr>
  </tbody>
</table>
<p>251 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fc680c00280&gt;]
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_62_1.png" src="../_images/css2-lecture-5_62_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mae</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20.21573705179283
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">5.75</span><span class="p">,</span> <span class="o">-</span><span class="mi">227</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;m-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;y-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fc680cda610&gt;]
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_65_1.png" src="../_images/css2-lecture-5_65_1.png" />
</div>
</div>
<div class="section" id="grid-search">
<h3>Grid search<a class="headerlink" href="#grid-search" title="Permalink to this headline">¶</a></h3>
<p>Consider a bunch of possible parameter settings.  Evaluate loss for each.  Pick the best one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">current_lowest</span> <span class="o">=</span> <span class="mi">1000000000</span>

<span class="n">best_slope</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">best_intercept</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">slope</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">intercept</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
        <span class="n">current_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> 
                                  <span class="n">intercept</span><span class="p">,</span> 
                                  <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> 
                          <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">current_mae</span> <span class="o">&lt;</span> <span class="n">current_lowest</span><span class="p">:</span>
            <span class="n">current_lowest</span> <span class="o">=</span> <span class="n">current_mae</span>
            <span class="n">best_slope</span> <span class="o">=</span> <span class="n">slope</span>
            <span class="n">best_intercept</span> <span class="o">=</span> <span class="n">intercept</span>
        <span class="c1">#print(f&#39;{slope=}, {intercept=}, {current_mae=}&#39;)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">current_lowest</span><span class="p">,</span> <span class="n">best_slope</span><span class="p">,</span> <span class="n">best_intercept</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18.837854642037907 5.757575757575758 -227.2727272727273
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.        , 0.05050505, 0.1010101 , 0.15151515, 0.2020202 ,
       0.25252525, 0.3030303 , 0.35353535, 0.4040404 , 0.45454545,
       0.50505051, 0.55555556, 0.60606061, 0.65656566, 0.70707071,
       0.75757576, 0.80808081, 0.85858586, 0.90909091, 0.95959596,
       1.01010101, 1.06060606, 1.11111111, 1.16161616, 1.21212121,
       1.26262626, 1.31313131, 1.36363636, 1.41414141, 1.46464646,
       1.51515152, 1.56565657, 1.61616162, 1.66666667, 1.71717172,
       1.76767677, 1.81818182, 1.86868687, 1.91919192, 1.96969697,
       2.02020202, 2.07070707, 2.12121212, 2.17171717, 2.22222222,
       2.27272727, 2.32323232, 2.37373737, 2.42424242, 2.47474747,
       2.52525253, 2.57575758, 2.62626263, 2.67676768, 2.72727273,
       2.77777778, 2.82828283, 2.87878788, 2.92929293, 2.97979798,
       3.03030303, 3.08080808, 3.13131313, 3.18181818, 3.23232323,
       3.28282828, 3.33333333, 3.38383838, 3.43434343, 3.48484848,
       3.53535354, 3.58585859, 3.63636364, 3.68686869, 3.73737374,
       3.78787879, 3.83838384, 3.88888889, 3.93939394, 3.98989899,
       4.04040404, 4.09090909, 4.14141414, 4.19191919, 4.24242424,
       4.29292929, 4.34343434, 4.39393939, 4.44444444, 4.49494949,
       4.54545455, 4.5959596 , 4.64646465, 4.6969697 , 4.74747475,
       4.7979798 , 4.84848485, 4.8989899 , 4.94949495, 5.        ])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="random-search">
<h3>Random search<a class="headerlink" href="#random-search" title="Permalink to this headline">¶</a></h3>
<p>Start with some parameter values.  Propose a local perturbation.  If it is better, adopt that one, and continue.  Until some criterion is reached.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">current</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>

<span class="n">attempts</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">attempts</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
    <span class="n">new_slope</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">new_intercept</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span>
    
    <span class="n">new_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">new_slope</span><span class="p">,</span> 
                          <span class="n">new_intercept</span><span class="p">,</span> 
                          <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> 
                  <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">current</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">new_mae</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">attempts</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">new_mae</span> <span class="o">&lt;</span> <span class="n">current</span><span class="p">:</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="n">new_slope</span>
        <span class="n">intercept</span> <span class="o">=</span> <span class="n">new_intercept</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">new_mae</span>
        <span class="n">attempts</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">slope</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">intercept</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">current</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=178.82051792828688 new_mae=182.97266903709712
current=178.82051792828688 new_mae=160.19961015717132
slope=0.2887589882853926 intercept=-1.6819552777314195 current=160.19961015717132
current=160.19961015717132 new_mae=188.65034049784987
current=160.19961015717132 new_mae=193.28951500968884
current=160.19961015717132 new_mae=183.83818969313162
current=160.19961015717132 new_mae=180.43153382511235
current=160.19961015717132 new_mae=173.36699951096304
current=160.19961015717132 new_mae=181.63618664601
current=160.19961015717132 new_mae=186.50019636284966
current=160.19961015717132 new_mae=124.199625237965
slope=0.7618935289473169 intercept=1.0515819378825841 current=124.199625237965
current=124.199625237965 new_mae=134.02233400505477
current=124.199625237965 new_mae=107.85652439076947
slope=0.9467657562369135 intercept=4.3961765412263265 current=107.85652439076947
current=107.85652439076947 new_mae=136.45456120737518
current=107.85652439076947 new_mae=145.88776954152314
current=107.85652439076947 new_mae=114.57911684310851
current=107.85652439076947 new_mae=89.50257176981555
slope=1.1312733847339875 intercept=9.777258135421896 current=89.50257176981555
current=89.50257176981555 new_mae=95.46988858187079
current=89.50257176981555 new_mae=113.78684694373017
current=89.50257176981555 new_mae=86.11523329178942
slope=1.0803043156433196 intercept=16.748270443376736 current=86.11523329178942
current=86.11523329178942 new_mae=101.52838147087192
current=86.11523329178942 new_mae=71.56913969678145
slope=1.380608380573822 intercept=10.17975791131895 current=71.56913969678145
current=71.56913969678145 new_mae=63.228752258022624
slope=1.4994635124794184 intercept=10.163351055775092 current=63.228752258022624
current=63.228752258022624 new_mae=72.2121077553319
current=63.228752258022624 new_mae=42.81450144225578
slope=1.679705673515166 intercept=18.157919579808706 current=42.81450144225578
current=42.81450144225578 new_mae=22.362178019868225
slope=2.0094974368626337 intercept=23.21426314894723 current=22.362178019868225
current=22.362178019868225 new_mae=22.01655974834698
slope=2.086256141312865 intercept=18.638106182747258 current=22.01655974834698
current=22.01655974834698 new_mae=38.67000790346064
current=22.01655974834698 new_mae=31.29787074692158
current=22.01655974834698 new_mae=38.646415179620526
current=22.01655974834698 new_mae=23.49604811465106
current=22.01655974834698 new_mae=27.717920896307202
current=22.01655974834698 new_mae=32.19613258222341
current=22.01655974834698 new_mae=24.18122954615835
current=22.01655974834698 new_mae=20.104265670389953
slope=2.295046335841403 intercept=12.4938085576255 current=20.104265670389953
current=20.104265670389953 new_mae=20.88523467390712
current=20.104265670389953 new_mae=20.106074733311697
current=20.104265670389953 new_mae=20.204364177741812
current=20.104265670389953 new_mae=28.273959659086696
current=20.104265670389953 new_mae=27.477915159461745
current=20.104265670389953 new_mae=21.020677824982005
current=20.104265670389953 new_mae=29.191128750542866
current=20.104265670389953 new_mae=39.28047358923498
current=20.104265670389953 new_mae=21.07653217027038
current=20.104265670389953 new_mae=20.174631893560576
current=20.104265670389953 new_mae=22.59881876562157
current=20.104265670389953 new_mae=27.629638675733336
current=20.104265670389953 new_mae=20.715199341052642
current=20.104265670389953 new_mae=24.375921591651576
current=20.104265670389953 new_mae=20.14421091892006
current=20.104265670389953 new_mae=23.92320011198231
current=20.104265670389953 new_mae=36.200345965513286
current=20.104265670389953 new_mae=39.05378375798984
current=20.104265670389953 new_mae=39.85287231121125
current=20.104265670389953 new_mae=35.96229454871327
current=20.104265670389953 new_mae=21.10744280116899
current=20.104265670389953 new_mae=30.587300094387693
current=20.104265670389953 new_mae=33.43789121148592
current=20.104265670389953 new_mae=20.393852857141137
current=20.104265670389953 new_mae=31.088878215037226
current=20.104265670389953 new_mae=21.569772672930448
current=20.104265670389953 new_mae=20.133054012528014
current=20.104265670389953 new_mae=20.12942621541357
current=20.104265670389953 new_mae=20.721681696014034
current=20.104265670389953 new_mae=21.135659687663026
current=20.104265670389953 new_mae=20.072674260261365
slope=2.410492359768562 intercept=7.009358419620873 current=20.072674260261365
current=20.072674260261365 new_mae=21.37151928212957
current=20.072674260261365 new_mae=30.71443998968783
current=20.072674260261365 new_mae=31.682587299491768
current=20.072674260261365 new_mae=24.25134170615699
current=20.072674260261365 new_mae=25.63878286499811
current=20.072674260261365 new_mae=28.703355221583596
current=20.072674260261365 new_mae=21.069960506031048
current=20.072674260261365 new_mae=22.535957400771878
current=20.072674260261365 new_mae=39.41298016165584
current=20.072674260261365 new_mae=32.05448162346426
current=20.072674260261365 new_mae=21.883124042818434
current=20.072674260261365 new_mae=29.01756977223131
current=20.072674260261365 new_mae=20.419460960963193
current=20.072674260261365 new_mae=20.8824838409173
current=20.072674260261365 new_mae=29.877307765271215
current=20.072674260261365 new_mae=20.571278849358983
current=20.072674260261365 new_mae=20.104055389055173
current=20.072674260261365 new_mae=36.54384871820316
current=20.072674260261365 new_mae=31.15059435502826
current=20.072674260261365 new_mae=31.30853462064856
current=20.072674260261365 new_mae=23.639472972804125
current=20.072674260261365 new_mae=29.297121336430397
current=20.072674260261365 new_mae=20.01866949714011
slope=2.4308808801938397 intercept=2.591934809125707 current=20.01866949714011
current=20.01866949714011 new_mae=20.35829688014876
current=20.01866949714011 new_mae=31.564073747327015
current=20.01866949714011 new_mae=20.91797962877462
current=20.01866949714011 new_mae=42.00993266642087
current=20.01866949714011 new_mae=22.933341422705368
current=20.01866949714011 new_mae=22.18645711451003
current=20.01866949714011 new_mae=21.085131904142166
current=20.01866949714011 new_mae=22.517530374473992
current=20.01866949714011 new_mae=19.996473435757284
slope=2.614872776732321 intercept=-6.416900219057402 current=19.996473435757284
current=19.996473435757284 new_mae=25.590776099741714
current=19.996473435757284 new_mae=19.99715990553123
current=19.996473435757284 new_mae=31.043505579104767
current=19.996473435757284 new_mae=31.477641667221533
current=19.996473435757284 new_mae=21.10182532055954
current=19.996473435757284 new_mae=20.774335564702728
current=19.996473435757284 new_mae=33.99020548232877
current=19.996473435757284 new_mae=28.198395056131567
current=19.996473435757284 new_mae=38.99150491872862
current=19.996473435757284 new_mae=32.2692636949933
current=19.996473435757284 new_mae=20.564118450391298
current=19.996473435757284 new_mae=24.049416812864763
current=19.996473435757284 new_mae=22.116195164418805
current=19.996473435757284 new_mae=21.12907295744768
current=19.996473435757284 new_mae=25.818701958107628
current=19.996473435757284 new_mae=24.223838244341326
current=19.996473435757284 new_mae=29.33530294972033
current=19.996473435757284 new_mae=24.174918890113965
current=19.996473435757284 new_mae=21.785393367382934
current=19.996473435757284 new_mae=23.84655813344079
current=19.996473435757284 new_mae=22.054796402388106
current=19.996473435757284 new_mae=35.77460157467993
current=19.996473435757284 new_mae=24.860023648959302
current=19.996473435757284 new_mae=20.31715836428577
current=19.996473435757284 new_mae=21.891112925788033
current=19.996473435757284 new_mae=25.633666884958977
current=19.996473435757284 new_mae=22.87567076926403
current=19.996473435757284 new_mae=35.08453711513561
current=19.996473435757284 new_mae=36.98602159207238
current=19.996473435757284 new_mae=26.37416024003295
current=19.996473435757284 new_mae=23.958474941564436
current=19.996473435757284 new_mae=31.35332603868574
current=19.996473435757284 new_mae=36.412205043121624
current=19.996473435757284 new_mae=34.363863156192735
current=19.996473435757284 new_mae=20.1615241545912
current=19.996473435757284 new_mae=20.322094319359877
current=19.996473435757284 new_mae=26.0520363856505
current=19.996473435757284 new_mae=23.09399925032761
current=19.996473435757284 new_mae=28.303849571722097
current=19.996473435757284 new_mae=23.856221047271784
current=19.996473435757284 new_mae=22.463327147854677
current=19.996473435757284 new_mae=31.934481449903615
current=19.996473435757284 new_mae=22.10888016592264
current=19.996473435757284 new_mae=24.947659603774895
current=19.996473435757284 new_mae=28.043839800555475
current=19.996473435757284 new_mae=28.616011155856295
current=19.996473435757284 new_mae=29.814732616733938
current=19.996473435757284 new_mae=39.537490615507444
current=19.996473435757284 new_mae=31.597830732075494
current=19.996473435757284 new_mae=23.743908047688855
current=19.996473435757284 new_mae=24.291206234832256
current=19.996473435757284 new_mae=32.93802399525527
current=19.996473435757284 new_mae=38.79365927299233
current=19.996473435757284 new_mae=27.063772358976724
current=19.996473435757284 new_mae=36.00810801487744
current=19.996473435757284 new_mae=33.57769719961876
current=19.996473435757284 new_mae=21.92352139887445
current=19.996473435757284 new_mae=35.42112135794176
current=19.996473435757284 new_mae=28.825293963126025
current=19.996473435757284 new_mae=29.45853370606434
current=19.996473435757284 new_mae=21.598888016497764
current=19.996473435757284 new_mae=29.59693091549241
current=19.996473435757284 new_mae=22.639150118873744
current=19.996473435757284 new_mae=21.63751801669315
current=19.996473435757284 new_mae=31.98488291048158
current=19.996473435757284 new_mae=37.876416468369406
current=19.996473435757284 new_mae=20.437730292165433
current=19.996473435757284 new_mae=26.09710642581596
current=19.996473435757284 new_mae=40.69684171078892
current=19.996473435757284 new_mae=20.366452232545825
current=19.996473435757284 new_mae=20.09943367677224
current=19.996473435757284 new_mae=25.453991496913837
current=19.996473435757284 new_mae=36.48385692271344
current=19.996473435757284 new_mae=21.96854827876606
current=19.996473435757284 new_mae=34.35635274898909
current=19.996473435757284 new_mae=21.440535253691127
current=19.996473435757284 new_mae=22.07954768274009
current=19.996473435757284 new_mae=21.528595212596425
current=19.996473435757284 new_mae=20.909944487356498
current=19.996473435757284 new_mae=25.275457226609028
current=19.996473435757284 new_mae=27.088716167927622
current=19.996473435757284 new_mae=36.38287803326024
current=19.996473435757284 new_mae=29.706212228889385
current=19.996473435757284 new_mae=27.501754095962617
current=19.996473435757284 new_mae=32.46575311962315
current=19.996473435757284 new_mae=20.24508557489717
current=19.996473435757284 new_mae=21.559174212210795
current=19.996473435757284 new_mae=21.425564841917065
current=19.996473435757284 new_mae=25.404586334173285
current=19.996473435757284 new_mae=23.25397251743246
current=19.996473435757284 new_mae=30.696636318551185
current=19.996473435757284 new_mae=31.910087421692097
current=19.996473435757284 new_mae=27.784821418453543
current=19.996473435757284 new_mae=30.343982365039416
current=19.996473435757284 new_mae=36.00333391699511
current=19.996473435757284 new_mae=42.965767741591755
current=19.996473435757284 new_mae=31.285229970953818
current=19.996473435757284 new_mae=19.865800708763466
slope=2.5941082013576446 intercept=-7.395288848813559 current=19.865800708763466
current=19.865800708763466 new_mae=23.11636524453213
current=19.865800708763466 new_mae=19.94216403680564
current=19.865800708763466 new_mae=21.75864316947983
current=19.865800708763466 new_mae=25.522098386837783
current=19.865800708763466 new_mae=21.176857825698782
current=19.865800708763466 new_mae=26.800513452421075
current=19.865800708763466 new_mae=23.836224658755604
current=19.865800708763466 new_mae=22.108753912076438
current=19.865800708763466 new_mae=38.31955335980275
current=19.865800708763466 new_mae=33.1731818444106
current=19.865800708763466 new_mae=20.622501733463107
current=19.865800708763466 new_mae=25.652260695493254
current=19.865800708763466 new_mae=25.702146204140853
current=19.865800708763466 new_mae=33.563589719271704
current=19.865800708763466 new_mae=25.60095807115938
current=19.865800708763466 new_mae=23.109134555635418
current=19.865800708763466 new_mae=21.615410171008445
current=19.865800708763466 new_mae=29.812561871116696
current=19.865800708763466 new_mae=23.20899155840688
current=19.865800708763466 new_mae=24.756266761140854
current=19.865800708763466 new_mae=29.06103246113071
current=19.865800708763466 new_mae=38.754095270286044
current=19.865800708763466 new_mae=20.200547811622595
current=19.865800708763466 new_mae=23.609285370671305
current=19.865800708763466 new_mae=25.898074720963432
current=19.865800708763466 new_mae=26.215974410672676
current=19.865800708763466 new_mae=33.577211459158995
current=19.865800708763466 new_mae=22.6492575709293
current=19.865800708763466 new_mae=27.236794287773034
current=19.865800708763466 new_mae=20.065809069911634
current=19.865800708763466 new_mae=26.519427079695827
current=19.865800708763466 new_mae=32.006654343542046
current=19.865800708763466 new_mae=32.94408739450611
current=19.865800708763466 new_mae=32.45604294165276
current=19.865800708763466 new_mae=27.45543815190127
current=19.865800708763466 new_mae=25.751602908384317
current=19.865800708763466 new_mae=25.236956110959564
current=19.865800708763466 new_mae=26.619950543004364
current=19.865800708763466 new_mae=20.310771059375135
current=19.865800708763466 new_mae=45.04928881577091
current=19.865800708763466 new_mae=25.426080785638987
current=19.865800708763466 new_mae=21.98525986455596
current=19.865800708763466 new_mae=31.926183138204706
current=19.865800708763466 new_mae=20.69694109283177
current=19.865800708763466 new_mae=27.69247528555983
current=19.865800708763466 new_mae=28.97016861281139
current=19.865800708763466 new_mae=22.786624767840067
current=19.865800708763466 new_mae=26.956207703465655
current=19.865800708763466 new_mae=19.860035470026986
slope=2.703367299308644 intercept=-16.973786955831194 current=19.860035470026986
current=19.860035470026986 new_mae=19.934835304032628
current=19.860035470026986 new_mae=21.673458000523546
current=19.860035470026986 new_mae=33.37626343158673
current=19.860035470026986 new_mae=20.1164771947412
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.860035470026986 new_mae=20.126782524298015
current=19.860035470026986 new_mae=37.68868400124643
current=19.860035470026986 new_mae=20.099249146839174
current=19.860035470026986 new_mae=21.32952029286403
current=19.860035470026986 new_mae=21.632450655014857
current=19.860035470026986 new_mae=19.935211666815754
current=19.860035470026986 new_mae=31.793566034840048
current=19.860035470026986 new_mae=24.463310755577663
current=19.860035470026986 new_mae=21.522049735630606
current=19.860035470026986 new_mae=20.564842099523247
current=19.860035470026986 new_mae=22.615445900327853
current=19.860035470026986 new_mae=30.928412714862812
current=19.860035470026986 new_mae=31.419188349948435
current=19.860035470026986 new_mae=33.24905760658509
current=19.860035470026986 new_mae=20.46013297599238
current=19.860035470026986 new_mae=19.979367994626482
current=19.860035470026986 new_mae=29.340290921443792
current=19.860035470026986 new_mae=32.782585444482734
current=19.860035470026986 new_mae=23.584155557522237
current=19.860035470026986 new_mae=26.56287066040576
current=19.860035470026986 new_mae=21.61082811190956
current=19.860035470026986 new_mae=21.38029308108894
current=19.860035470026986 new_mae=20.050727945072136
current=19.860035470026986 new_mae=19.75416581433836
slope=2.8548074254537545 intercept=-24.26748791420709 current=19.75416581433836
current=19.75416581433836 new_mae=19.674739129110137
slope=2.950555471163778 intercept=-31.298472139778113 current=19.674739129110137
current=19.674739129110137 new_mae=20.855212364135955
current=19.674739129110137 new_mae=19.75818343969808
current=19.674739129110137 new_mae=30.210667732874285
current=19.674739129110137 new_mae=22.918661820388845
current=19.674739129110137 new_mae=20.022878155563596
current=19.674739129110137 new_mae=22.184782460108963
current=19.674739129110137 new_mae=29.881854426952998
current=19.674739129110137 new_mae=24.958620569628593
current=19.674739129110137 new_mae=29.21714514860201
current=19.674739129110137 new_mae=28.31882666248133
current=19.674739129110137 new_mae=22.564562101722963
current=19.674739129110137 new_mae=30.47748556862604
current=19.674739129110137 new_mae=22.382590642764953
current=19.674739129110137 new_mae=29.897319591069003
current=19.674739129110137 new_mae=20.299132228754537
current=19.674739129110137 new_mae=32.6291265144878
current=19.674739129110137 new_mae=30.25293012727766
current=19.674739129110137 new_mae=21.22707277909041
current=19.674739129110137 new_mae=21.225497903393773
current=19.674739129110137 new_mae=34.57740121306671
current=19.674739129110137 new_mae=22.381411564453575
current=19.674739129110137 new_mae=35.773232492150285
current=19.674739129110137 new_mae=29.642666310303586
current=19.674739129110137 new_mae=29.586273625388372
current=19.674739129110137 new_mae=19.654250977149044
slope=2.935110533033819 intercept=-31.822115008149076 current=19.654250977149044
current=19.654250977149044 new_mae=19.580274629384434
slope=3.0597282333904015 intercept=-40.280773921035745 current=19.580274629384434
current=19.580274629384434 new_mae=28.120480533179446
current=19.580274629384434 new_mae=26.254328732780692
current=19.580274629384434 new_mae=23.966274559693442
current=19.580274629384434 new_mae=22.464965723697055
current=19.580274629384434 new_mae=21.335481286269275
current=19.580274629384434 new_mae=29.105086020669436
current=19.580274629384434 new_mae=35.104743772364124
current=19.580274629384434 new_mae=28.103947494544926
current=19.580274629384434 new_mae=19.676198589576764
current=19.580274629384434 new_mae=20.173061305114956
current=19.580274629384434 new_mae=23.53105571299967
current=19.580274629384434 new_mae=21.615777221682873
current=19.580274629384434 new_mae=33.99134331473593
current=19.580274629384434 new_mae=20.23844578780311
current=19.580274629384434 new_mae=31.545675111589837
current=19.580274629384434 new_mae=38.28176135687731
current=19.580274629384434 new_mae=19.634137467181198
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.580274629384434 new_mae=24.617736333159698
current=19.580274629384434 new_mae=19.592356948954365
current=19.580274629384434 new_mae=24.571150159843114
current=19.580274629384434 new_mae=23.15252257935145
current=19.580274629384434 new_mae=23.626702005301787
current=19.580274629384434 new_mae=37.57196940534428
current=19.580274629384434 new_mae=20.60448120822297
current=19.580274629384434 new_mae=19.639279596178383
current=19.580274629384434 new_mae=23.79686915146372
current=19.580274629384434 new_mae=27.27622719934237
current=19.580274629384434 new_mae=25.683017616678192
current=19.580274629384434 new_mae=28.245543946303542
current=19.580274629384434 new_mae=43.79737801978588
current=19.580274629384434 new_mae=44.387073535383955
current=19.580274629384434 new_mae=28.778384272583637
current=19.580274629384434 new_mae=24.362041601523465
current=19.580274629384434 new_mae=20.860218118620576
current=19.580274629384434 new_mae=20.057807983613863
current=19.580274629384434 new_mae=38.41533168017527
current=19.580274629384434 new_mae=26.014023200164523
current=19.580274629384434 new_mae=39.113833659880456
current=19.580274629384434 new_mae=24.443713565092853
current=19.580274629384434 new_mae=26.99644260878847
current=19.580274629384434 new_mae=36.82265226032965
current=19.580274629384434 new_mae=35.19752259567305
current=19.580274629384434 new_mae=20.323575823798524
current=19.580274629384434 new_mae=28.41689861562355
current=19.580274629384434 new_mae=38.23646332079859
current=19.580274629384434 new_mae=23.002549351871973
current=19.580274629384434 new_mae=19.512926963223837
slope=3.1767617950700533 intercept=-48.17848298577363 current=19.512926963223837
current=19.512926963223837 new_mae=25.164400845571564
current=19.512926963223837 new_mae=21.148223552399397
current=19.512926963223837 new_mae=25.26557996123062
current=19.512926963223837 new_mae=28.252250550197125
current=19.512926963223837 new_mae=30.798756447766152
current=19.512926963223837 new_mae=27.337726152737147
current=19.512926963223837 new_mae=28.43573712494474
current=19.512926963223837 new_mae=34.78985670692189
current=19.512926963223837 new_mae=28.84694964370264
current=19.512926963223837 new_mae=22.163964283517153
current=19.512926963223837 new_mae=28.390379474227714
current=19.512926963223837 new_mae=35.52528128808577
current=19.512926963223837 new_mae=20.276606950832367
current=19.512926963223837 new_mae=20.647620094826102
current=19.512926963223837 new_mae=23.504234658427475
current=19.512926963223837 new_mae=19.580977043453192
current=19.512926963223837 new_mae=29.300458978101787
current=19.512926963223837 new_mae=21.764001751203544
current=19.512926963223837 new_mae=28.5801545715921
current=19.512926963223837 new_mae=22.56742518638989
current=19.512926963223837 new_mae=27.986391872212778
current=19.512926963223837 new_mae=22.972872993741966
current=19.512926963223837 new_mae=41.023073034667426
current=19.512926963223837 new_mae=27.437230893323015
current=19.512926963223837 new_mae=24.67113679778756
current=19.512926963223837 new_mae=20.63411308805319
current=19.512926963223837 new_mae=19.59416609522508
current=19.512926963223837 new_mae=34.13936494248437
current=19.512926963223837 new_mae=23.72671503917784
current=19.512926963223837 new_mae=25.78300415451665
current=19.512926963223837 new_mae=21.71935267357747
current=19.512926963223837 new_mae=23.382331094048418
current=19.512926963223837 new_mae=21.32179877803657
current=19.512926963223837 new_mae=21.532932059289745
current=19.512926963223837 new_mae=27.249320166507626
current=19.512926963223837 new_mae=19.969697845066488
current=19.512926963223837 new_mae=20.313629886052247
current=19.512926963223837 new_mae=20.909810636371738
current=19.512926963223837 new_mae=39.225693018894255
current=19.512926963223837 new_mae=31.65744549974875
current=19.512926963223837 new_mae=22.524776097817185
current=19.512926963223837 new_mae=36.185235401412186
current=19.512926963223837 new_mae=39.068256979141424
current=19.512926963223837 new_mae=30.14873462710406
current=19.512926963223837 new_mae=30.612679410430857
current=19.512926963223837 new_mae=22.026123413307385
current=19.512926963223837 new_mae=27.833405535389453
current=19.512926963223837 new_mae=21.95642476917747
current=19.512926963223837 new_mae=26.362502712641515
current=19.512926963223837 new_mae=19.632304088685867
current=19.512926963223837 new_mae=22.263380457502965
current=19.512926963223837 new_mae=25.19431043031801
current=19.512926963223837 new_mae=20.449198473007844
current=19.512926963223837 new_mae=19.62205963777344
current=19.512926963223837 new_mae=21.431333599885875
current=19.512926963223837 new_mae=19.473594254122748
slope=3.2485315137649438 intercept=-52.976484545813534 current=19.473594254122748
current=19.473594254122748 new_mae=26.76029879461273
current=19.473594254122748 new_mae=22.14830788359464
current=19.473594254122748 new_mae=31.983817832901767
current=19.473594254122748 new_mae=26.271483169004043
current=19.473594254122748 new_mae=39.06922744584882
current=19.473594254122748 new_mae=30.920760585714774
current=19.473594254122748 new_mae=30.33738330324722
current=19.473594254122748 new_mae=30.33534862110198
current=19.473594254122748 new_mae=26.798714969966248
current=19.473594254122748 new_mae=19.471715173107686
slope=3.2519984459136553 intercept=-53.54018597711331 current=19.471715173107686
current=19.471715173107686 new_mae=29.912461593728793
current=19.471715173107686 new_mae=34.87995552093083
current=19.471715173107686 new_mae=22.887077979298528
current=19.471715173107686 new_mae=21.578793563307183
current=19.471715173107686 new_mae=28.954356573948385
current=19.471715173107686 new_mae=29.47420399586966
current=19.471715173107686 new_mae=21.10387500469174
current=19.471715173107686 new_mae=25.868239236542877
current=19.471715173107686 new_mae=21.08994128138233
current=19.471715173107686 new_mae=30.125247583368257
current=19.471715173107686 new_mae=26.0307614250051
current=19.471715173107686 new_mae=25.514374989594113
current=19.471715173107686 new_mae=32.31664122463807
current=19.471715173107686 new_mae=24.899301001104842
current=19.471715173107686 new_mae=19.45349933674679
slope=3.3877690141995855 intercept=-61.24007549998352 current=19.45349933674679
current=19.45349933674679 new_mae=33.73169235011992
current=19.45349933674679 new_mae=23.38810241294359
current=19.45349933674679 new_mae=21.234217979960658
current=19.45349933674679 new_mae=24.83746353933906
current=19.45349933674679 new_mae=33.52968392246971
current=19.45349933674679 new_mae=27.03525269567663
current=19.45349933674679 new_mae=20.115093244561436
current=19.45349933674679 new_mae=19.98164056729662
current=19.45349933674679 new_mae=20.440608833325086
current=19.45349933674679 new_mae=21.747541231836326
current=19.45349933674679 new_mae=19.94075189202728
current=19.45349933674679 new_mae=28.78981362602294
current=19.45349933674679 new_mae=22.612648930451062
current=19.45349933674679 new_mae=22.657407494852468
current=19.45349933674679 new_mae=29.10034549618701
current=19.45349933674679 new_mae=28.265192046927986
current=19.45349933674679 new_mae=32.6750117829565
current=19.45349933674679 new_mae=25.515327895760493
current=19.45349933674679 new_mae=30.177009983213217
current=19.45349933674679 new_mae=30.902571637622444
current=19.45349933674679 new_mae=32.329146036352775
current=19.45349933674679 new_mae=38.03130569508088
current=19.45349933674679 new_mae=32.864070251987734
current=19.45349933674679 new_mae=19.341743288217586
slope=3.5102306929642237 intercept=-70.92272167883439 current=19.341743288217586
current=19.341743288217586 new_mae=26.46748967808608
current=19.341743288217586 new_mae=37.46726344282545
current=19.341743288217586 new_mae=34.27350789168926
current=19.341743288217586 new_mae=19.565164208153927
current=19.341743288217586 new_mae=38.869887466043345
current=19.341743288217586 new_mae=35.06763170362709
current=19.341743288217586 new_mae=21.210546654367537
current=19.341743288217586 new_mae=23.000885997254336
current=19.341743288217586 new_mae=21.504342440083196
current=19.341743288217586 new_mae=24.530830753371493
current=19.341743288217586 new_mae=27.496276079791247
current=19.341743288217586 new_mae=27.455631831858486
current=19.341743288217586 new_mae=21.40950661985026
current=19.341743288217586 new_mae=31.86274628695111
current=19.341743288217586 new_mae=19.96146920612925
current=19.341743288217586 new_mae=21.760044037455007
current=19.341743288217586 new_mae=27.112995883709814
current=19.341743288217586 new_mae=29.671107757202602
current=19.341743288217586 new_mae=25.982396541898638
current=19.341743288217586 new_mae=28.271806790405684
current=19.341743288217586 new_mae=22.103689666401277
current=19.341743288217586 new_mae=20.483174976113578
current=19.341743288217586 new_mae=31.301925489843036
current=19.341743288217586 new_mae=26.319157950019154
current=19.341743288217586 new_mae=19.36327053171311
current=19.341743288217586 new_mae=21.625410954248846
current=19.341743288217586 new_mae=32.72296823534935
current=19.341743288217586 new_mae=28.574102387944194
current=19.341743288217586 new_mae=27.35949414432781
current=19.341743288217586 new_mae=19.45041937730673
current=19.341743288217586 new_mae=24.245825179924395
current=19.341743288217586 new_mae=19.722657678142497
current=19.341743288217586 new_mae=24.462974578726328
current=19.341743288217586 new_mae=20.39798153993865
current=19.341743288217586 new_mae=21.357272399872983
current=19.341743288217586 new_mae=20.49136547077091
current=19.341743288217586 new_mae=19.35049757973823
current=19.341743288217586 new_mae=20.269711115159403
current=19.341743288217586 new_mae=19.42307491705253
current=19.341743288217586 new_mae=24.76813384360962
current=19.341743288217586 new_mae=22.845356888334404
current=19.341743288217586 new_mae=21.138943205341363
current=19.341743288217586 new_mae=35.64957220502002
current=19.341743288217586 new_mae=28.677935290449845
current=19.341743288217586 new_mae=32.634277236155754
current=19.341743288217586 new_mae=36.20374424281395
current=19.341743288217586 new_mae=23.28730028881532
current=19.341743288217586 new_mae=26.352519116359034
current=19.341743288217586 new_mae=19.448323382858703
current=19.341743288217586 new_mae=26.732049401594058
current=19.341743288217586 new_mae=22.704625784027115
current=19.341743288217586 new_mae=28.50314047087067
current=19.341743288217586 new_mae=24.404399039505268
current=19.341743288217586 new_mae=24.073947751653254
current=19.341743288217586 new_mae=24.900335015957893
current=19.341743288217586 new_mae=20.82186294535601
current=19.341743288217586 new_mae=42.80586418574606
current=19.341743288217586 new_mae=26.205945090694893
current=19.341743288217586 new_mae=34.71300605872144
current=19.341743288217586 new_mae=19.54071813714954
current=19.341743288217586 new_mae=21.224822076026005
current=19.341743288217586 new_mae=40.05749179934097
current=19.341743288217586 new_mae=24.493073154276495
current=19.341743288217586 new_mae=19.474873784864066
current=19.341743288217586 new_mae=27.759781988396632
current=19.341743288217586 new_mae=22.091201310723374
current=19.341743288217586 new_mae=19.421021492547155
current=19.341743288217586 new_mae=30.038886523440784
current=19.341743288217586 new_mae=41.11607168121404
current=19.341743288217586 new_mae=22.65409155289068
current=19.341743288217586 new_mae=24.007987902948507
current=19.341743288217586 new_mae=42.89449158123796
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.341743288217586 new_mae=32.354503385810126
current=19.341743288217586 new_mae=37.908148614129125
current=19.341743288217586 new_mae=28.495239616667885
current=19.341743288217586 new_mae=33.1118951680284
current=19.341743288217586 new_mae=20.49292376420832
current=19.341743288217586 new_mae=19.387088058310848
current=19.341743288217586 new_mae=27.0949731223304
current=19.341743288217586 new_mae=39.00215775335526
current=19.341743288217586 new_mae=36.270357475408865
current=19.341743288217586 new_mae=25.63477608337455
current=19.341743288217586 new_mae=38.17094998233415
current=19.341743288217586 new_mae=29.636481377651084
current=19.341743288217586 new_mae=19.37920772345822
current=19.341743288217586 new_mae=19.367076347343076
current=19.341743288217586 new_mae=32.78722774230442
current=19.341743288217586 new_mae=21.990353824922398
current=19.341743288217586 new_mae=29.594096483447487
current=19.341743288217586 new_mae=23.504135902691694
current=19.341743288217586 new_mae=25.951460795470837
current=19.341743288217586 new_mae=25.69612161132809
current=19.341743288217586 new_mae=30.357756160127664
current=19.341743288217586 new_mae=35.93926269833957
current=19.341743288217586 new_mae=24.565056662048605
current=19.341743288217586 new_mae=27.288393900065174
current=19.341743288217586 new_mae=19.324575352682928
slope=3.5860251222443225 intercept=-75.70953667038809 current=19.324575352682928
current=19.324575352682928 new_mae=25.749979024110463
current=19.324575352682928 new_mae=19.305700411063597
slope=3.6893356362465797 intercept=-85.26834106562588 current=19.305700411063597
current=19.305700411063597 new_mae=46.80421704607548
current=19.305700411063597 new_mae=21.085119478146463
current=19.305700411063597 new_mae=29.70440099687258
current=19.305700411063597 new_mae=28.669628657357446
current=19.305700411063597 new_mae=32.08343004340466
current=19.305700411063597 new_mae=25.15408894155508
current=19.305700411063597 new_mae=23.194897654408788
current=19.305700411063597 new_mae=25.63514775233366
current=19.305700411063597 new_mae=33.84488648166142
current=19.305700411063597 new_mae=20.02889472595827
current=19.305700411063597 new_mae=39.355732013701385
current=19.305700411063597 new_mae=35.37459386360287
current=19.305700411063597 new_mae=36.25906455206229
current=19.305700411063597 new_mae=23.77134316557366
current=19.305700411063597 new_mae=36.35243170990258
current=19.305700411063597 new_mae=30.543340542081044
current=19.305700411063597 new_mae=20.574429587095583
current=19.305700411063597 new_mae=22.33936038486563
current=19.305700411063597 new_mae=24.43545184181961
current=19.305700411063597 new_mae=44.234877017307795
current=19.305700411063597 new_mae=31.81845610637399
current=19.305700411063597 new_mae=23.666648293304736
current=19.305700411063597 new_mae=24.060975492108078
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.305700411063597 new_mae=25.73658948665392
current=19.305700411063597 new_mae=23.89205172058775
current=19.305700411063597 new_mae=19.405648852752133
current=19.305700411063597 new_mae=21.6740265215454
current=19.305700411063597 new_mae=19.30121890600276
slope=3.782653520116266 intercept=-88.33166994818717 current=19.30121890600276
current=19.30121890600276 new_mae=25.309131202215568
current=19.30121890600276 new_mae=25.63590371280934
current=19.30121890600276 new_mae=33.659225966198214
current=19.30121890600276 new_mae=32.635427170026354
current=19.30121890600276 new_mae=21.81080508019417
current=19.30121890600276 new_mae=38.7784113400666
current=19.30121890600276 new_mae=23.11750006067556
current=19.30121890600276 new_mae=19.30786074179199
current=19.30121890600276 new_mae=20.643692140976086
current=19.30121890600276 new_mae=19.63166724328498
current=19.30121890600276 new_mae=23.9121441428347
current=19.30121890600276 new_mae=29.388212764278627
current=19.30121890600276 new_mae=22.09645376146949
current=19.30121890600276 new_mae=29.582631580386213
current=19.30121890600276 new_mae=27.05794560009429
current=19.30121890600276 new_mae=20.749691094221546
current=19.30121890600276 new_mae=24.803519155177085
current=19.30121890600276 new_mae=25.278366776716705
current=19.30121890600276 new_mae=19.303009316876064
current=19.30121890600276 new_mae=27.650301524078813
current=19.30121890600276 new_mae=24.984346781615788
current=19.30121890600276 new_mae=22.609790673199512
current=19.30121890600276 new_mae=19.349548003118787
current=19.30121890600276 new_mae=20.136318791610606
current=19.30121890600276 new_mae=35.60545538197073
current=19.30121890600276 new_mae=22.671002467696255
current=19.30121890600276 new_mae=26.018083669385835
current=19.30121890600276 new_mae=19.59132859980366
current=19.30121890600276 new_mae=28.33002445817962
current=19.30121890600276 new_mae=19.46381113605482
current=19.30121890600276 new_mae=19.224626048800594
slope=3.803092080245446 intercept=-91.50351220605783 current=19.224626048800594
current=19.224626048800594 new_mae=31.66782832354699
current=19.224626048800594 new_mae=19.265415346293963
current=19.224626048800594 new_mae=27.200577731148805
current=19.224626048800594 new_mae=20.376749576808855
current=19.224626048800594 new_mae=36.10689553839515
current=19.224626048800594 new_mae=21.50715029561911
current=19.224626048800594 new_mae=20.26327828159443
current=19.224626048800594 new_mae=26.21659516509545
current=19.224626048800594 new_mae=26.17053463814113
current=19.224626048800594 new_mae=23.822594646141233
current=19.224626048800594 new_mae=35.709733342852154
current=19.224626048800594 new_mae=25.128967784244345
current=19.224626048800594 new_mae=19.300587637579724
current=19.224626048800594 new_mae=31.17678535826643
current=19.224626048800594 new_mae=26.445937519676033
current=19.224626048800594 new_mae=19.268644995663646
current=19.224626048800594 new_mae=23.275068619120503
current=19.224626048800594 new_mae=24.420014919008395
current=19.224626048800594 new_mae=26.274635882969044
current=19.224626048800594 new_mae=33.970613768799794
current=19.224626048800594 new_mae=19.19189091786179
slope=3.908759478534604 intercept=-99.84675060487943 current=19.19189091786179
current=19.19189091786179 new_mae=21.38635265862019
current=19.19189091786179 new_mae=19.204010029422736
current=19.19189091786179 new_mae=19.509367624361776
current=19.19189091786179 new_mae=19.271773459322905
current=19.19189091786179 new_mae=19.7917396520111
current=19.19189091786179 new_mae=19.22969811051647
current=19.19189091786179 new_mae=24.03073337685973
current=19.19189091786179 new_mae=24.303865318637826
current=19.19189091786179 new_mae=29.39762154169643
current=19.19189091786179 new_mae=24.13627203780241
current=19.19189091786179 new_mae=20.67531377660063
current=19.19189091786179 new_mae=19.368402113992456
current=19.19189091786179 new_mae=37.77047737273434
current=19.19189091786179 new_mae=33.230740285487876
current=19.19189091786179 new_mae=21.209940568066152
current=19.19189091786179 new_mae=26.375300513164806
current=19.19189091786179 new_mae=19.80146010126511
current=19.19189091786179 new_mae=20.667894544412533
current=19.19189091786179 new_mae=22.005209884233953
current=19.19189091786179 new_mae=27.588507656827485
current=19.19189091786179 new_mae=32.16340008921928
current=19.19189091786179 new_mae=40.56189591852729
current=19.19189091786179 new_mae=35.966368081670474
current=19.19189091786179 new_mae=25.817413014081747
current=19.19189091786179 new_mae=20.69929471392502
current=19.19189091786179 new_mae=33.46482472217793
current=19.19189091786179 new_mae=21.057192940830994
current=19.19189091786179 new_mae=20.523819462474943
current=19.19189091786179 new_mae=31.60512395851892
current=19.19189091786179 new_mae=19.205851101893956
current=19.19189091786179 new_mae=21.071524589723957
current=19.19189091786179 new_mae=28.56297351392929
current=19.19189091786179 new_mae=19.162100238557212
slope=4.023312197898147 intercept=-108.19596242997595 current=19.162100238557212
current=19.162100238557212 new_mae=25.665139220901725
current=19.162100238557212 new_mae=19.291688370243197
current=19.162100238557212 new_mae=33.30390259934269
current=19.162100238557212 new_mae=21.173288431465796
current=19.162100238557212 new_mae=24.225094359459302
current=19.162100238557212 new_mae=19.497628396245563
current=19.162100238557212 new_mae=22.948711424317963
current=19.162100238557212 new_mae=42.699480114999744
current=19.162100238557212 new_mae=27.818358940721435
current=19.162100238557212 new_mae=23.07651723128369
current=19.162100238557212 new_mae=20.22917499497148
current=19.162100238557212 new_mae=19.557562074359932
current=19.162100238557212 new_mae=26.98414099462467
current=19.162100238557212 new_mae=31.205522769210248
current=19.162100238557212 new_mae=32.102469077815535
current=19.162100238557212 new_mae=31.962133980312018
current=19.162100238557212 new_mae=19.47867876675457
current=19.162100238557212 new_mae=26.871717210839304
current=19.162100238557212 new_mae=31.68870442364284
current=19.162100238557212 new_mae=20.510221363517385
current=19.162100238557212 new_mae=19.65090430939039
current=19.162100238557212 new_mae=27.400642551103395
current=19.162100238557212 new_mae=32.28860154091639
current=19.162100238557212 new_mae=28.097914946389828
current=19.162100238557212 new_mae=24.476692712156034
current=19.162100238557212 new_mae=19.56424277567848
current=19.162100238557212 new_mae=19.09827559218845
slope=4.147680758337359 intercept=-115.7819627856919 current=19.09827559218845
current=19.09827559218845 new_mae=21.431831498758136
current=19.09827559218845 new_mae=32.087665594660415
current=19.09827559218845 new_mae=19.976507285123475
current=19.09827559218845 new_mae=20.84758892188135
current=19.09827559218845 new_mae=24.981261738567934
current=19.09827559218845 new_mae=37.49824696294481
current=19.09827559218845 new_mae=38.30090773866322
current=19.09827559218845 new_mae=24.692920987129256
current=19.09827559218845 new_mae=22.512693991417105
current=19.09827559218845 new_mae=25.82238143199619
current=19.09827559218845 new_mae=22.3138939601185
current=19.09827559218845 new_mae=25.883556939314225
current=19.09827559218845 new_mae=31.888010489989327
current=19.09827559218845 new_mae=28.06523315346594
current=19.09827559218845 new_mae=23.461813030473582
current=19.09827559218845 new_mae=32.51178213730943
current=19.09827559218845 new_mae=24.039487718052055
current=19.09827559218845 new_mae=20.046099693382494
current=19.09827559218845 new_mae=32.14030455184785
current=19.09827559218845 new_mae=19.168670269753413
current=19.09827559218845 new_mae=34.13126396358459
current=19.09827559218845 new_mae=22.41416610066119
current=19.09827559218845 new_mae=31.392083204350566
current=19.09827559218845 new_mae=33.169310081375706
current=19.09827559218845 new_mae=22.58681359762649
current=19.09827559218845 new_mae=21.321972078836158
current=19.09827559218845 new_mae=23.182651932846493
current=19.09827559218845 new_mae=25.855356749868463
current=19.09827559218845 new_mae=26.06489342107905
current=19.09827559218845 new_mae=24.03186108295113
current=19.09827559218845 new_mae=25.77710936586557
current=19.09827559218845 new_mae=37.94603505026715
current=19.09827559218845 new_mae=20.426388114922997
current=19.09827559218845 new_mae=30.9326991007022
current=19.09827559218845 new_mae=31.24127664299996
current=19.09827559218845 new_mae=28.798505052193576
current=19.09827559218845 new_mae=33.121172819798986
current=19.09827559218845 new_mae=22.943010917198887
current=19.09827559218845 new_mae=20.48417233753046
current=19.09827559218845 new_mae=19.326507994854786
current=19.09827559218845 new_mae=26.513870284608874
current=19.09827559218845 new_mae=35.53450675687406
current=19.09827559218845 new_mae=19.170500350623914
current=19.09827559218845 new_mae=27.8005488315903
current=19.09827559218845 new_mae=19.789528092940575
current=19.09827559218845 new_mae=19.2224894835638
current=19.09827559218845 new_mae=20.3288294325465
current=19.09827559218845 new_mae=23.9258787201974
current=19.09827559218845 new_mae=32.325902271898045
current=19.09827559218845 new_mae=24.918561941680128
current=19.09827559218845 new_mae=27.883405636545998
current=19.09827559218845 new_mae=19.432740234959272
current=19.09827559218845 new_mae=24.822868117633597
current=19.09827559218845 new_mae=20.5443691649539
current=19.09827559218845 new_mae=30.656494555729925
current=19.09827559218845 new_mae=27.636787738753483
current=19.09827559218845 new_mae=32.314529726243265
current=19.09827559218845 new_mae=19.145522511346595
current=19.09827559218845 new_mae=20.16438315046211
current=19.09827559218845 new_mae=19.167650288799713
current=19.09827559218845 new_mae=19.226771263311818
current=19.09827559218845 new_mae=19.214860983155432
current=19.09827559218845 new_mae=20.828718014738435
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.09827559218845 new_mae=19.308759802771707
current=19.09827559218845 new_mae=21.664977571842925
current=19.09827559218845 new_mae=22.252668335221074
current=19.09827559218845 new_mae=33.262212781974505
current=19.09827559218845 new_mae=30.173403862348604
current=19.09827559218845 new_mae=27.048752021457226
current=19.09827559218845 new_mae=20.389495445571825
current=19.09827559218845 new_mae=19.116322355810865
current=19.09827559218845 new_mae=21.96397559307838
current=19.09827559218845 new_mae=31.600957331452523
current=19.09827559218845 new_mae=19.511457432715407
current=19.09827559218845 new_mae=33.76875942216346
current=19.09827559218845 new_mae=25.548632605630836
current=19.09827559218845 new_mae=21.509067294882033
current=19.09827559218845 new_mae=34.75157133849037
current=19.09827559218845 new_mae=19.221959934185378
current=19.09827559218845 new_mae=22.70246074267491
current=19.09827559218845 new_mae=23.034922913100157
current=19.09827559218845 new_mae=45.66378667963683
current=19.09827559218845 new_mae=41.54560345881236
current=19.09827559218845 new_mae=22.885954606454902
current=19.09827559218845 new_mae=29.475874035489003
current=19.09827559218845 new_mae=44.39220853348544
current=19.09827559218845 new_mae=29.087881111574635
current=19.09827559218845 new_mae=33.69975170390712
current=19.09827559218845 new_mae=19.22825538954955
current=19.09827559218845 new_mae=21.23689819906632
current=19.09827559218845 new_mae=22.117844753498265
current=19.09827559218845 new_mae=19.092704416769738
slope=4.239585669027296 intercept=-121.40980409655644 current=19.092704416769738
current=19.092704416769738 new_mae=35.21882894868124
current=19.092704416769738 new_mae=19.596991180501796
current=19.092704416769738 new_mae=19.09709316351907
current=19.092704416769738 new_mae=19.95812992792
current=19.092704416769738 new_mae=25.625752398347863
current=19.092704416769738 new_mae=21.52920653278979
current=19.092704416769738 new_mae=19.51513191881084
current=19.092704416769738 new_mae=19.166846454786448
current=19.092704416769738 new_mae=30.674008573618654
current=19.092704416769738 new_mae=34.854904044127565
current=19.092704416769738 new_mae=19.05385278902808
slope=4.319343300196261 intercept=-128.44171473347126 current=19.05385278902808
current=19.05385278902808 new_mae=20.73996723784366
current=19.05385278902808 new_mae=27.68276770140738
current=19.05385278902808 new_mae=28.800899726298926
current=19.05385278902808 new_mae=35.71273589292212
current=19.05385278902808 new_mae=21.078487461111795
current=19.05385278902808 new_mae=30.748473223554097
current=19.05385278902808 new_mae=29.40698177480281
current=19.05385278902808 new_mae=19.186442788103875
current=19.05385278902808 new_mae=25.38619283742516
current=19.05385278902808 new_mae=21.450573199899278
current=19.05385278902808 new_mae=19.209234569835594
current=19.05385278902808 new_mae=28.54979093990768
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.05385278902808 new_mae=19.819544498011307
current=19.05385278902808 new_mae=22.417678331055765
current=19.05385278902808 new_mae=23.92297785719036
current=19.05385278902808 new_mae=19.47938110203024
current=19.05385278902808 new_mae=34.42871232686177
current=19.05385278902808 new_mae=24.301241161803535
current=19.05385278902808 new_mae=21.96968398525936
current=19.05385278902808 new_mae=30.05461398241174
current=19.05385278902808 new_mae=23.020510064353335
current=19.05385278902808 new_mae=19.967759296947868
current=19.05385278902808 new_mae=21.305722278072874
current=19.05385278902808 new_mae=19.553772089785156
current=19.05385278902808 new_mae=19.152648726936746
current=19.05385278902808 new_mae=27.138938459916485
current=19.05385278902808 new_mae=27.795188616678757
current=19.05385278902808 new_mae=40.109659693258436
current=19.05385278902808 new_mae=30.31788376027232
current=19.05385278902808 new_mae=23.007587283329666
current=19.05385278902808 new_mae=30.779610790159158
current=19.05385278902808 new_mae=35.28730803549117
current=19.05385278902808 new_mae=21.405000449105387
current=19.05385278902808 new_mae=33.13349517475566
current=19.05385278902808 new_mae=19.33416269165729
current=19.05385278902808 new_mae=42.874939398282
current=19.05385278902808 new_mae=21.50513518122718
current=19.05385278902808 new_mae=25.4992703316631
current=19.05385278902808 new_mae=19.045246398530523
slope=4.371907036820689 intercept=-131.00939418526258 current=19.045246398530523
current=19.045246398530523 new_mae=19.035776852736674
slope=4.469863644609491 intercept=-137.53031548605583 current=19.035776852736674
current=19.035776852736674 new_mae=23.10618041457437
current=19.035776852736674 new_mae=44.89362775362574
current=19.035776852736674 new_mae=32.260219564918636
current=19.035776852736674 new_mae=30.643064486259473
current=19.035776852736674 new_mae=37.546192683320086
current=19.035776852736674 new_mae=26.591062899813355
current=19.035776852736674 new_mae=19.37913561129039
current=19.035776852736674 new_mae=22.978282828009426
current=19.035776852736674 new_mae=23.016413289834723
current=19.035776852736674 new_mae=30.023648685008787
current=19.035776852736674 new_mae=39.19485140995808
current=19.035776852736674 new_mae=32.89778243967031
current=19.035776852736674 new_mae=24.06134233878302
current=19.035776852736674 new_mae=20.08436509178622
current=19.035776852736674 new_mae=26.101018351659036
current=19.035776852736674 new_mae=23.069087747784373
current=19.035776852736674 new_mae=20.24500141455708
current=19.035776852736674 new_mae=22.292643548124925
current=19.035776852736674 new_mae=19.24764949781461
current=19.035776852736674 new_mae=44.03173028512407
current=19.035776852736674 new_mae=24.74884985152963
current=19.035776852736674 new_mae=38.29877866008958
current=19.035776852736674 new_mae=21.81373002535664
current=19.035776852736674 new_mae=27.880699259443592
current=19.035776852736674 new_mae=21.96292551251909
current=19.035776852736674 new_mae=34.85965297529993
current=19.035776852736674 new_mae=31.60320173787977
current=19.035776852736674 new_mae=19.00782938424947
slope=4.478117809241985 intercept=-139.2095495526936 current=19.00782938424947
current=19.00782938424947 new_mae=21.89505148251252
current=19.00782938424947 new_mae=19.141106311209143
current=19.00782938424947 new_mae=29.31418037386078
current=19.00782938424947 new_mae=27.278811325666037
current=19.00782938424947 new_mae=19.049864889282528
current=19.00782938424947 new_mae=25.51468842313217
current=19.00782938424947 new_mae=28.259204986194487
current=19.00782938424947 new_mae=27.904555711173547
current=19.00782938424947 new_mae=27.647275239476276
current=19.00782938424947 new_mae=24.602762184687833
current=19.00782938424947 new_mae=40.290204979592986
current=19.00782938424947 new_mae=26.05231890470792
current=19.00782938424947 new_mae=30.000892937914244
current=19.00782938424947 new_mae=33.42798603038305
current=19.00782938424947 new_mae=41.7295298321819
current=19.00782938424947 new_mae=26.138216796920055
current=19.00782938424947 new_mae=21.78843965663069
current=19.00782938424947 new_mae=28.200634372237136
current=19.00782938424947 new_mae=20.318403531536887
current=19.00782938424947 new_mae=44.14778840267295
current=19.00782938424947 new_mae=21.291252874733154
current=19.00782938424947 new_mae=19.82513676496717
current=19.00782938424947 new_mae=19.433967240396257
current=19.00782938424947 new_mae=19.489963617900376
current=19.00782938424947 new_mae=27.73774121265643
current=19.00782938424947 new_mae=30.02586963507541
current=19.00782938424947 new_mae=43.970990617698206
current=19.00782938424947 new_mae=20.19336616201576
current=19.00782938424947 new_mae=19.092722904423624
current=19.00782938424947 new_mae=20.424083602821696
current=19.00782938424947 new_mae=22.264840021709574
current=19.00782938424947 new_mae=20.987192142835084
current=19.00782938424947 new_mae=21.536333715216998
current=19.00782938424947 new_mae=20.30472626606736
current=19.00782938424947 new_mae=20.32404766357582
current=19.00782938424947 new_mae=28.44782778805284
current=19.00782938424947 new_mae=28.15398950601412
current=19.00782938424947 new_mae=31.76449926281526
current=19.00782938424947 new_mae=20.510887177165813
current=19.00782938424947 new_mae=39.26684425572406
current=19.00782938424947 new_mae=19.158923472500952
current=19.00782938424947 new_mae=28.640521884091356
current=19.00782938424947 new_mae=41.4959332177664
current=19.00782938424947 new_mae=23.04050170606297
current=19.00782938424947 new_mae=27.166286407455598
current=19.00782938424947 new_mae=19.701022547140585
current=19.00782938424947 new_mae=24.281150584369456
current=19.00782938424947 new_mae=34.91080611078948
current=19.00782938424947 new_mae=26.799277240776803
current=19.00782938424947 new_mae=20.763312315292655
current=19.00782938424947 new_mae=19.038863854630076
current=19.00782938424947 new_mae=20.581365484829554
current=19.00782938424947 new_mae=33.952566574748985
current=19.00782938424947 new_mae=46.64989163575239
current=19.00782938424947 new_mae=19.66557727546772
current=19.00782938424947 new_mae=18.994348158807306
slope=4.577564384691985 intercept=-146.69415804102098 current=18.994348158807306
current=18.994348158807306 new_mae=19.50492695487058
current=18.994348158807306 new_mae=19.86742873625129
current=18.994348158807306 new_mae=40.90941224872421
current=18.994348158807306 new_mae=22.99901017127219
current=18.994348158807306 new_mae=20.614602297240115
current=18.994348158807306 new_mae=21.00524142449039
current=18.994348158807306 new_mae=34.52064117577275
current=18.994348158807306 new_mae=20.792277285702472
current=18.994348158807306 new_mae=21.924020869261124
current=18.994348158807306 new_mae=29.04951766536215
current=18.994348158807306 new_mae=21.615830946686458
current=18.994348158807306 new_mae=25.39220266626272
current=18.994348158807306 new_mae=37.41695993143964
current=18.994348158807306 new_mae=24.13613234807835
current=18.994348158807306 new_mae=21.03609316039363
current=18.994348158807306 new_mae=24.154669714069385
current=18.994348158807306 new_mae=19.39424485283199
current=18.994348158807306 new_mae=24.813965187337597
current=18.994348158807306 new_mae=19.451171679106064
current=18.994348158807306 new_mae=32.10481126174731
current=18.994348158807306 new_mae=19.442546789930844
current=18.994348158807306 new_mae=23.37360955943047
current=18.994348158807306 new_mae=35.18321938817541
current=18.994348158807306 new_mae=18.975813095999875
slope=4.631577762044764 intercept=-150.1451961589792 current=18.975813095999875
current=18.975813095999875 new_mae=22.914946750878343
current=18.975813095999875 new_mae=31.471113488729504
current=18.975813095999875 new_mae=26.336803707251637
current=18.975813095999875 new_mae=33.29799447660731
current=18.975813095999875 new_mae=32.23782040529321
current=18.975813095999875 new_mae=24.674070344022105
current=18.975813095999875 new_mae=21.30624820603085
current=18.975813095999875 new_mae=33.488054541024745
current=18.975813095999875 new_mae=19.50966723938948
current=18.975813095999875 new_mae=19.023301388637968
current=18.975813095999875 new_mae=26.997167024351604
current=18.975813095999875 new_mae=19.080467238836523
current=18.975813095999875 new_mae=19.603813654049706
current=18.975813095999875 new_mae=21.929268465975422
current=18.975813095999875 new_mae=20.347241429692396
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=18.975813095999875 new_mae=19.128371446304534
current=18.975813095999875 new_mae=21.579961494720898
current=18.975813095999875 new_mae=20.968989340596043
current=18.975813095999875 new_mae=29.19749986653881
current=18.975813095999875 new_mae=19.052991670337196
current=18.975813095999875 new_mae=37.85116842501936
current=18.975813095999875 new_mae=20.524875705183742
current=18.975813095999875 new_mae=20.97972575746124
current=18.975813095999875 new_mae=35.0998151621079
current=18.975813095999875 new_mae=19.21737231029427
current=18.975813095999875 new_mae=20.548770457914788
current=18.975813095999875 new_mae=28.40472742096636
current=18.975813095999875 new_mae=37.649808283484546
current=18.975813095999875 new_mae=27.10820305031848
current=18.975813095999875 new_mae=25.472223643558703
current=18.975813095999875 new_mae=34.84513595101389
current=18.975813095999875 new_mae=26.891936875796915
current=18.975813095999875 new_mae=30.74732243940974
current=18.975813095999875 new_mae=26.227720635497832
current=18.975813095999875 new_mae=27.39417908014753
current=18.975813095999875 new_mae=24.58485575030455
current=18.975813095999875 new_mae=18.963854847183352
slope=4.689682956476396 intercept=-153.61583300067025 current=18.963854847183352
current=18.963854847183352 new_mae=20.02624453797282
current=18.963854847183352 new_mae=25.77215338446957
current=18.963854847183352 new_mae=22.549093215155796
current=18.963854847183352 new_mae=33.993036295289414
current=18.963854847183352 new_mae=38.30348368958786
current=18.963854847183352 new_mae=20.835010415615645
current=18.963854847183352 new_mae=19.101429558808164
current=18.963854847183352 new_mae=31.477742725126923
current=18.963854847183352 new_mae=21.013519142623654
current=18.963854847183352 new_mae=19.055574388704667
current=18.963854847183352 new_mae=24.769952624154907
current=18.963854847183352 new_mae=19.07338260599016
current=18.963854847183352 new_mae=36.510096739627485
current=18.963854847183352 new_mae=40.12575284478547
current=18.963854847183352 new_mae=23.094739022327563
current=18.963854847183352 new_mae=33.793745386240715
current=18.963854847183352 new_mae=21.46342707330536
current=18.963854847183352 new_mae=28.992721496828732
current=18.963854847183352 new_mae=18.957505823336355
slope=4.735709213851861 intercept=-157.56710036101913 current=18.957505823336355
current=18.957505823336355 new_mae=19.051157200085182
current=18.957505823336355 new_mae=27.24403993972487
current=18.957505823336355 new_mae=24.379381314535678
current=18.957505823336355 new_mae=19.299328595524514
current=18.957505823336355 new_mae=22.03826180086073
current=18.957505823336355 new_mae=19.069246839167246
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=18.957505823336355 new_mae=18.93048388247896
slope=4.883951198803605 intercept=-166.79159566813158 current=18.93048388247896
current=18.93048388247896 new_mae=19.975575189819004
current=18.93048388247896 new_mae=19.160595832953675
current=18.93048388247896 new_mae=19.183781014901957
current=18.93048388247896 new_mae=22.38424796548237
current=18.93048388247896 new_mae=22.077646410161613
current=18.93048388247896 new_mae=18.96498720264209
current=18.93048388247896 new_mae=21.447043896384596
current=18.93048388247896 new_mae=19.04081116347159
current=18.93048388247896 new_mae=37.194219217947435
current=18.93048388247896 new_mae=25.249644543879924
current=18.93048388247896 new_mae=26.64912535796309
current=18.93048388247896 new_mae=20.03972044500337
current=18.93048388247896 new_mae=35.14964832483315
current=18.93048388247896 new_mae=25.05396780436583
current=18.93048388247896 new_mae=19.309229720996342
current=18.93048388247896 new_mae=20.37171886373325
current=18.93048388247896 new_mae=36.13742007114964
current=18.93048388247896 new_mae=18.957773236622526
current=18.93048388247896 new_mae=29.97901291878268
current=18.93048388247896 new_mae=19.000290220973607
current=18.93048388247896 new_mae=25.569252266795914
current=18.93048388247896 new_mae=43.864856179105686
current=18.93048388247896 new_mae=38.43776855680023
current=18.93048388247896 new_mae=20.01648804347339
current=18.93048388247896 new_mae=39.29286672412154
current=18.93048388247896 new_mae=20.121046702158896
current=18.93048388247896 new_mae=25.659053829781406
current=18.93048388247896 new_mae=20.598434237840692
current=18.93048388247896 new_mae=26.02464010945407
current=18.93048388247896 new_mae=18.953627674797005
current=18.93048388247896 new_mae=20.023302930400543
current=18.93048388247896 new_mae=24.454119979668697
current=18.93048388247896 new_mae=19.09214932235543
current=18.93048388247896 new_mae=30.700684088477164
current=18.93048388247896 new_mae=39.412135620644875
current=18.93048388247896 new_mae=31.23494660471426
current=18.93048388247896 new_mae=24.713991965105127
current=18.93048388247896 new_mae=24.412874022260716
current=18.93048388247896 new_mae=36.108549565153616
current=18.93048388247896 new_mae=30.31511433674804
current=18.93048388247896 new_mae=19.044681217637127
current=18.93048388247896 new_mae=26.710585904744715
current=18.93048388247896 new_mae=19.400033254090815
current=18.93048388247896 new_mae=20.596274841298545
current=18.93048388247896 new_mae=27.82295029716802
current=18.93048388247896 new_mae=25.173386170971227
current=18.93048388247896 new_mae=24.58889739855047
current=18.93048388247896 new_mae=33.406549538693646
current=18.93048388247896 new_mae=20.46741527449613
current=18.93048388247896 new_mae=21.799027049008956
current=18.93048388247896 new_mae=19.522318088030378
current=18.93048388247896 new_mae=20.421210600873692
current=18.93048388247896 new_mae=28.153242039891644
current=18.93048388247896 new_mae=31.39464405772079
current=18.93048388247896 new_mae=23.645969580259273
current=18.93048388247896 new_mae=25.408386008088392
current=18.93048388247896 new_mae=27.283355957631247
current=18.93048388247896 new_mae=22.87540989166697
current=18.93048388247896 new_mae=37.180775892505494
current=18.93048388247896 new_mae=24.637671342718576
current=18.93048388247896 new_mae=27.58830227886108
current=18.93048388247896 new_mae=20.664088315567053
current=18.93048388247896 new_mae=24.089095558799432
current=18.93048388247896 new_mae=28.570850319778256
current=18.93048388247896 new_mae=28.968499982343303
current=18.93048388247896 new_mae=18.986258955148866
current=18.93048388247896 new_mae=30.126050293950897
current=18.93048388247896 new_mae=18.943026899338193
current=18.93048388247896 new_mae=22.752566350978743
current=18.93048388247896 new_mae=22.629968775742864
current=18.93048388247896 new_mae=22.681660592342656
current=18.93048388247896 new_mae=23.894110482155366
current=18.93048388247896 new_mae=21.532289848530244
current=18.93048388247896 new_mae=20.058099661447127
current=18.93048388247896 new_mae=36.31181137582655
current=18.93048388247896 new_mae=18.93215920885748
current=18.93048388247896 new_mae=22.79956242238816
current=18.93048388247896 new_mae=35.14400629074164
current=18.93048388247896 new_mae=32.50041818383504
current=18.93048388247896 new_mae=29.594070727884294
current=18.93048388247896 new_mae=20.747586872160127
current=18.93048388247896 new_mae=19.127572525917227
current=18.93048388247896 new_mae=43.05310197085521
current=18.93048388247896 new_mae=20.027377312612792
current=18.93048388247896 new_mae=23.40946412675728
current=18.93048388247896 new_mae=26.07964443530515
current=18.93048388247896 new_mae=25.69031482044064
current=18.93048388247896 new_mae=18.949835756689875
current=18.93048388247896 new_mae=21.492800831927315
current=18.93048388247896 new_mae=34.9693427686237
current=18.93048388247896 new_mae=21.57145479615338
current=18.93048388247896 new_mae=38.82104837867117
current=18.93048388247896 new_mae=23.96511513776747
current=18.93048388247896 new_mae=28.82606210702451
current=18.93048388247896 new_mae=25.232420515238704
current=18.93048388247896 new_mae=26.988984870792994
current=18.93048388247896 new_mae=37.4896320695847
current=18.93048388247896 new_mae=20.302904188704005
current=18.93048388247896 new_mae=37.48676305865289
current=18.93048388247896 new_mae=21.8223016655424
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.21441425838384554
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>model is some function that usually takes parameters and predicts data.</p>
<p>parameters are free to vary, structure of the model is set in stone</p>
<p>we can evaluate model predictions via a loss function, and smaller loss is better.</p>
<p>We find parameters that minimize the loss function.  this amounts to “fitting” the model.</p>
<p>this is done via some kind of optimization algorithm.</p>
<div class="section" id="gradient-descent">
<h3>Gradient descent<a class="headerlink" href="#gradient-descent" title="Permalink to this headline">¶</a></h3>
<p>Start with some parameter values.  Figure out which direction of change in parameter values reduces the loss.  Change parameter values in that direction.  Repeat until some criterion is reached.</p>
<p><span class="math notranslate nohighlight">\(L(a,b) = \frac{1}{n} \sum_{i=0}^n (\hat y_i - y_i)^2\)</span></p>
<p><span class="math notranslate nohighlight">\(L(a,b) = \frac{1}{n} \sum_{i=0}^n (a x_i + b - y_i)^2\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{\partial L(a,b)}{\partial a} = \frac{1}{n} \sum_{i=0}^n 2 (a x_i + b - y_i) x_i\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{\partial L(a,b)}{\partial b} = \frac{1}{n} \sum_{i=0}^n 2 (a x_i + b - y_i)\)</span></p>
</div>
</div>
<div class="section" id="writing-our-own-model-class">
<h2>Writing our own model class<a class="headerlink" href="#writing-our-own-model-class" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-kinds-of-operations-should-a-model-support">
<h3>What kinds of operations should a model support?<a class="headerlink" href="#what-kinds-of-operations-should-a-model-support" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>predict data, usually given some input</p></li>
<li><p>evaluate the quality of its predictions given some ground truth observations</p></li>
<li><p>fit its parameters to observed data</p></li>
<li><p>for <em>inferential statistics</em>: compare its fitted parameters to null values, provide confidence intervals on parameters, etc.</p></li>
</ul>
</div>
<div class="section" id="baby-steps">
<h3>Baby steps<a class="headerlink" href="#baby-steps" title="Permalink to this headline">¶</a></h3>
<p><strong>for linear regression</strong></p>
<div class="section" id="predict">
<h4>predict<a class="headerlink" href="#predict" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code>x a 1d numpy array of length <code class="docutils literal notranslate"><span class="pre">n</span></code>, and returns a 1d array of <code class="docutils literal notranslate"><span class="pre">n</span></code> predicted y values, given <code class="docutils literal notranslate"><span class="pre">slope=0.5</span></code>, and <code class="docutils literal notranslate"><span class="pre">intercept=50</span></code></p>
</div>
<div class="section" id="evaluate">
<h4>evaluate<a class="headerlink" href="#evaluate" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> (both arrays of length <code class="docutils literal notranslate"><span class="pre">n</span></code>) and returns the mean squared error of the prediction.</p>
</div>
<div class="section" id="fit">
<h4>fit<a class="headerlink" href="#fit" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> and finds some good values of slope and intercept by minimizing the mean squared error loss function, somehow.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./live"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ed Vul<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>