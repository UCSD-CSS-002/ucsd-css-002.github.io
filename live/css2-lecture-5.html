
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lecture 5: Modeling Data &#8212; UCSD CSS 2</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.5f77b4aec8189eecf79907ce328c390d.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">UCSD CSS 2</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../index.html">
   Welcome to CSS 2
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Course (CSS 2 Spring 2022)
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../course/syllabus.html">
   Syllabus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/expectations.html">
   Expectations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/datahub.html">
   Datahub assignments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/debugging.html">
   Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/resources.html">
   Extracurricular Resources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../course/final.html">
   Final Project
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lectures - download before class
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/sp22/Week1_Overview.html">
   Week 1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_2-pre.html">
     Lecture 2 (3/30/22)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_3-pre.html">
     Lecture 3 (4/1/22)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/sp22/Week2_Overview.html">
   Week 2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_4-pre.html">
     Lecture 4 (4/4/22)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_5-pre.html">
     Lecture 5 (4/6/22)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_6-pre.html">
     Lecture 6 (4/8/22)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/sp22/Week3_Overview.html">
   Week 3
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_7-pre.html">
     Lecture 7 (guest) - Introduction to Data Visualization in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_9-pre.html">
     Lecture 9 (guest) - Data Visualization with Seaborn
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/sp22/Week4_Overview.html">
   Week 4
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_10-pre.html">
     Lecture 10 (4/18/22)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_11-pre.html">
     Lecture 11 (4/20/2022)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_12-pre.html">
     Lecture 12 (4/22/2022)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/sp22/Week5_Overview.html">
   Week 5
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_13-pre.html">
     Lecture 13 (4/25/22)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_14-pre.html">
     Lecture 14 (4/27/2022)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_15-pre.html">
     Lecture 15 (4/29/2022)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/sp22/Week6_Overview.html">
   Week 6
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_16-pre.html">
     Lecture 16 (5/2/2022)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_17-pre.html">
     Lecture 17 (5/4/2022)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_18-pre.html">
     Lecture 18 (5/6/2022)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/sp22/Week7_Overview.html">
   Week 7
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_19-pre.html">
     Lecture 19 (5/9/2022)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_20-pre.html">
     Lecture 20 (5/11/2022)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_21-pre.html">
     Lecture 21 (5/13/2022)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/sp22/Week8_Overview.html">
   Week 8
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_22-pre.html">
     Lecture 22 (5/16/2022)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_23-pre.html">
     Lecture 23 (5/18/2022)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/sp22/Lecture_24-pre.html">
     Lecture 24 (5/20/2022)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Lecture code - available after class
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_2-post.html">
   Lecture 2 (3/30/22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_3-post.html">
   Lecture 3 (4/1/22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_4-post.html">
   Lecture 4 (4/4/22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_5-post.html">
   Lecture 5 (4/6/22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_6-post.html">
   Lecture 6 (4/8/22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_7-post.html">
   Lecture 7 (guest) - Introduction to Data Visualization in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_9-post.html">
   Lecture 9 (guest) Data Visualization with Seaborn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_10-post.html">
   Lecture 10 (4/18/22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_11-post.html">
   Lecture 11 (4/20/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_12-post.html">
   Lecture 12 (4/22/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_13-post.html">
   Lecture 13 (4/25/22)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_14-post.html">
   Lecture 14 (4/27/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_15-post.html">
   Lecture 15 (4/29/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_16-post.html">
   Lecture 16 (5/2/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_17-post.html">
   Lecture 17 (5/4/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_18-post.html">
   Lecture 18 (5/6/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_19-post.html">
   Lecture 19 (5/9/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_20-post.html">
   Lecture 20 (5/11/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_21-post.html">
   Lecture 21 (5/13/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_22-post.html">
   Lecture 22 (5/16/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_23-post.html">
   Lecture 23 (5/18/2022)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lectures/sp22/Lecture_24-post.html">
   Lecture 24 (5/20/2022)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/live/css2-lecture-5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/UCSD-CSS-002/ucsd-css-002.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/UCSD-CSS-002/ucsd-css-002.github.io/issues/new?title=Issue%20on%20page%20%2Flive/css2-lecture-5.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/UCSD-CSS-002/ucsd-css-002.github.io/master?urlpath=tree/live/css2-lecture-5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#this-week">
   This week:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#things-we-do-with-data">
   Things we do with data.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-a-model">
   What is a model?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-parts">
   Model parts.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-structures-and-parameters">
   Model structures and parameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loss-functions">
   Loss functions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-for-regression">
     Loss for Regression
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sum-squared-error">
       Sum squared error
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loss-for-classification">
     Loss for Classification
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimization-algorithm">
   Optimization algorithm
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#grid-search">
     Grid search
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-search">
     Random search
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gradient-descent">
     Gradient descent
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-our-own-model-class">
   Writing our own model class
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-kinds-of-operations-should-a-model-support">
     What kinds of operations should a model support?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#baby-steps">
     Baby steps
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#predict">
       predict
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#evaluate">
       evaluate
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fit">
       fit
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="lecture-5-modeling-data">
<h1>Lecture 5: Modeling Data<a class="headerlink" href="#lecture-5-modeling-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="this-week">
<h2>This week:<a class="headerlink" href="#this-week" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>no problem set, one integrated lab, due at the usual problem set time (monday)</p></li>
<li><p>covering mostly conceptual material, which will serve as the basis of understanding the stuff we do later.</p></li>
</ul>
</div>
<div class="section" id="things-we-do-with-data">
<h2>Things we do with data.<a class="headerlink" href="#things-we-do-with-data" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>describe, summarize, visualize</p></li>
<li><p>infer latent structure, rules, properties, parameters</p></li>
<li><p>generalize to predict, interpolate, extrapolate</p></li>
</ol>
<p>Classical statistics is mostly about #2.  Machine learning is mostly about #3.  Computational Social Science uses tools and models from both.</p>
<p>Both of these rely on fitting models to the data, but the design of the models, and model evaluation differ.</p>
</div>
<div class="section" id="what-is-a-model">
<h2>What is a model?<a class="headerlink" href="#what-is-a-model" title="Permalink to this headline">¶</a></h2>
<p>A model <em>assumes</em> some <strong>structure</strong> of the data, and has some <strong>parameters</strong> that are <em>fit</em> to the data.  The end result is an object that may be used in various ways for data summarization, inference, and prediction.</p>
<p><strong>Examples</strong>: Linear regression, logistic regression, decision tree, neural networks of various architectures, support vector machine, etc.</p>
<p>The structural assumptions constrain what kind of relationships can be captured by the model, but are also necessary to generalize beyond the data.</p>
<p><strong>Even when we simply describe or summarize data, we implicitly have a model in mind.</strong></p>
<p>I have the following data describing the flips of a coin <em><strong>how should I summarize them?</strong></em></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;H&#39;, &#39;H&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;, &#39;H&#39;, &#39;H&#39;, &#39;T&#39;, &#39;T&#39;, &#39;T&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># probability of heads </span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="c1"># if we think the coin might be bent.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3076923076923077
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># coin generated by a process that may be </span>
<span class="c1"># likely to repeat previous outcome</span>

<span class="n">transitions</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">prev</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">prev</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">prev</span> <span class="o">==</span> <span class="n">outcome</span><span class="p">:</span>
            <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;same&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">transitions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;different&#39;</span><span class="p">)</span>
    <span class="n">prev</span> <span class="o">=</span> <span class="n">outcome</span>

<span class="nb">print</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;different&#39;, &#39;same&#39;, &#39;same&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p_same</span> <span class="o">=</span> <span class="n">transitions</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;same&#39;</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">transitions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_same</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.75
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># spin a spinner.  if spinner lands in red then we stop flipping coin.</span>
<span class="c1"># if spinner lands on green, then we flip one more time.</span>
<span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="model-parts">
<h2>Model parts.<a class="headerlink" href="#model-parts" title="Permalink to this headline">¶</a></h2>
<p><strong>Structure:</strong> These are the core assumptions of the model.  Whatever you do in the fitting process, these are not going to change, they are set in stone.</p>
<p>e.g., in linear regression:  <span class="math notranslate nohighlight">\(\hat y = a x + b\)</span></p>
<p>e.g., not <span class="math notranslate nohighlight">\(\hat y = a x^2 + b\)</span></p>
<p><strong>Parameters:</strong> These are the moving parts of the model that are fit to the data.</p>
<p>e.g., in linear regression: <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span></p>
<p><strong>Loss / objective / goodness of fit function:</strong> This is a function that can consider the model and its parameters, and the observed data, and returns a number indicating how well/badly the model fits.  How do I decide whether one value of the parameters is better or worse than another?</p>
<p>e.g., in linear regression: this could be mean squared error, or the likelihood under a normal probability distribution, or the posterior probability of a particular set of parameters, or the mean absolute error, or the quantile error, or… etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f8a05063490&gt;
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_12_1.png" src="../_images/css2-lecture-5_12_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.0579535, 0.1263383])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.4591851 ,  0.28536936,  0.16903958,  0.54076557, -0.30884031,
       -0.29149592,  0.25158507, -0.26120628,  0.011387  , -0.06953232])
</pre></div>
</div>
</div>
</div>
<p><strong>Optimization algorithm:</strong> how do I find the <em>best fitting</em> (loss minimizing, objective maximizing, goodness of fit maximizing) values of the parameters?</p>
<p>e.g., in linear regression, there are various linear algebra tricks available to do so robustly (out of scope here).</p>
</div>
<div class="section" id="model-structures-and-parameters">
<h2>Model structures and parameters<a class="headerlink" href="#model-structures-and-parameters" title="Permalink to this headline">¶</a></h2>
<p>There are <em>many</em>.  We will spend the bulk of class talking about the varieties of model structures that are out there, what they assume, and what they are good at.</p>
</div>
<div class="section" id="loss-functions">
<h2>Loss functions<a class="headerlink" href="#loss-functions" title="Permalink to this headline">¶</a></h2>
<p>There are relatively few, for common problem types.  We will learn the basics of these because they are essential to understanding what models are doing.</p>
<div class="section" id="loss-for-regression">
<h3>Loss for Regression<a class="headerlink" href="#loss-for-regression" title="Permalink to this headline">¶</a></h3>
<p>Regression: predict some number from other data.</p>
<p>Let’s say we want to predict weight.  How do we evaluate how well we have done this?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># our loss function is a single number that </span>
<span class="c1"># tells us how bad our predictions are.</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Errors</strong></p>
<ol class="simple">
<li><p>Ratio error.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">weight</span><span class="o">/</span><span class="n">predicted_weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.        , -0.03077166,  0.        ,  0.87546874,  0.01550419])
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Linear error</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicted_weight</span> <span class="o">-</span> <span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([   0,    5,    0, -140,   -2])
</pre></div>
</div>
</div>
</div>
<p><strong>Summarizing errors</strong></p>
<p>Mean of the squared errors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errors</span> <span class="o">=</span> <span class="n">predicted_weight</span> <span class="o">-</span> <span class="n">weight</span>
<span class="n">errors</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([   0,    5,    0, -140,   -2])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># squared errors</span>
<span class="n">errors</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([    0,    25,     0, 19600,     4])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">errors</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="section" id="sum-squared-error">
<h4>Sum squared error<a class="headerlink" href="#sum-squared-error" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sse</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">])</span>

<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19629
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">180</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">175</span><span class="p">])</span>

<span class="c1"># they increase with number of data points.  </span>
<span class="c1"># because we sum all data point errors squared.</span>
<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19654
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">sse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>

<span class="c1"># sum of squared errors dominated by large errors.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19600
</pre></div>
</div>
</div>
</div>
<p><strong>Mean squared errors</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3920.0
</pre></div>
</div>
</div>
</div>
<p>Aside: standard error of the mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([180, 160, 175, 240, 130])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>177.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16.099689437998485
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">177</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="mi">177</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[145, 209]
</pre></div>
</div>
</div>
</div>
<p>Simple model:</p>
<p><span class="math notranslate nohighlight">\(\hat y = m\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameter / prediction</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># error</span>
<span class="nb">print</span><span class="p">(</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span>
<span class="c1"># squared error</span>
<span class="nb">print</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># sum of squared error</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># mean of squared error</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[  3. -17.  -2.  63. -47.]
[   9.  289.    4. 3969. 2209.]
6480.0
1296.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
<span class="nb">sum</span><span class="p">((</span><span class="n">weight</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1296.0
</pre></div>
</div>
</div>
</div>
<p><strong>Loss function:</strong> is some function of the prediction, and the actual data, that returns one number, which is bigger when our predictions are worse.</p>
<p><strong>Mean squared error</strong></p>
<p><strong>Mean absolute error</strong></p>
<p><strong>not exactly right proportion</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mse</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3920.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mae</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mae</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>28.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_error</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">280</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">mean_error</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">not_exactly_right_proportion</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span>           <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">predicted_weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">180</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>

<span class="n">not_exactly_right_proportion</span><span class="p">(</span><span class="n">predicted_weight</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="loss-for-classification">
<h3>Loss for Classification<a class="headerlink" href="#loss-for-classification" title="Permalink to this headline">¶</a></h3>
<p>Classification: predict a label, (in contrast to a number)</p>
<p>Let’s say we want to predict sex (male/female).  How do we evaluate how well we have done this?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># binary predictions loss functions:</span>

<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>

<span class="n">predicted_y</span> <span class="o">=</span>  <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">inaccuracy</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">predicted_y</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>

<span class="n">predicted_y</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Developing new loss functions is where a lot of the action is for state of the art machine learning, because this is where we specify what it means for a machine to achieve certain intelligent goals.  This is particularly important for RL, and other domains where we don’t actually know what we mean by “intelligent behavior”.</p>
</div>
</div>
<div class="section" id="optimization-algorithm">
<h2>Optimization algorithm<a class="headerlink" href="#optimization-algorithm" title="Permalink to this headline">¶</a></h2>
<p>There are many. Very active area of research, we will generally not cover them in great detail.  Let’s cover some basics though.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># goal: predict weight from height</span>

<span class="c1"># model is: predicted_y = slope * x + intercept</span>

<span class="c1"># parameters are: slope, intercept</span>

<span class="c1"># loss function:  mean absolute error</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">hw</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;height-weight.csv&#39;</span><span class="p">)</span>

<span class="n">hw</span> <span class="o">=</span> <span class="n">hw</span><span class="p">[</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">36</span><span class="p">]</span>

<span class="n">hw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>67.75</td>
      <td>154.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>72.25</td>
      <td>173.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>66.25</td>
      <td>154.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>72.25</td>
      <td>184.75</td>
    </tr>
    <tr>
      <th>4</th>
      <td>71.25</td>
      <td>184.25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>247</th>
      <td>67.00</td>
      <td>134.25</td>
    </tr>
    <tr>
      <th>248</th>
      <td>69.75</td>
      <td>201.00</td>
    </tr>
    <tr>
      <th>249</th>
      <td>66.00</td>
      <td>186.75</td>
    </tr>
    <tr>
      <th>250</th>
      <td>70.50</td>
      <td>190.75</td>
    </tr>
    <tr>
      <th>251</th>
      <td>70.00</td>
      <td>207.50</td>
    </tr>
  </tbody>
</table>
<p>251 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">intercept</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f8a05be30d0&gt;]
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_62_1.png" src="../_images/css2-lecture-5_62_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mae</span><span class="p">(</span><span class="n">predicted_y</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">predicted_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>20.21573705179283
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">],</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">1.01</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">5.75</span><span class="p">,</span> <span class="o">-</span><span class="mi">227</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;m-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">predict</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;y-&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f8a05cbc490&gt;]
</pre></div>
</div>
<img alt="../_images/css2-lecture-5_65_1.png" src="../_images/css2-lecture-5_65_1.png" />
</div>
</div>
<div class="section" id="grid-search">
<h3>Grid search<a class="headerlink" href="#grid-search" title="Permalink to this headline">¶</a></h3>
<p>Consider a bunch of possible parameter settings.  Evaluate loss for each.  Pick the best one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">current_lowest</span> <span class="o">=</span> <span class="mi">1000000000</span>

<span class="n">best_slope</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">best_intercept</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">for</span> <span class="n">slope</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">intercept</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">):</span>
        <span class="n">current_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> 
                                  <span class="n">intercept</span><span class="p">,</span> 
                                  <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> 
                          <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">current_mae</span> <span class="o">&lt;</span> <span class="n">current_lowest</span><span class="p">:</span>
            <span class="n">current_lowest</span> <span class="o">=</span> <span class="n">current_mae</span>
            <span class="n">best_slope</span> <span class="o">=</span> <span class="n">slope</span>
            <span class="n">best_intercept</span> <span class="o">=</span> <span class="n">intercept</span>
        <span class="c1">#print(f&#39;{slope=}, {intercept=}, {current_mae=}&#39;)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">current_lowest</span><span class="p">,</span> <span class="n">best_slope</span><span class="p">,</span> <span class="n">best_intercept</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18.837854642037907 5.757575757575758 -227.2727272727273
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.        , 0.05050505, 0.1010101 , 0.15151515, 0.2020202 ,
       0.25252525, 0.3030303 , 0.35353535, 0.4040404 , 0.45454545,
       0.50505051, 0.55555556, 0.60606061, 0.65656566, 0.70707071,
       0.75757576, 0.80808081, 0.85858586, 0.90909091, 0.95959596,
       1.01010101, 1.06060606, 1.11111111, 1.16161616, 1.21212121,
       1.26262626, 1.31313131, 1.36363636, 1.41414141, 1.46464646,
       1.51515152, 1.56565657, 1.61616162, 1.66666667, 1.71717172,
       1.76767677, 1.81818182, 1.86868687, 1.91919192, 1.96969697,
       2.02020202, 2.07070707, 2.12121212, 2.17171717, 2.22222222,
       2.27272727, 2.32323232, 2.37373737, 2.42424242, 2.47474747,
       2.52525253, 2.57575758, 2.62626263, 2.67676768, 2.72727273,
       2.77777778, 2.82828283, 2.87878788, 2.92929293, 2.97979798,
       3.03030303, 3.08080808, 3.13131313, 3.18181818, 3.23232323,
       3.28282828, 3.33333333, 3.38383838, 3.43434343, 3.48484848,
       3.53535354, 3.58585859, 3.63636364, 3.68686869, 3.73737374,
       3.78787879, 3.83838384, 3.88888889, 3.93939394, 3.98989899,
       4.04040404, 4.09090909, 4.14141414, 4.19191919, 4.24242424,
       4.29292929, 4.34343434, 4.39393939, 4.44444444, 4.49494949,
       4.54545455, 4.5959596 , 4.64646465, 4.6969697 , 4.74747475,
       4.7979798 , 4.84848485, 4.8989899 , 4.94949495, 5.        ])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="random-search">
<h3>Random search<a class="headerlink" href="#random-search" title="Permalink to this headline">¶</a></h3>
<p>Start with some parameter values.  Propose a local perturbation.  If it is better, adopt that one, and continue.  Until some criterion is reached.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slope</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">current</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">slope</span><span class="p">,</span> <span class="n">intercept</span><span class="p">,</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>

<span class="n">attempts</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">while</span> <span class="n">attempts</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
    <span class="n">new_slope</span> <span class="o">=</span> <span class="n">slope</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">new_intercept</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="mi">20</span>
    
    <span class="n">new_mae</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">predict</span><span class="p">(</span><span class="n">new_slope</span><span class="p">,</span> 
                          <span class="n">new_intercept</span><span class="p">,</span> 
                          <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;height&#39;</span><span class="p">]),</span> 
                  <span class="n">hw</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">current</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">new_mae</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">attempts</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">new_mae</span> <span class="o">&lt;</span> <span class="n">current</span><span class="p">:</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="n">new_slope</span>
        <span class="n">intercept</span> <span class="o">=</span> <span class="n">new_intercept</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">new_mae</span>
        <span class="n">attempts</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">slope</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">intercept</span><span class="si">=}</span><span class="s1"> </span><span class="si">{</span><span class="n">current</span><span class="si">=}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=178.82051792828688 new_mae=208.2816577616778
current=178.82051792828688 new_mae=167.1819940782044
slope=0.08876783149250611 intercept=5.397190423071418 current=167.1819940782044
current=167.1819940782044 new_mae=199.5852054888674
current=167.1819940782044 new_mae=161.39778080097184
slope=0.1073046062319537 intercept=9.878069036551919 current=161.39778080097184
current=161.39778080097184 new_mae=188.69379172508914
current=161.39778080097184 new_mae=122.207887827363
slope=0.5881420436464001 intercept=15.259917805020725 current=122.207887827363
current=122.207887827363 new_mae=160.58701555228416
current=122.207887827363 new_mae=110.03098664701824
slope=0.6543350406341284 intercept=22.782739260905743 current=110.03098664701824
current=110.03098664701824 new_mae=115.87293143761532
current=110.03098664701824 new_mae=128.76433532341773
current=110.03098664701824 new_mae=135.4399717705445
current=110.03098664701824 new_mae=120.57949197665972
current=110.03098664701824 new_mae=120.97667916809792
current=110.03098664701824 new_mae=130.87225082051302
current=110.03098664701824 new_mae=82.39397456612735
slope=0.9639538243364199 intercept=28.650220286903984 current=82.39397456612735
current=82.39397456612735 new_mae=55.80373798716425
slope=1.2029599159232576 intercept=38.44970970913132 current=55.80373798716425
current=55.80373798716425 new_mae=87.43410485667822
current=55.80373798716425 new_mae=61.98629662796892
current=55.80373798716425 new_mae=84.62090741114416
current=55.80373798716425 new_mae=74.13700039344775
current=55.80373798716425 new_mae=84.36010255551433
current=55.80373798716425 new_mae=45.68383331532563
slope=1.3960469606541004 intercept=35.137852862522614 current=45.68383331532563
current=45.68383331532563 new_mae=39.25517284103542
slope=1.5772911203228455 intercept=29.23800042172083 current=39.25517284103542
current=39.25517284103542 new_mae=33.373797948379945
slope=1.7802047377304862 intercept=21.79012548990221 current=33.373797948379945
current=33.373797948379945 new_mae=21.682952624098267
slope=2.093605526066841 intercept=19.15733332205803 current=21.682952624098267
current=21.682952624098267 new_mae=33.52008218948219
current=21.682952624098267 new_mae=20.221461924588013
slope=2.1510681105080725 intercept=22.509320344621077 current=20.221461924588013
current=20.221461924588013 new_mae=22.97729279112725
current=20.221461924588013 new_mae=20.93003734720783
current=20.221461924588013 new_mae=26.472147928073003
current=20.221461924588013 new_mae=27.90114498032522
current=20.221461924588013 new_mae=23.73975438921942
current=20.221461924588013 new_mae=26.80448848646785
current=20.221461924588013 new_mae=29.112989681391554
current=20.221461924588013 new_mae=20.718777920497587
current=20.221461924588013 new_mae=36.35172510773808
current=20.221461924588013 new_mae=29.847677953181844
current=20.221461924588013 new_mae=30.65559675495969
current=20.221461924588013 new_mae=29.14542637727005
current=20.221461924588013 new_mae=26.78453838013788
current=20.221461924588013 new_mae=21.94301318019244
current=20.221461924588013 new_mae=29.977486216012377
current=20.221461924588013 new_mae=32.619706248057064
current=20.221461924588013 new_mae=42.6429051867988
current=20.221461924588013 new_mae=29.215915382602095
current=20.221461924588013 new_mae=38.99302161705457
current=20.221461924588013 new_mae=25.253201363747674
current=20.221461924588013 new_mae=22.959687131171602
current=20.221461924588013 new_mae=24.5001658900604
current=20.221461924588013 new_mae=25.185220864156978
current=20.221461924588013 new_mae=27.90223065714002
current=20.221461924588013 new_mae=30.991108743366755
current=20.221461924588013 new_mae=24.2684858873032
current=20.221461924588013 new_mae=36.06069928836215
current=20.221461924588013 new_mae=23.85642503995053
current=20.221461924588013 new_mae=25.3599537589116
current=20.221461924588013 new_mae=29.21932676225507
current=20.221461924588013 new_mae=34.06774971819744
current=20.221461924588013 new_mae=35.70270253801604
current=20.221461924588013 new_mae=20.148979930697532
slope=2.2113080845736963 intercept=19.622709148060718 current=20.148979930697532
current=20.148979930697532 new_mae=28.256234152254628
current=20.148979930697532 new_mae=25.202173052540896
current=20.148979930697532 new_mae=21.132796341795615
current=20.148979930697532 new_mae=24.39700596553732
current=20.148979930697532 new_mae=31.635367564718162
current=20.148979930697532 new_mae=28.427995452044666
current=20.148979930697532 new_mae=24.787001333661905
current=20.148979930697532 new_mae=20.29102369571101
current=20.148979930697532 new_mae=23.443679191720243
current=20.148979930697532 new_mae=23.54541239075243
current=20.148979930697532 new_mae=22.1805540778685
current=20.148979930697532 new_mae=29.99199807830582
current=20.148979930697532 new_mae=24.74386111681116
current=20.148979930697532 new_mae=32.84549951322944
current=20.148979930697532 new_mae=20.88617373829943
current=20.148979930697532 new_mae=26.90578418166541
current=20.148979930697532 new_mae=23.239144999377682
current=20.148979930697532 new_mae=21.996752390983236
current=20.148979930697532 new_mae=22.08309911227785
current=20.148979930697532 new_mae=22.877149293549923
current=20.148979930697532 new_mae=21.798832341220873
current=20.148979930697532 new_mae=24.47278553457514
current=20.148979930697532 new_mae=20.329351504911923
current=20.148979930697532 new_mae=20.128995410327637
slope=2.250708290849456 intercept=17.154047119774923 current=20.128995410327637
current=20.128995410327637 new_mae=22.943676831676775
current=20.128995410327637 new_mae=20.89039585710947
current=20.128995410327637 new_mae=22.62239586233708
current=20.128995410327637 new_mae=21.57867391887023
current=20.128995410327637 new_mae=38.56080917809188
current=20.128995410327637 new_mae=28.75904685506326
current=20.128995410327637 new_mae=30.184674914696743
current=20.128995410327637 new_mae=21.547754413206114
current=20.128995410327637 new_mae=34.79993976473755
current=20.128995410327637 new_mae=20.23362255291832
current=20.128995410327637 new_mae=22.00835342015385
current=20.128995410327637 new_mae=21.084594371880506
current=20.128995410327637 new_mae=20.575795770837207
current=20.128995410327637 new_mae=28.853567399652853
current=20.128995410327637 new_mae=26.14508209258791
current=20.128995410327637 new_mae=24.643691638013607
current=20.128995410327637 new_mae=25.661365724427203
current=20.128995410327637 new_mae=31.851841682191882
current=20.128995410327637 new_mae=22.20156846659203
current=20.128995410327637 new_mae=21.048307012025116
current=20.128995410327637 new_mae=31.349583394170228
current=20.128995410327637 new_mae=25.095344804622407
current=20.128995410327637 new_mae=35.955543035984114
current=20.128995410327637 new_mae=21.332154631476794
current=20.128995410327637 new_mae=29.81555201443258
current=20.128995410327637 new_mae=21.527338455501702
current=20.128995410327637 new_mae=22.611894874018166
current=20.128995410327637 new_mae=31.957671102910354
current=20.128995410327637 new_mae=38.57701196614236
current=20.128995410327637 new_mae=28.485478198893798
current=20.128995410327637 new_mae=24.36603116462685
current=20.128995410327637 new_mae=24.08387585047133
current=20.128995410327637 new_mae=34.0697770639905
current=20.128995410327637 new_mae=43.62395440615667
current=20.128995410327637 new_mae=21.64966233613849
current=20.128995410327637 new_mae=28.34558450086341
current=20.128995410327637 new_mae=35.25257102806158
current=20.128995410327637 new_mae=20.368603908216407
current=20.128995410327637 new_mae=22.96582861703896
current=20.128995410327637 new_mae=37.28256811377097
current=20.128995410327637 new_mae=20.216804688449184
current=20.128995410327637 new_mae=21.938603982924707
current=20.128995410327637 new_mae=26.444808752760007
current=20.128995410327637 new_mae=24.990808937346177
current=20.128995410327637 new_mae=21.469762675482425
current=20.128995410327637 new_mae=21.40039457648268
current=20.128995410327637 new_mae=39.51628320579344
current=20.128995410327637 new_mae=26.790272754503167
current=20.128995410327637 new_mae=28.65117571250643
current=20.128995410327637 new_mae=21.564563116002088
current=20.128995410327637 new_mae=20.5688894452409
current=20.128995410327637 new_mae=24.11001636537941
current=20.128995410327637 new_mae=22.812350547154132
current=20.128995410327637 new_mae=36.368778939769214
current=20.128995410327637 new_mae=25.055582783969697
current=20.128995410327637 new_mae=25.712175595604016
current=20.128995410327637 new_mae=33.14752227700983
current=20.128995410327637 new_mae=23.849348801664878
current=20.128995410327637 new_mae=20.558623948929313
current=20.128995410327637 new_mae=21.785248483149857
current=20.128995410327637 new_mae=21.844725727965386
current=20.128995410327637 new_mae=24.852599466513045
current=20.128995410327637 new_mae=28.129003656850042
current=20.128995410327637 new_mae=34.52879636760461
current=20.128995410327637 new_mae=33.82380184222976
current=20.128995410327637 new_mae=25.735792086163908
current=20.128995410327637 new_mae=24.182368968144925
current=20.128995410327637 new_mae=32.790070776882
current=20.128995410327637 new_mae=20.449201770569704
current=20.128995410327637 new_mae=35.7017757791631
current=20.128995410327637 new_mae=24.542540224985835
current=20.128995410327637 new_mae=38.92768551613167
current=20.128995410327637 new_mae=32.44411772760776
current=20.128995410327637 new_mae=30.947196570121207
current=20.128995410327637 new_mae=20.807568405092166
current=20.128995410327637 new_mae=20.401498886230314
current=20.128995410327637 new_mae=22.519619473998155
current=20.128995410327637 new_mae=20.234605346711138
current=20.128995410327637 new_mae=45.309833565464686
current=20.128995410327637 new_mae=35.08560794873123
current=20.128995410327637 new_mae=20.138620943730903
current=20.128995410327637 new_mae=21.932090275046082
current=20.128995410327637 new_mae=35.888957868177314
current=20.128995410327637 new_mae=26.39653294717374
current=20.128995410327637 new_mae=23.827580932220233
current=20.128995410327637 new_mae=20.68570912292669
current=20.128995410327637 new_mae=30.1272217772061
current=20.128995410327637 new_mae=34.352923461236934
current=20.128995410327637 new_mae=26.53681162220552
current=20.128995410327637 new_mae=26.157277997258877
current=20.128995410327637 new_mae=35.330916316419106
current=20.128995410327637 new_mae=20.230322545649358
current=20.128995410327637 new_mae=26.027728109557135
current=20.128995410327637 new_mae=23.537866084416734
current=20.128995410327637 new_mae=27.14546265395657
current=20.128995410327637 new_mae=38.853307612876094
current=20.128995410327637 new_mae=24.865009664410394
current=20.128995410327637 new_mae=37.57275919443451
current=20.128995410327637 new_mae=20.058075855678794
slope=2.3560730410037625 intercept=9.957855505242332 current=20.058075855678794
current=20.058075855678794 new_mae=24.50635194644131
current=20.058075855678794 new_mae=20.06335816315516
current=20.058075855678794 new_mae=25.73750445510658
current=20.058075855678794 new_mae=21.874592926079412
current=20.058075855678794 new_mae=25.43721484596554
current=20.058075855678794 new_mae=20.038528540726947
slope=2.354908782084642 intercept=9.59204849245469 current=20.038528540726947
current=20.038528540726947 new_mae=20.360067366958955
current=20.038528540726947 new_mae=20.76869938963058
current=20.038528540726947 new_mae=21.866187709143066
current=20.038528540726947 new_mae=28.545670736123753
current=20.038528540726947 new_mae=24.193322538961542
current=20.038528540726947 new_mae=20.54389098851104
current=20.038528540726947 new_mae=23.15367520724977
current=20.038528540726947 new_mae=22.824509812606987
current=20.038528540726947 new_mae=20.253984065324076
current=20.038528540726947 new_mae=40.225456164992536
current=20.038528540726947 new_mae=20.785209034212688
current=20.038528540726947 new_mae=21.84450967000571
current=20.038528540726947 new_mae=22.23820335604782
current=20.038528540726947 new_mae=36.46132759295841
current=20.038528540726947 new_mae=24.4259713550027
current=20.038528540726947 new_mae=28.37920348905469
current=20.038528540726947 new_mae=20.088865208574592
current=20.038528540726947 new_mae=21.153340066888493
current=20.038528540726947 new_mae=22.030170844885227
current=20.038528540726947 new_mae=23.55834303198769
current=20.038528540726947 new_mae=21.41594739021976
current=20.038528540726947 new_mae=23.398226154161186
current=20.038528540726947 new_mae=30.36463599178847
current=20.038528540726947 new_mae=31.9754685231014
current=20.038528540726947 new_mae=31.38693416865768
current=20.038528540726947 new_mae=21.782667897378065
current=20.038528540726947 new_mae=23.19857206978983
current=20.038528540726947 new_mae=34.60709572215517
current=20.038528540726947 new_mae=26.643932741519695
current=20.038528540726947 new_mae=20.420721004912632
current=20.038528540726947 new_mae=27.79150210492986
current=20.038528540726947 new_mae=20.1151483093761
current=20.038528540726947 new_mae=20.750220632756584
current=20.038528540726947 new_mae=37.616997968309676
current=20.038528540726947 new_mae=23.77234332274682
current=20.038528540726947 new_mae=24.428938376988548
current=20.038528540726947 new_mae=28.690375315026774
current=20.038528540726947 new_mae=20.69591987816055
current=20.038528540726947 new_mae=22.964173791227154
current=20.038528540726947 new_mae=34.766929357830556
current=20.038528540726947 new_mae=38.355330331964105
current=20.038528540726947 new_mae=27.33582527900971
current=20.038528540726947 new_mae=21.24940207283368
current=20.038528540726947 new_mae=27.00361672988582
current=20.038528540726947 new_mae=26.282097282353888
current=20.038528540726947 new_mae=20.434536460264393
current=20.038528540726947 new_mae=21.717755537707873
current=20.038528540726947 new_mae=20.065822687939537
current=20.038528540726947 new_mae=20.79653264263904
current=20.038528540726947 new_mae=24.830939188386758
current=20.038528540726947 new_mae=33.784496592807976
current=20.038528540726947 new_mae=33.514413287913854
current=20.038528540726947 new_mae=30.25515961195593
current=20.038528540726947 new_mae=33.87077924920861
current=20.038528540726947 new_mae=20.473330119454655
current=20.038528540726947 new_mae=23.76056121710446
current=20.038528540726947 new_mae=29.21653581362354
current=20.038528540726947 new_mae=20.852522217274885
current=20.038528540726947 new_mae=20.064786206547616
current=20.038528540726947 new_mae=21.865305861318348
current=20.038528540726947 new_mae=34.0620995949817
current=20.038528540726947 new_mae=27.250616642351474
current=20.038528540726947 new_mae=26.623871125103022
current=20.038528540726947 new_mae=25.68087962708915
current=20.038528540726947 new_mae=31.810524429621996
current=20.038528540726947 new_mae=22.720305058550462
current=20.038528540726947 new_mae=27.352783218702566
current=20.038528540726947 new_mae=20.626974006257555
current=20.038528540726947 new_mae=20.590301326596197
current=20.038528540726947 new_mae=23.89769091491087
current=20.038528540726947 new_mae=23.191601466232136
current=20.038528540726947 new_mae=20.003565879458005
slope=2.459209167380016 intercept=3.0834191923266134 current=20.003565879458005
current=20.003565879458005 new_mae=41.733061813145405
current=20.003565879458005 new_mae=24.381685125222308
current=20.003565879458005 new_mae=28.20379676481708
current=20.003565879458005 new_mae=38.117269612174134
current=20.003565879458005 new_mae=34.57610589452612
current=20.003565879458005 new_mae=22.52605839258251
current=20.003565879458005 new_mae=24.10703413134447
current=20.003565879458005 new_mae=30.265443783033845
current=20.003565879458005 new_mae=21.760958555248365
current=20.003565879458005 new_mae=25.98917003751807
current=20.003565879458005 new_mae=26.7955097952066
current=20.003565879458005 new_mae=22.28541951420045
current=20.003565879458005 new_mae=20.153585268515688
current=20.003565879458005 new_mae=23.018747273643775
current=20.003565879458005 new_mae=20.44095117853008
current=20.003565879458005 new_mae=20.55170209095642
current=20.003565879458005 new_mae=25.144828771815334
current=20.003565879458005 new_mae=31.76974835469738
current=20.003565879458005 new_mae=25.30917684730648
current=20.003565879458005 new_mae=20.222182487897783
current=20.003565879458005 new_mae=25.590520800296762
current=20.003565879458005 new_mae=23.00055552845481
current=20.003565879458005 new_mae=29.888392736585935
current=20.003565879458005 new_mae=22.22118032739156
current=20.003565879458005 new_mae=34.452325338831805
current=20.003565879458005 new_mae=37.64024728581676
current=20.003565879458005 new_mae=35.33513790472507
current=20.003565879458005 new_mae=22.058722325727345
current=20.003565879458005 new_mae=20.096097386232568
current=20.003565879458005 new_mae=21.04160411221326
current=20.003565879458005 new_mae=24.550291565869475
current=20.003565879458005 new_mae=27.609496394922385
current=20.003565879458005 new_mae=31.092721969674912
current=20.003565879458005 new_mae=28.155556637145022
current=20.003565879458005 new_mae=24.527396010759745
current=20.003565879458005 new_mae=24.403449075174436
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=20.003565879458005 new_mae=23.624990662373655
current=20.003565879458005 new_mae=26.571833306131964
current=20.003565879458005 new_mae=42.432010013245275
current=20.003565879458005 new_mae=24.36921565393843
current=20.003565879458005 new_mae=20.464618174310246
current=20.003565879458005 new_mae=29.069163826055476
current=20.003565879458005 new_mae=27.771785593349996
current=20.003565879458005 new_mae=21.49377378351869
current=20.003565879458005 new_mae=20.906949221300135
current=20.003565879458005 new_mae=21.1286042229169
current=20.003565879458005 new_mae=20.44938509516248
current=20.003565879458005 new_mae=26.134190946826482
current=20.003565879458005 new_mae=20.97626463420809
current=20.003565879458005 new_mae=20.724955337293448
current=20.003565879458005 new_mae=20.476136135099054
current=20.003565879458005 new_mae=33.42476614370454
current=20.003565879458005 new_mae=26.74802657192582
current=20.003565879458005 new_mae=44.62367845460363
current=20.003565879458005 new_mae=37.94338890139497
current=20.003565879458005 new_mae=20.44833611971049
current=20.003565879458005 new_mae=29.951335789592232
current=20.003565879458005 new_mae=26.081341615596575
current=20.003565879458005 new_mae=34.82848345045435
current=20.003565879458005 new_mae=23.33872828200928
current=20.003565879458005 new_mae=20.13481793525466
current=20.003565879458005 new_mae=21.147682205994673
current=20.003565879458005 new_mae=30.128351938365103
current=20.003565879458005 new_mae=20.252028987095432
current=20.003565879458005 new_mae=20.707480781574503
current=20.003565879458005 new_mae=21.179571108994505
current=20.003565879458005 new_mae=21.162639474140136
current=20.003565879458005 new_mae=20.14433781458702
current=20.003565879458005 new_mae=41.653992398162686
current=20.003565879458005 new_mae=30.698949446996345
current=20.003565879458005 new_mae=38.62658703365763
current=20.003565879458005 new_mae=26.993397674774947
current=20.003565879458005 new_mae=33.378797046260104
current=20.003565879458005 new_mae=39.608698924027486
current=20.003565879458005 new_mae=20.06182445270674
current=20.003565879458005 new_mae=28.83696970151717
current=20.003565879458005 new_mae=23.706496193898808
current=20.003565879458005 new_mae=41.666146501467686
current=20.003565879458005 new_mae=28.170754024477734
current=20.003565879458005 new_mae=20.699147621909372
current=20.003565879458005 new_mae=34.879064923566716
current=20.003565879458005 new_mae=33.162671407579914
current=20.003565879458005 new_mae=29.605073657916765
current=20.003565879458005 new_mae=24.598315662832995
current=20.003565879458005 new_mae=20.15150812725697
current=20.003565879458005 new_mae=25.133658863717336
current=20.003565879458005 new_mae=21.4720840970081
current=20.003565879458005 new_mae=41.25471975149878
current=20.003565879458005 new_mae=21.383153004667808
current=20.003565879458005 new_mae=23.849739382714834
current=20.003565879458005 new_mae=21.415048925756977
current=20.003565879458005 new_mae=42.067509707784886
current=20.003565879458005 new_mae=36.71495274337294
current=20.003565879458005 new_mae=19.953041895892746
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>slope=2.483119423244055 intercept=-0.457555387475725 current=19.953041895892746
current=19.953041895892746 new_mae=34.66631021365986
current=19.953041895892746 new_mae=20.103934267518888
current=19.953041895892746 new_mae=22.193345143133584
current=19.953041895892746 new_mae=20.14302545562332
current=19.953041895892746 new_mae=27.571411207355066
current=19.953041895892746 new_mae=22.976868190972837
current=19.953041895892746 new_mae=23.7821430718384
current=19.953041895892746 new_mae=21.3273981481927
current=19.953041895892746 new_mae=26.84941353956523
current=19.953041895892746 new_mae=33.41226345897198
current=19.953041895892746 new_mae=21.100730059758053
current=19.953041895892746 new_mae=23.712292392569456
current=19.953041895892746 new_mae=24.208391562703223
current=19.953041895892746 new_mae=26.658945086493997
current=19.953041895892746 new_mae=20.052107444898823
current=19.953041895892746 new_mae=33.10647034542725
current=19.953041895892746 new_mae=35.20626128187201
current=19.953041895892746 new_mae=38.55158025572769
current=19.953041895892746 new_mae=25.2106403470084
current=19.953041895892746 new_mae=20.1228026751322
current=19.953041895892746 new_mae=20.134039091116954
current=19.953041895892746 new_mae=22.856159476023816
current=19.953041895892746 new_mae=20.281972976946335
current=19.953041895892746 new_mae=24.59986089557814
current=19.953041895892746 new_mae=20.10590415285079
current=19.953041895892746 new_mae=27.350509654441865
current=19.953041895892746 new_mae=19.86620061552644
slope=2.602792764396362 intercept=-7.686989342402413 current=19.86620061552644
current=19.86620061552644 new_mae=27.438828266206865
current=19.86620061552644 new_mae=23.160787003975358
current=19.86620061552644 new_mae=22.480311570090855
current=19.86620061552644 new_mae=27.27157648026101
current=19.86620061552644 new_mae=20.28570312720463
current=19.86620061552644 new_mae=24.97059742931521
current=19.86620061552644 new_mae=20.82917177700642
current=19.86620061552644 new_mae=20.06565970741681
current=19.86620061552644 new_mae=27.45828162320032
current=19.86620061552644 new_mae=20.120506575787708
current=19.86620061552644 new_mae=28.186579511531665
current=19.86620061552644 new_mae=23.885862997235
current=19.86620061552644 new_mae=21.175076451348083
current=19.86620061552644 new_mae=21.230379019055242
current=19.86620061552644 new_mae=24.041299734530764
current=19.86620061552644 new_mae=29.96853156547285
current=19.86620061552644 new_mae=19.79799786658641
slope=2.693654956706501 intercept=-14.737344209337305 current=19.79799786658641
current=19.79799786658641 new_mae=32.023536421327535
current=19.79799786658641 new_mae=22.698456054744945
current=19.79799786658641 new_mae=32.12216735512599
current=19.79799786658641 new_mae=20.60464502604197
current=19.79799786658641 new_mae=26.792741285235643
current=19.79799786658641 new_mae=34.25098466033031
current=19.79799786658641 new_mae=19.951566592908307
current=19.79799786658641 new_mae=31.98276349751844
current=19.79799786658641 new_mae=23.994644053981933
current=19.79799786658641 new_mae=31.957757502562867
current=19.79799786658641 new_mae=22.458864193370353
current=19.79799786658641 new_mae=29.028500893975355
current=19.79799786658641 new_mae=27.11898165060727
current=19.79799786658641 new_mae=19.870684187863393
current=19.79799786658641 new_mae=32.394431826856525
current=19.79799786658641 new_mae=26.69725415208556
current=19.79799786658641 new_mae=20.63524175528157
current=19.79799786658641 new_mae=33.76444604100697
current=19.79799786658641 new_mae=32.39852353855153
current=19.79799786658641 new_mae=21.87726508779942
current=19.79799786658641 new_mae=31.693750964639896
current=19.79799786658641 new_mae=20.477466100602463
current=19.79799786658641 new_mae=29.95571674710681
current=19.79799786658641 new_mae=26.02999668988491
current=19.79799786658641 new_mae=30.1375242133498
current=19.79799786658641 new_mae=37.99700300563525
current=19.79799786658641 new_mae=41.81654376100739
current=19.79799786658641 new_mae=27.953977903450085
current=19.79799786658641 new_mae=36.368094969233965
current=19.79799786658641 new_mae=26.843116726212127
current=19.79799786658641 new_mae=27.287789118280482
current=19.79799786658641 new_mae=22.982144682260383
current=19.79799786658641 new_mae=34.95920845282272
current=19.79799786658641 new_mae=28.72062406352999
current=19.79799786658641 new_mae=21.63409904995388
current=19.79799786658641 new_mae=21.31887343293633
current=19.79799786658641 new_mae=20.966277884127095
current=19.79799786658641 new_mae=25.041752951049084
current=19.79799786658641 new_mae=34.86742701384302
current=19.79799786658641 new_mae=26.930824067674845
current=19.79799786658641 new_mae=33.09124477606627
current=19.79799786658641 new_mae=27.264456913780986
current=19.79799786658641 new_mae=24.16743465249476
current=19.79799786658641 new_mae=23.531097663889053
current=19.79799786658641 new_mae=31.275907086815167
current=19.79799786658641 new_mae=23.349097452474176
current=19.79799786658641 new_mae=27.330305154591965
current=19.79799786658641 new_mae=23.208011490717013
current=19.79799786658641 new_mae=19.935373961982293
current=19.79799786658641 new_mae=22.34264919529173
current=19.79799786658641 new_mae=19.980071521470506
current=19.79799786658641 new_mae=33.80536956964698
current=19.79799786658641 new_mae=21.847379734827754
current=19.79799786658641 new_mae=21.696807510660292
current=19.79799786658641 new_mae=26.327495686769122
current=19.79799786658641 new_mae=36.786330378594116
current=19.79799786658641 new_mae=30.467087164936945
current=19.79799786658641 new_mae=38.28846874039461
current=19.79799786658641 new_mae=21.341101122125032
current=19.79799786658641 new_mae=26.38800974610498
current=19.79799786658641 new_mae=19.93197471659791
current=19.79799786658641 new_mae=21.955234349750633
current=19.79799786658641 new_mae=29.051684415037446
current=19.79799786658641 new_mae=21.533239644651612
current=19.79799786658641 new_mae=30.2830543121107
current=19.79799786658641 new_mae=28.81474552430369
current=19.79799786658641 new_mae=24.77449487457222
current=19.79799786658641 new_mae=36.30619383162193
current=19.79799786658641 new_mae=20.034155220682663
current=19.79799786658641 new_mae=20.080774357176445
current=19.79799786658641 new_mae=20.361376736045703
current=19.79799786658641 new_mae=21.937117001641212
current=19.79799786658641 new_mae=42.992481641858525
current=19.79799786658641 new_mae=19.954990441660694
current=19.79799786658641 new_mae=24.57665690076775
current=19.79799786658641 new_mae=28.714904549436508
current=19.79799786658641 new_mae=23.168180836236456
current=19.79799786658641 new_mae=19.95589826708739
current=19.79799786658641 new_mae=21.433234366840146
current=19.79799786658641 new_mae=19.826515357294184
current=19.79799786658641 new_mae=21.417562647598693
current=19.79799786658641 new_mae=24.190998244110276
current=19.79799786658641 new_mae=30.252205059681618
current=19.79799786658641 new_mae=38.85596146413213
current=19.79799786658641 new_mae=22.538846188527245
current=19.79799786658641 new_mae=30.718917947568382
current=19.79799786658641 new_mae=30.482610374422272
current=19.79799786658641 new_mae=35.370579014982084
current=19.79799786658641 new_mae=19.779559676555788
slope=2.7645431778490583 intercept=-20.57832644828382 current=19.779559676555788
current=19.779559676555788 new_mae=29.103728840779624
current=19.779559676555788 new_mae=21.387281083567704
current=19.779559676555788 new_mae=24.512033497839877
current=19.779559676555788 new_mae=22.79532926700757
current=19.779559676555788 new_mae=29.603319534442733
current=19.779559676555788 new_mae=22.14867421996726
current=19.779559676555788 new_mae=20.114905084971365
current=19.779559676555788 new_mae=29.9761268350198
current=19.779559676555788 new_mae=29.9053581091675
current=19.779559676555788 new_mae=22.53093781655121
current=19.779559676555788 new_mae=31.10071376470888
current=19.779559676555788 new_mae=29.411337343504616
current=19.779559676555788 new_mae=30.267325817660012
current=19.779559676555788 new_mae=19.936227554033184
current=19.779559676555788 new_mae=25.57062706441217
current=19.779559676555788 new_mae=22.432487822618963
current=19.779559676555788 new_mae=24.082944018136065
current=19.779559676555788 new_mae=19.849932539641642
current=19.779559676555788 new_mae=20.927739143436074
current=19.779559676555788 new_mae=19.924826797117262
current=19.779559676555788 new_mae=43.08965211927742
current=19.779559676555788 new_mae=19.719670025011588
slope=2.9245703017561286 intercept=-28.93979829455757 current=19.719670025011588
current=19.719670025011588 new_mae=27.15075418346886
current=19.719670025011588 new_mae=20.501255428566427
current=19.719670025011588 new_mae=19.686520951265635
slope=2.9838487033091763 intercept=-33.00306141003295 current=19.686520951265635
current=19.686520951265635 new_mae=25.14647110347285
current=19.686520951265635 new_mae=36.89561420272601
current=19.686520951265635 new_mae=19.969897734949544
current=19.686520951265635 new_mae=28.19060878224528
current=19.686520951265635 new_mae=32.721523605631724
current=19.686520951265635 new_mae=19.93049835080848
current=19.686520951265635 new_mae=28.686387414870644
current=19.686520951265635 new_mae=34.88268425874843
current=19.686520951265635 new_mae=42.793161898864795
current=19.686520951265635 new_mae=22.25354350287139
current=19.686520951265635 new_mae=37.78703023299661
current=19.686520951265635 new_mae=19.94713957534174
current=19.686520951265635 new_mae=27.842353124759526
current=19.686520951265635 new_mae=40.61548967537801
current=19.686520951265635 new_mae=30.54847938582357
current=19.686520951265635 new_mae=19.764712737218122
current=19.686520951265635 new_mae=30.362795769595984
current=19.686520951265635 new_mae=28.386920252173404
current=19.686520951265635 new_mae=40.212959812447025
current=19.686520951265635 new_mae=22.061226909334952
current=19.686520951265635 new_mae=40.627774929729185
current=19.686520951265635 new_mae=32.18874814469666
current=19.686520951265635 new_mae=20.829896299081422
current=19.686520951265635 new_mae=28.6056053872105
current=19.686520951265635 new_mae=25.75526012079669
current=19.686520951265635 new_mae=20.417232065553474
current=19.686520951265635 new_mae=42.34827610288512
current=19.686520951265635 new_mae=24.70533652938467
current=19.686520951265635 new_mae=34.70143831530506
current=19.686520951265635 new_mae=23.895088752925226
current=19.686520951265635 new_mae=24.72955123410728
current=19.686520951265635 new_mae=20.35812662053043
current=19.686520951265635 new_mae=25.481491414436412
current=19.686520951265635 new_mae=20.854188446216863
current=19.686520951265635 new_mae=19.95124568107575
current=19.686520951265635 new_mae=20.578228422142754
current=19.686520951265635 new_mae=27.44179346789572
current=19.686520951265635 new_mae=30.057028752143477
current=19.686520951265635 new_mae=31.80799267597386
current=19.686520951265635 new_mae=23.932095428485376
current=19.686520951265635 new_mae=19.739035621355683
current=19.686520951265635 new_mae=25.306130104738024
current=19.686520951265635 new_mae=36.21871680098981
current=19.686520951265635 new_mae=25.105958593816663
current=19.686520951265635 new_mae=26.602131648069484
current=19.686520951265635 new_mae=23.989866416116023
current=19.686520951265635 new_mae=19.731055646446492
current=19.686520951265635 new_mae=36.66230932212831
current=19.686520951265635 new_mae=25.790145480639705
current=19.686520951265635 new_mae=43.856541122712166
current=19.686520951265635 new_mae=38.54224659865214
current=19.686520951265635 new_mae=20.551365914786754
current=19.686520951265635 new_mae=23.800065220905708
current=19.686520951265635 new_mae=19.90279860406317
current=19.686520951265635 new_mae=25.077629801215505
current=19.686520951265635 new_mae=20.206156019497286
current=19.686520951265635 new_mae=30.76960224002688
current=19.686520951265635 new_mae=27.412272853580156
current=19.686520951265635 new_mae=21.5681499861179
current=19.686520951265635 new_mae=23.229213339034022
current=19.686520951265635 new_mae=29.68631804075837
current=19.686520951265635 new_mae=36.85875513389789
current=19.686520951265635 new_mae=22.119200932612934
current=19.686520951265635 new_mae=20.751523153181928
current=19.686520951265635 new_mae=20.347853521218287
current=19.686520951265635 new_mae=24.770561850789978
current=19.686520951265635 new_mae=19.740873847696857
current=19.686520951265635 new_mae=19.8956935039426
current=19.686520951265635 new_mae=19.81423213241489
current=19.686520951265635 new_mae=35.25634756414019
current=19.686520951265635 new_mae=20.643428517110387
current=19.686520951265635 new_mae=23.169364318414676
current=19.686520951265635 new_mae=22.33076245765944
current=19.686520951265635 new_mae=28.220421539883265
current=19.686520951265635 new_mae=33.000789848513044
current=19.686520951265635 new_mae=29.313827640995807
current=19.686520951265635 new_mae=23.353664632140067
current=19.686520951265635 new_mae=45.05087789283467
current=19.686520951265635 new_mae=19.610158055822737
slope=3.0085626086893953 intercept=-36.83076791615171 current=19.610158055822737
current=19.610158055822737 new_mae=42.2153235921448
current=19.610158055822737 new_mae=31.77043263422372
current=19.610158055822737 new_mae=19.64091315846891
current=19.610158055822737 new_mae=47.72310055540442
current=19.610158055822737 new_mae=26.697211256623763
current=19.610158055822737 new_mae=19.535889655210582
slope=3.14549722391432 intercept=-46.56986107196963 current=19.535889655210582
current=19.535889655210582 new_mae=26.369180796842993
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.535889655210582 new_mae=22.86649571729491
current=19.535889655210582 new_mae=30.99533271889343
current=19.535889655210582 new_mae=40.47495242989999
current=19.535889655210582 new_mae=26.30839632602757
current=19.535889655210582 new_mae=23.416929841471024
current=19.535889655210582 new_mae=19.63131674051856
current=19.535889655210582 new_mae=19.570938460825385
current=19.535889655210582 new_mae=27.064803927312795
current=19.535889655210582 new_mae=24.478036806077007
current=19.535889655210582 new_mae=19.80881163468865
current=19.535889655210582 new_mae=21.49787234928317
current=19.535889655210582 new_mae=20.973642168270917
current=19.535889655210582 new_mae=23.714653355242326
current=19.535889655210582 new_mae=21.344918702912395
current=19.535889655210582 new_mae=19.643652868472458
current=19.535889655210582 new_mae=25.90675109758421
current=19.535889655210582 new_mae=26.895708077101066
current=19.535889655210582 new_mae=20.350468664695246
current=19.535889655210582 new_mae=20.374299652017186
current=19.535889655210582 new_mae=34.907290625321465
current=19.535889655210582 new_mae=23.13242903704615
current=19.535889655210582 new_mae=39.43120050432656
current=19.535889655210582 new_mae=23.775706551797672
current=19.535889655210582 new_mae=31.81896624058528
current=19.535889655210582 new_mae=25.99872474824474
current=19.535889655210582 new_mae=23.19406469891943
current=19.535889655210582 new_mae=21.266901880957906
current=19.535889655210582 new_mae=28.7899844483389
current=19.535889655210582 new_mae=26.4471342601712
current=19.535889655210582 new_mae=26.253335292796365
current=19.535889655210582 new_mae=20.34614869128785
current=19.535889655210582 new_mae=20.734676513490733
current=19.535889655210582 new_mae=19.718539543902498
current=19.535889655210582 new_mae=23.59686971622512
current=19.535889655210582 new_mae=19.7352193580785
current=19.535889655210582 new_mae=24.027016463641452
current=19.535889655210582 new_mae=33.223557943599005
current=19.535889655210582 new_mae=28.226773001461993
current=19.535889655210582 new_mae=48.2072897401923
current=19.535889655210582 new_mae=26.899996924800167
current=19.535889655210582 new_mae=25.02648688915127
current=19.535889655210582 new_mae=22.9922618943136
current=19.535889655210582 new_mae=25.983511295542783
current=19.535889655210582 new_mae=46.74118376128572
current=19.535889655210582 new_mae=37.417228548318974
current=19.535889655210582 new_mae=21.11030567860105
current=19.535889655210582 new_mae=25.012114961991898
current=19.535889655210582 new_mae=21.120653585292956
current=19.535889655210582 new_mae=19.522221678872995
slope=3.1737828551852165 intercept=-47.27432535420696 current=19.522221678872995
current=19.522221678872995 new_mae=19.894046776028702
current=19.522221678872995 new_mae=26.30330709451652
current=19.522221678872995 new_mae=32.197128587972664
current=19.522221678872995 new_mae=20.029435517947437
current=19.522221678872995 new_mae=23.63595334241911
current=19.522221678872995 new_mae=19.644459926021117
current=19.522221678872995 new_mae=25.411804018770198
current=19.522221678872995 new_mae=20.59791608723034
current=19.522221678872995 new_mae=39.15458450357238
current=19.522221678872995 new_mae=19.463234808119363
slope=3.27283401828048 intercept=-55.23457486602449 current=19.463234808119363
current=19.463234808119363 new_mae=25.28617090236966
current=19.463234808119363 new_mae=34.366802854956944
current=19.463234808119363 new_mae=28.113811122105826
current=19.463234808119363 new_mae=19.942355494736425
current=19.463234808119363 new_mae=26.014005133829027
current=19.463234808119363 new_mae=19.908175241512684
current=19.463234808119363 new_mae=23.6320465005923
current=19.463234808119363 new_mae=22.87859471064728
current=19.463234808119363 new_mae=28.913946824447752
current=19.463234808119363 new_mae=22.000660236449114
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.463234808119363 new_mae=30.31830489039989
current=19.463234808119363 new_mae=23.03619537353269
current=19.463234808119363 new_mae=27.006987063563255
current=19.463234808119363 new_mae=31.84750975354034
current=19.463234808119363 new_mae=21.407370822665488
current=19.463234808119363 new_mae=23.961751903400966
current=19.463234808119363 new_mae=30.3710355302491
current=19.463234808119363 new_mae=19.820185033537612
current=19.463234808119363 new_mae=31.151189046754823
current=19.463234808119363 new_mae=23.668591252229508
current=19.463234808119363 new_mae=19.76477307319462
current=19.463234808119363 new_mae=27.17698226611982
current=19.463234808119363 new_mae=38.9877323096848
current=19.463234808119363 new_mae=23.74172469000282
current=19.463234808119363 new_mae=37.42203777351947
current=19.463234808119363 new_mae=23.802170068863653
current=19.463234808119363 new_mae=22.175464741210458
current=19.463234808119363 new_mae=20.352433648986185
current=19.463234808119363 new_mae=20.930978670214973
current=19.463234808119363 new_mae=27.709780575887414
current=19.463234808119363 new_mae=35.684750773728304
current=19.463234808119363 new_mae=20.721784538225126
current=19.463234808119363 new_mae=25.96967245924827
current=19.463234808119363 new_mae=21.082617210675952
current=19.463234808119363 new_mae=19.48787130327313
current=19.463234808119363 new_mae=25.622842618700815
current=19.463234808119363 new_mae=28.043121407482417
current=19.463234808119363 new_mae=20.256386402975057
current=19.463234808119363 new_mae=38.34551359227755
current=19.463234808119363 new_mae=21.60641762259792
current=19.463234808119363 new_mae=19.562501726787183
current=19.463234808119363 new_mae=28.75863403276431
current=19.463234808119363 new_mae=26.672967943496094
current=19.463234808119363 new_mae=23.295895171735545
current=19.463234808119363 new_mae=20.321280124525686
current=19.463234808119363 new_mae=31.533776118473728
current=19.463234808119363 new_mae=24.986506982836477
current=19.463234808119363 new_mae=24.4412649936988
current=19.463234808119363 new_mae=31.530347796234906
current=19.463234808119363 new_mae=33.44932375749019
current=19.463234808119363 new_mae=20.354707679250602
current=19.463234808119363 new_mae=19.431071660736276
slope=3.3904144819369435 intercept=-64.16134008521823 current=19.431071660736276
current=19.431071660736276 new_mae=41.26140422279237
current=19.431071660736276 new_mae=19.493509903853703
current=19.431071660736276 new_mae=25.034360436355534
current=19.431071660736276 new_mae=25.454650837928508
current=19.431071660736276 new_mae=19.545727088802565
current=19.431071660736276 new_mae=19.505411887796583
current=19.431071660736276 new_mae=19.986370797349007
current=19.431071660736276 new_mae=26.10005691705323
current=19.431071660736276 new_mae=20.22978481432258
current=19.431071660736276 new_mae=19.349193231549954
slope=3.491653579305015 intercept=-69.66015165555953 current=19.349193231549954
current=19.349193231549954 new_mae=39.26258302559585
current=19.349193231549954 new_mae=19.406856875617823
current=19.349193231549954 new_mae=28.051423642561122
current=19.349193231549954 new_mae=22.868836006703706
current=19.349193231549954 new_mae=20.192734408707356
current=19.349193231549954 new_mae=38.14952600085884
current=19.349193231549954 new_mae=20.072648141330482
current=19.349193231549954 new_mae=39.229629880098415
current=19.349193231549954 new_mae=19.571832899046097
current=19.349193231549954 new_mae=25.48920928198226
current=19.349193231549954 new_mae=28.749167522612648
current=19.349193231549954 new_mae=26.123680322616536
current=19.349193231549954 new_mae=19.453129467990728
current=19.349193231549954 new_mae=19.395248781488352
current=19.349193231549954 new_mae=28.33697791110111
current=19.349193231549954 new_mae=32.092535093794595
current=19.349193231549954 new_mae=20.1875260502557
current=19.349193231549954 new_mae=31.154212960665784
current=19.349193231549954 new_mae=20.348196250768897
current=19.349193231549954 new_mae=20.577298557875757
current=19.349193231549954 new_mae=29.17561674309304
current=19.349193231549954 new_mae=29.624498744278615
current=19.349193231549954 new_mae=22.228471217594404
current=19.349193231549954 new_mae=34.58582800883024
current=19.349193231549954 new_mae=31.971821455483454
current=19.349193231549954 new_mae=22.229462418712277
current=19.349193231549954 new_mae=25.082365784516483
current=19.349193231549954 new_mae=26.094301083844414
current=19.349193231549954 new_mae=35.472832667252796
current=19.349193231549954 new_mae=28.85299438604091
current=19.349193231549954 new_mae=29.116477274474203
current=19.349193231549954 new_mae=23.46569823935643
current=19.349193231549954 new_mae=29.820961406436616
current=19.349193231549954 new_mae=33.168471159279896
current=19.349193231549954 new_mae=19.38325841592386
current=19.349193231549954 new_mae=27.59474700945782
current=19.349193231549954 new_mae=40.08938936754674
current=19.349193231549954 new_mae=22.064170547947842
current=19.349193231549954 new_mae=23.860023185909547
current=19.349193231549954 new_mae=21.538239077354365
current=19.349193231549954 new_mae=19.89400399971949
current=19.349193231549954 new_mae=29.65425548021451
current=19.349193231549954 new_mae=24.502360267174744
current=19.349193231549954 new_mae=21.643315886749456
current=19.349193231549954 new_mae=19.54007398734863
current=19.349193231549954 new_mae=23.107060174933387
current=19.349193231549954 new_mae=20.913443517852812
current=19.349193231549954 new_mae=19.602676248805007
current=19.349193231549954 new_mae=29.366755089811853
current=19.349193231549954 new_mae=36.53211734902904
current=19.349193231549954 new_mae=35.875788069773236
current=19.349193231549954 new_mae=28.454111359550968
current=19.349193231549954 new_mae=23.781623384425288
current=19.349193231549954 new_mae=20.405126439789235
current=19.349193231549954 new_mae=19.57901882715659
current=19.349193231549954 new_mae=20.376641218515083
current=19.349193231549954 new_mae=19.876170117227602
current=19.349193231549954 new_mae=29.633770744526693
current=19.349193231549954 new_mae=19.544281967259653
current=19.349193231549954 new_mae=33.67895788413093
current=19.349193231549954 new_mae=25.31558944948435
current=19.349193231549954 new_mae=22.202308861900736
current=19.349193231549954 new_mae=19.722188329951827
current=19.349193231549954 new_mae=22.086900741997486
current=19.349193231549954 new_mae=28.08747306088603
current=19.349193231549954 new_mae=21.18089713730521
current=19.349193231549954 new_mae=19.35734917759381
current=19.349193231549954 new_mae=25.89989812001397
current=19.349193231549954 new_mae=26.92579804398714
current=19.349193231549954 new_mae=19.464026765625928
current=19.349193231549954 new_mae=20.2340216713989
current=19.349193231549954 new_mae=25.871831342632262
current=19.349193231549954 new_mae=30.68958144974305
current=19.349193231549954 new_mae=19.317353369289513
slope=3.6049896340677567 intercept=-76.99409742139461 current=19.317353369289513
current=19.317353369289513 new_mae=19.45403612939886
current=19.317353369289513 new_mae=22.85929665909401
current=19.317353369289513 new_mae=19.404565383558786
current=19.317353369289513 new_mae=19.899244635271693
current=19.317353369289513 new_mae=22.579132817793955
current=19.317353369289513 new_mae=21.041702719994426
current=19.317353369289513 new_mae=19.418127993652316
current=19.317353369289513 new_mae=20.223914999110104
current=19.317353369289513 new_mae=19.28767139139429
slope=3.6951123275045124 intercept=-83.00140737859716 current=19.28767139139429
current=19.28767139139429 new_mae=35.71299626136753
current=19.28767139139429 new_mae=20.77856654545328
current=19.28767139139429 new_mae=19.427086730397694
current=19.28767139139429 new_mae=30.618320811023555
current=19.28767139139429 new_mae=20.02584669386379
current=19.28767139139429 new_mae=25.43424621111012
current=19.28767139139429 new_mae=21.595782560448267
current=19.28767139139429 new_mae=23.013747087753305
current=19.28767139139429 new_mae=22.131099342831885
current=19.28767139139429 new_mae=20.434917964900063
current=19.28767139139429 new_mae=20.85895785175958
current=19.28767139139429 new_mae=23.84558251786035
current=19.28767139139429 new_mae=32.426471161152016
current=19.28767139139429 new_mae=41.98443678418503
current=19.28767139139429 new_mae=19.59067431575846
current=19.28767139139429 new_mae=36.9479574869495
current=19.28767139139429 new_mae=20.011121083809535
current=19.28767139139429 new_mae=28.58788453517089
current=19.28767139139429 new_mae=30.07001024347763
current=19.28767139139429 new_mae=28.28923103519398
current=19.28767139139429 new_mae=44.71127476796726
current=19.28767139139429 new_mae=19.349578814257004
current=19.28767139139429 new_mae=30.05982986844996
current=19.28767139139429 new_mae=26.69291729286617
current=19.28767139139429 new_mae=19.307384669990327
current=19.28767139139429 new_mae=24.559866928077724
current=19.28767139139429 new_mae=19.309023213946844
current=19.28767139139429 new_mae=19.364315814704845
current=19.28767139139429 new_mae=19.491496668136772
current=19.28767139139429 new_mae=20.178123500291655
current=19.28767139139429 new_mae=24.86658055046582
current=19.28767139139429 new_mae=28.738701908292533
current=19.28767139139429 new_mae=26.901861206204078
current=19.28767139139429 new_mae=22.5104430607228
current=19.28767139139429 new_mae=19.229893099090493
slope=3.8007342427855297 intercept=-90.97598865202862 current=19.229893099090493
current=19.229893099090493 new_mae=41.431680198358656
current=19.229893099090493 new_mae=32.30075053076771
current=19.229893099090493 new_mae=22.377346352229203
current=19.229893099090493 new_mae=38.32219719448354
current=19.229893099090493 new_mae=30.769085303793194
current=19.229893099090493 new_mae=29.167302164588467
current=19.229893099090493 new_mae=27.688615887645078
current=19.229893099090493 new_mae=23.10286227870627
current=19.229893099090493 new_mae=31.750583753138486
current=19.229893099090493 new_mae=34.266397312601875
current=19.229893099090493 new_mae=19.94124468323723
current=19.229893099090493 new_mae=19.947016722951727
current=19.229893099090493 new_mae=24.376577557961866
current=19.229893099090493 new_mae=30.46894632125448
current=19.229893099090493 new_mae=24.7017568067601
current=19.229893099090493 new_mae=25.449670777869525
current=19.229893099090493 new_mae=26.505932042946743
current=19.229893099090493 new_mae=44.841429198822425
current=19.229893099090493 new_mae=42.46821052187023
current=19.229893099090493 new_mae=29.49271315683882
current=19.229893099090493 new_mae=19.748684135800293
current=19.229893099090493 new_mae=35.84184343908555
current=19.229893099090493 new_mae=37.50712796876975
current=19.229893099090493 new_mae=20.341002328139112
current=19.229893099090493 new_mae=21.961480130883746
current=19.229893099090493 new_mae=32.66661288999491
current=19.229893099090493 new_mae=27.809723646923253
current=19.229893099090493 new_mae=32.68534657497155
current=19.229893099090493 new_mae=19.238880486729236
current=19.229893099090493 new_mae=29.85818457755212
current=19.229893099090493 new_mae=28.443904888623756
current=19.229893099090493 new_mae=19.615215997825953
current=19.229893099090493 new_mae=19.536560843277922
current=19.229893099090493 new_mae=35.556659569510764
current=19.229893099090493 new_mae=24.50251142128824
current=19.229893099090493 new_mae=23.922292705300663
current=19.229893099090493 new_mae=21.190666220576908
current=19.229893099090493 new_mae=23.566301531953496
current=19.229893099090493 new_mae=28.414469369141326
current=19.229893099090493 new_mae=35.81124881920466
current=19.229893099090493 new_mae=22.779065737192006
current=19.229893099090493 new_mae=21.770611961892023
current=19.229893099090493 new_mae=20.41479707408171
current=19.229893099090493 new_mae=19.201375653011876
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>slope=3.859727398948028 intercept=-95.60248022399941 current=19.201375653011876
current=19.201375653011876 new_mae=31.287767901669145
current=19.201375653011876 new_mae=21.393820718688026
current=19.201375653011876 new_mae=30.34035259155478
current=19.201375653011876 new_mae=20.64551799579421
current=19.201375653011876 new_mae=29.96346009227264
current=19.201375653011876 new_mae=19.62924666412677
current=19.201375653011876 new_mae=20.527453368968423
current=19.201375653011876 new_mae=29.9712073519433
current=19.201375653011876 new_mae=36.241856242114885
current=19.201375653011876 new_mae=19.511269768830406
current=19.201375653011876 new_mae=22.551865989288526
current=19.201375653011876 new_mae=32.56326233453093
current=19.201375653011876 new_mae=20.31583057534347
current=19.201375653011876 new_mae=27.252507575456633
current=19.201375653011876 new_mae=19.301846413881023
current=19.201375653011876 new_mae=25.480221656653708
current=19.201375653011876 new_mae=20.162191593520085
current=19.201375653011876 new_mae=24.6021514415274
current=19.201375653011876 new_mae=37.04280065051977
current=19.201375653011876 new_mae=28.30147333540475
current=19.201375653011876 new_mae=20.902617033164265
current=19.201375653011876 new_mae=31.340318701409526
current=19.201375653011876 new_mae=25.538946291155085
current=19.201375653011876 new_mae=34.23753097633896
current=19.201375653011876 new_mae=20.763030128125
current=19.201375653011876 new_mae=19.739609302820018
current=19.201375653011876 new_mae=25.75552046819492
current=19.201375653011876 new_mae=25.399655362874753
current=19.201375653011876 new_mae=19.674341777148307
current=19.201375653011876 new_mae=20.912349236595315
current=19.201375653011876 new_mae=22.510174206433696
current=19.201375653011876 new_mae=40.42709305680058
current=19.201375653011876 new_mae=31.050237953548095
current=19.201375653011876 new_mae=24.200300809249207
current=19.201375653011876 new_mae=20.063055745608388
current=19.201375653011876 new_mae=28.301177317284786
current=19.201375653011876 new_mae=25.716920514278716
current=19.201375653011876 new_mae=32.5197093485895
current=19.201375653011876 new_mae=30.499290975782273
current=19.201375653011876 new_mae=37.854871356825306
current=19.201375653011876 new_mae=25.51795826244387
current=19.201375653011876 new_mae=30.856879991998483
current=19.201375653011876 new_mae=28.86700834755433
current=19.201375653011876 new_mae=29.651478492484905
current=19.201375653011876 new_mae=37.58320640350246
current=19.201375653011876 new_mae=39.83332509814884
current=19.201375653011876 new_mae=33.16427605955855
current=19.201375653011876 new_mae=31.020290570149644
current=19.201375653011876 new_mae=19.24781523907303
current=19.201375653011876 new_mae=26.38994771156658
current=19.201375653011876 new_mae=32.286728847575475
current=19.201375653011876 new_mae=32.65432327695423
current=19.201375653011876 new_mae=19.279770020773178
current=19.201375653011876 new_mae=19.45267975507292
current=19.201375653011876 new_mae=38.27807802447476
current=19.201375653011876 new_mae=33.41983267268466
current=19.201375653011876 new_mae=32.57239554100962
current=19.201375653011876 new_mae=25.05967962336345
current=19.201375653011876 new_mae=29.69012963379282
current=19.201375653011876 new_mae=19.844057578989442
current=19.201375653011876 new_mae=21.419530832527393
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>current=19.201375653011876 new_mae=38.21031867764513
current=19.201375653011876 new_mae=23.268263675886708
current=19.201375653011876 new_mae=25.795728791213268
current=19.201375653011876 new_mae=19.29432168421278
current=19.201375653011876 new_mae=19.14831056552847
slope=4.003892530402848 intercept=-105.33646611829232 current=19.14831056552847
current=19.14831056552847 new_mae=19.431901619893193
current=19.14831056552847 new_mae=33.64587309412324
current=19.14831056552847 new_mae=19.726445875671345
current=19.14831056552847 new_mae=20.731232773656334
current=19.14831056552847 new_mae=19.239933027967485
current=19.14831056552847 new_mae=20.535243528490472
current=19.14831056552847 new_mae=24.54462033021603
current=19.14831056552847 new_mae=39.869509454234056
current=19.14831056552847 new_mae=19.25481337105761
current=19.14831056552847 new_mae=24.560463585095988
current=19.14831056552847 new_mae=28.838746235936302
current=19.14831056552847 new_mae=22.334523515618848
current=19.14831056552847 new_mae=21.25143457141871
current=19.14831056552847 new_mae=22.76280640048028
current=19.14831056552847 new_mae=30.824580286424737
current=19.14831056552847 new_mae=26.670129895938835
current=19.14831056552847 new_mae=25.462176164998237
current=19.14831056552847 new_mae=35.382868089642905
current=19.14831056552847 new_mae=40.86803573374743
current=19.14831056552847 new_mae=28.595613980795175
current=19.14831056552847 new_mae=21.45343122324815
current=19.14831056552847 new_mae=33.433116951096885
current=19.14831056552847 new_mae=20.215417653148727
current=19.14831056552847 new_mae=28.71021332141023
current=19.14831056552847 new_mae=19.8422882432672
current=19.14831056552847 new_mae=21.934123285818824
current=19.14831056552847 new_mae=19.180336879556418
current=19.14831056552847 new_mae=26.80320101962227
current=19.14831056552847 new_mae=19.462604746329262
current=19.14831056552847 new_mae=31.57952517507106
current=19.14831056552847 new_mae=31.53631414480255
current=19.14831056552847 new_mae=22.0318013655456
current=19.14831056552847 new_mae=19.61193055147929
current=19.14831056552847 new_mae=25.737492975290873
current=19.14831056552847 new_mae=26.34499868425848
current=19.14831056552847 new_mae=30.888182834746353
current=19.14831056552847 new_mae=24.069234446472183
current=19.14831056552847 new_mae=34.417152441346076
current=19.14831056552847 new_mae=28.53894642700657
current=19.14831056552847 new_mae=24.31350034174427
current=19.14831056552847 new_mae=22.73512094692807
current=19.14831056552847 new_mae=20.045399563088647
current=19.14831056552847 new_mae=22.339870330953953
current=19.14831056552847 new_mae=19.60338432057563
current=19.14831056552847 new_mae=43.64243576494832
current=19.14831056552847 new_mae=25.767840093760455
current=19.14831056552847 new_mae=25.272958856445715
current=19.14831056552847 new_mae=20.13692019273822
current=19.14831056552847 new_mae=41.43226332442885
current=19.14831056552847 new_mae=19.515713093540434
current=19.14831056552847 new_mae=37.052119596976375
current=19.14831056552847 new_mae=25.753595666490348
current=19.14831056552847 new_mae=34.0955838753593
current=19.14831056552847 new_mae=27.664233957068223
current=19.14831056552847 new_mae=21.53696162370148
current=19.14831056552847 new_mae=19.150680577475672
current=19.14831056552847 new_mae=20.954049642610833
current=19.14831056552847 new_mae=44.12566226039104
current=19.14831056552847 new_mae=26.966509156020255
current=19.14831056552847 new_mae=27.83105001680525
current=19.14831056552847 new_mae=38.86763968140112
current=19.14831056552847 new_mae=21.24624611651397
current=19.14831056552847 new_mae=23.306002744725852
current=19.14831056552847 new_mae=43.63538253894641
current=19.14831056552847 new_mae=26.21829393789068
current=19.14831056552847 new_mae=22.437685819141734
current=19.14831056552847 new_mae=22.43637324695409
current=19.14831056552847 new_mae=32.35715053134276
current=19.14831056552847 new_mae=42.913605750402844
current=19.14831056552847 new_mae=24.930834559838882
current=19.14831056552847 new_mae=28.7158367036433
current=19.14831056552847 new_mae=33.30930540481905
current=19.14831056552847 new_mae=26.486124697712874
current=19.14831056552847 new_mae=28.596116674935672
current=19.14831056552847 new_mae=19.59353280668983
current=19.14831056552847 new_mae=24.597654332499392
current=19.14831056552847 new_mae=21.824342162966033
current=19.14831056552847 new_mae=33.54660570844906
current=19.14831056552847 new_mae=23.953863148330722
current=19.14831056552847 new_mae=25.76171930156749
current=19.14831056552847 new_mae=20.142503159440615
current=19.14831056552847 new_mae=22.610764810528252
current=19.14831056552847 new_mae=19.920386857273314
current=19.14831056552847 new_mae=20.940585415216134
current=19.14831056552847 new_mae=28.75895568788241
current=19.14831056552847 new_mae=38.0510241232595
current=19.14831056552847 new_mae=35.60147848410898
current=19.14831056552847 new_mae=19.54071233855254
current=19.14831056552847 new_mae=28.843659149694066
current=19.14831056552847 new_mae=28.856285408454443
current=19.14831056552847 new_mae=20.020904786311696
current=19.14831056552847 new_mae=19.2911722633801
current=19.14831056552847 new_mae=29.76427324109787
current=19.14831056552847 new_mae=27.082740112298538
current=19.14831056552847 new_mae=36.17994844983542
current=19.14831056552847 new_mae=36.34671201414218
current=19.14831056552847 new_mae=19.940954248247806
current=19.14831056552847 new_mae=21.207668639244847
current=19.14831056552847 new_mae=22.803208997650533
current=19.14831056552847 new_mae=21.705867809299733
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3420813426589826
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>model is some function that usually takes parameters and predicts data.</p>
<p>parameters are free to vary, structure of the model is set in stone</p>
<p>we can evaluate model predictions via a loss function, and smaller loss is better.</p>
<p>We find parameters that minimize the loss function.  this amounts to “fitting” the model.</p>
<p>this is done via some kind of optimization algorithm.</p>
<div class="section" id="gradient-descent">
<h3>Gradient descent<a class="headerlink" href="#gradient-descent" title="Permalink to this headline">¶</a></h3>
<p>Start with some parameter values.  Figure out which direction of change in parameter values reduces the loss.  Change parameter values in that direction.  Repeat until some criterion is reached.</p>
<p><span class="math notranslate nohighlight">\(L(a,b) = \frac{1}{n} \sum_{i=0}^n (\hat y_i - y_i)^2\)</span></p>
<p><span class="math notranslate nohighlight">\(L(a,b) = \frac{1}{n} \sum_{i=0}^n (a x_i + b - y_i)^2\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{\partial L(a,b)}{\partial a} = \frac{1}{n} \sum_{i=0}^n 2 (a x_i + b - y_i) x_i\)</span></p>
<p><span class="math notranslate nohighlight">\(\frac{\partial L(a,b)}{\partial b} = \frac{1}{n} \sum_{i=0}^n 2 (a x_i + b - y_i)\)</span></p>
</div>
</div>
<div class="section" id="writing-our-own-model-class">
<h2>Writing our own model class<a class="headerlink" href="#writing-our-own-model-class" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-kinds-of-operations-should-a-model-support">
<h3>What kinds of operations should a model support?<a class="headerlink" href="#what-kinds-of-operations-should-a-model-support" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>predict data, usually given some input</p></li>
<li><p>evaluate the quality of its predictions given some ground truth observations</p></li>
<li><p>fit its parameters to observed data</p></li>
<li><p>for <em>inferential statistics</em>: compare its fitted parameters to null values, provide confidence intervals on parameters, etc.</p></li>
</ul>
</div>
<div class="section" id="baby-steps">
<h3>Baby steps<a class="headerlink" href="#baby-steps" title="Permalink to this headline">¶</a></h3>
<p><strong>for linear regression</strong></p>
<div class="section" id="predict">
<h4>predict<a class="headerlink" href="#predict" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code>x a 1d numpy array of length <code class="docutils literal notranslate"><span class="pre">n</span></code>, and returns a 1d array of <code class="docutils literal notranslate"><span class="pre">n</span></code> predicted y values, given <code class="docutils literal notranslate"><span class="pre">slope=0.5</span></code>, and <code class="docutils literal notranslate"><span class="pre">intercept=50</span></code></p>
</div>
<div class="section" id="evaluate">
<h4>evaluate<a class="headerlink" href="#evaluate" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> (both arrays of length <code class="docutils literal notranslate"><span class="pre">n</span></code>) and returns the mean squared error of the prediction.</p>
</div>
<div class="section" id="fit">
<h4>fit<a class="headerlink" href="#fit" title="Permalink to this headline">¶</a></h4>
<p>Write a function that takes in <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> and finds some good values of slope and intercept by minimizing the mean squared error loss function, somehow.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./live"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ed Vul<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>